layui.define(["form","jquery"],function(exports){var jQuery=layui.jquery,$=jQuery,form=layui.form,_MOD="treeSelect",trss={},TreeSelect=function(){this.v="1.0.5"};(function(r){var J,K,L,M,N,O,v,t={},w={},x={},P={treeId:"",treeObj:null,view:{addDiyDom:null,autoCancelSelected:!0,dblClickExpand:!0,expandSpeed:"fast",fontCss:{},nameIsHTML:!1,selectedMulti:!0,showIcon:!0,showLine:!0,showTitle:!0,txtSelectedEnable:!1},data:{key:{isParent:"isParent",children:"children",name:"name",title:"",url:"url",icon:"icon"},simpleData:{enable:!1,idKey:"id",pIdKey:"pId",rootPId:null},keep:{parent:!1,leaf:!1}},async:{enable:!1,contentType:"application/x-www-form-urlencoded",type:"post",dataType:"text",headers:{},xhrFields:{},url:"",autoParam:[],otherParam:[],dataFilter:null},callback:{beforeAsync:null,beforeClick:null,beforeDblClick:null,beforeRightClick:null,beforeMouseDown:null,beforeMouseUp:null,beforeExpand:null,beforeCollapse:null,beforeRemove:null,onAsyncError:null,onAsyncSuccess:null,onNodeCreated:null,onClick:null,onDblClick:null,onRightClick:null,onMouseDown:null,onMouseUp:null,onExpand:null,onCollapse:null,onRemove:null}},y=[function(e){var t=e.treeObj,o=g.event;t.bind(o.NODECREATED,function(i,s,d){h.apply(e.callback.onNodeCreated,[i,s,d])}),t.bind(o.CLICK,function(i,s,d,c,u){h.apply(e.callback.onClick,[s,d,c,u])}),t.bind(o.EXPAND,function(i,s,d){h.apply(e.callback.onExpand,[i,s,d])}),t.bind(o.COLLAPSE,function(i,s,d){h.apply(e.callback.onCollapse,[i,s,d])}),t.bind(o.ASYNC_SUCCESS,function(i,s,d,c){h.apply(e.callback.onAsyncSuccess,[i,s,d,c])}),t.bind(o.ASYNC_ERROR,function(i,s,d,c,u,f){h.apply(e.callback.onAsyncError,[i,s,d,c,u,f])}),t.bind(o.REMOVE,function(i,s,d){h.apply(e.callback.onRemove,[i,s,d])}),t.bind(o.SELECTED,function(i,s,d){h.apply(e.callback.onSelected,[s,d])}),t.bind(o.UNSELECTED,function(i,s,d){h.apply(e.callback.onUnSelected,[s,d])})}],z=[function(e){var t=g.event;e.treeObj.unbind(t.NODECREATED).unbind(t.CLICK).unbind(t.EXPAND).unbind(t.COLLAPSE).unbind(t.ASYNC_SUCCESS).unbind(t.ASYNC_ERROR).unbind(t.REMOVE).unbind(t.SELECTED).unbind(t.UNSELECTED)}],A=[function(e){var t=e.getCache(e);t||(t={},e.setCache(e,t)),t.nodes=[],t.doms=[]}],B=[function(e,t,o,i,s,d){if(o){var c=e.getRoot(e),u=e.nodeChildren(e,o);o.level=t,o.tId=e.treeId+"_"+ ++c.zId,o.parentTId=i?i.tId:null,o.open=typeof o.open=="string"?h.eqs(o.open,"true"):!!o.open,t=e.nodeIsParent(e,o),h.isArray(u)&&!(t===!1||typeof t=="string"&&h.eqs(t,"false"))?(e.nodeIsParent(e,o,!0),o.zAsync=!0):(t=e.nodeIsParent(e,o,t),o.open=t&&!e.async.enable?o.open:!1,o.zAsync=!t),o.isFirstNode=s,o.isLastNode=d,o.getParentNode=function(){return e.getNodeCache(e,o.parentTId)},o.getPreNode=function(){return e.getPreNode(e,o)},o.getNextNode=function(){return e.getNextNode(e,o)},o.getIndex=function(){return e.getNodeIndex(e,o)},o.getPath=function(){return e.getNodePath(e,o)},o.isAjaxing=!1,e.fixPIdKeyValue(e,o)}}],u=[function(e){var t=e.target,o=e.getSetting(e.data.treeId),i="",s=null,d="",c="",u=null,f=null,N=null;if(h.eqs(e.type,"mousedown")?c="mousedown":h.eqs(e.type,"mouseup")?c="mouseup":h.eqs(e.type,"contextmenu")?c="contextmenu":h.eqs(e.type,"click")?h.eqs(t.tagName,"span")&&t.getAttribute("treeNode"+g.id.SWITCH)!==null?(i=h.getNodeMainDom(t).id,d="switchNode"):(N=h.getMDom(o,t,[{tagName:"a",attrName:"treeNode"+g.id.A}]))&&(i=h.getNodeMainDom(N).id,d="clickNode"):h.eqs(e.type,"dblclick")&&(c="dblclick",N=h.getMDom(o,t,[{tagName:"a",attrName:"treeNode"+g.id.A}]))&&(i=h.getNodeMainDom(N).id,d="switchNode"),c.length>0&&i.length==0&&(N=h.getMDom(o,t,[{tagName:"a",attrName:"treeNode"+g.id.A}]))&&(i=h.getNodeMainDom(N).id),i.length>0)switch(s=e.getNodeCache(o,i),d){case"switchNode":e.nodeIsParent(o,s)&&(h.eqs(e.type,"click")||h.eqs(e.type,"dblclick")&&h.apply(o.view.dblClickExpand,[o.treeId,s],o.view.dblClickExpand))?u=J:d="";break;case"clickNode":u=K}switch(c){case"mousedown":f=L;break;case"mouseup":f=M;break;case"dblclick":f=N;break;case"contextmenu":f=O}return{stop:!1,node:s,nodeEventType:d,nodeEventCallback:u,treeEventType:c,treeEventCallback:f}}],C=[function(e){var t=e.getRoot(e);t||(t={},e.setRoot(e,t)),e.nodeChildren(e,t,[]),t.expandTriggerFlag=!1,t.curSelectedList=[],t.noSelection=!0,t.createdNodes=[],t.zId=0,t._ver=new Date().getTime()}],D=[],E=[],F=[],G=[],H=[],e={addNodeCache:function(e,t){e.getCache(e).nodes[e.getNodeCacheId(t.tId)]=t},getNodeCacheId:function(e){return e.substring(e.lastIndexOf("_")+1)},addAfterA:function(e){E.push(e)},addBeforeA:function(e){D.push(e)},addInnerAfterA:function(e){G.push(e)},addInnerBeforeA:function(e){F.push(e)},addInitBind:function(e){y.push(e)},addInitUnBind:function(e){z.push(e)},addInitCache:function(e){A.push(e)},addInitNode:function(e){B.push(e)},addInitProxy:function(e,t){t?u.splice(0,0,e):u.push(e)},addInitRoot:function(e){C.push(e)},addNodesData:function(e,t,o,i){var s=e.nodeChildren(e,t);s?o>=s.length&&(o=-1):(s=e.nodeChildren(e,t,[]),o=-1),s.length>0&&o===0?(s[0].isFirstNode=!1,j.setNodeLineIcos(e,s[0])):s.length>0&&o<0&&(s[s.length-1].isLastNode=!1,j.setNodeLineIcos(e,s[s.length-1])),e.nodeIsParent(e,t,!0),o<0?e.nodeChildren(e,t,s.concat(i)):(e=[o,0].concat(i),s.splice.apply(s,e))},addSelectedNode:function(e,t){var o=e.getRoot(e);e.isSelectedNode(e,t)||o.curSelectedList.push(t)},addCreatedNode:function(e,t){(e.callback.onNodeCreated||e.view.addDiyDom)&&e.getRoot(e).createdNodes.push(t)},addZTreeTools:function(e){H.push(e)},exSetting:function(e){r.extend(!0,P,e)},fixPIdKeyValue:function(e,t){e.data.simpleData.enable&&(t[e.data.simpleData.pIdKey]=t.parentTId?t.getParentNode()[e.data.simpleData.idKey]:e.data.simpleData.rootPId)},getAfterA:function(e,t,o){for(var i=0,s=E.length;i<s;i++)E[i].apply(this,arguments)},getBeforeA:function(e,t,o){for(var i=0,s=D.length;i<s;i++)D[i].apply(this,arguments)},getInnerAfterA:function(e,t,o){for(var i=0,s=G.length;i<s;i++)G[i].apply(this,arguments)},getInnerBeforeA:function(e,t,o){for(var i=0,s=F.length;i<s;i++)F[i].apply(this,arguments)},getCache:function(e){return x[e.treeId]},getNodeIndex:function(e,t){if(!t)return null;for(var o=t.parentTId?t.getParentNode():e.getRoot(e),o=e.nodeChildren(e,o),i=0,s=o.length-1;i<=s;i++)if(o[i]===t)return i;return-1},getNextNode:function(e,t){if(!t)return null;for(var o=t.parentTId?t.getParentNode():e.getRoot(e),o=e.nodeChildren(e,o),i=0,s=o.length-1;i<=s;i++)if(o[i]===t)return i==s?null:o[i+1];return null},getNodeByParam:function(e,t,o,i){if(!t||!o)return null;for(var s=0,d=t.length;s<d;s++){var c=t[s];if(c[o]==i)return t[s];if(c=e.nodeChildren(e,c),c=e.getNodeByParam(e,c,o,i))return c}return null},getNodeCache:function(e,t){if(!t)return null;var o=x[e.treeId].nodes[e.getNodeCacheId(t)];return o||null},getNodePath:function(e,t){if(!t)return null;var o;return(o=t.parentTId?t.getParentNode().getPath():[])&&o.push(t),o},getNodes:function(e){return e.nodeChildren(e,e.getRoot(e))},getNodesByParam:function(e,t,o,i){if(!t||!o)return[];for(var s=[],d=0,c=t.length;d<c;d++){var u=t[d];u[o]==i&&s.push(u),u=e.nodeChildren(e,u),s=s.concat(e.getNodesByParam(e,u,o,i))}return s},getNodesByParamFuzzy:function(e,t,o,i){if(!t||!o)return[];for(var s=[],i=i.toLowerCase(),d=0,c=t.length;d<c;d++){var u=t[d];typeof u[o]=="string"&&t[d][o].toLowerCase().indexOf(i)>-1&&s.push(u),u=e.nodeChildren(e,u),s=s.concat(e.getNodesByParamFuzzy(e,u,o,i))}return s},getNodesByFilter:function(e,t,o,i,s){if(!t)return i?null:[];for(var d=i?null:[],c=0,u=t.length;c<u;c++){var f=t[c];if(h.apply(o,[f,s],!1)){if(i)return f;d.push(f)}if(f=e.nodeChildren(e,f),f=e.getNodesByFilter(e,f,o,i,s),i&&f)return f;d=i?f:d.concat(f)}return d},getPreNode:function(e,t){if(!t)return null;for(var o=t.parentTId?t.getParentNode():e.getRoot(e),o=e.nodeChildren(e,o),i=0,s=o.length;i<s;i++)if(o[i]===t)return i==0?null:o[i-1];return null},getRoot:function(e){return e?w[e.treeId]:null},getRoots:function(){return w},getSetting:function(e){return t[e]},getSettings:function(){return t},getZTreeTools:function(e){return(e=this.getRoot(this.getSetting(e)))?e.treeTools:null},initCache:function(e){for(var t=0,o=A.length;t<o;t++)A[t].apply(this,arguments)},initNode:function(e,t,o,i,s,d){for(var c=0,u=B.length;c<u;c++)B[c].apply(this,arguments)},initRoot:function(e){for(var t=0,o=C.length;t<o;t++)C[t].apply(this,arguments)},isSelectedNode:function(e,t){for(var o=e.getRoot(e),i=0,s=o.curSelectedList.length;i<s;i++)if(t===o.curSelectedList[i])return!0;return!1},nodeChildren:function(e,t,o){return t?(e=e.data.key.children,typeof o!="undefined"&&(t[e]=o),t[e]):null},nodeIsParent:function(e,t,o){return t?(e=e.data.key.isParent,typeof o!="undefined"&&(typeof o=="string"&&(o=h.eqs(o,"true")),t[e]=!!o),t[e]):!1},nodeName:function(e,t,o){return e=e.data.key.name,typeof o!="undefined"&&(t[e]=o),""+t[e]},nodeTitle:function(e,t){return""+t[e.data.key.title===""?e.data.key.name:e.data.key.title]},removeNodeCache:function(e,t){var o=e.nodeChildren(e,t);if(o)for(var i=0,s=o.length;i<s;i++)e.removeNodeCache(e,o[i]);e.getCache(e).nodes[e.getNodeCacheId(t.tId)]=null},removeSelectedNode:function(e,t){for(var o=e.getRoot(e),i=0,s=o.curSelectedList.length;i<s;i++)(t===o.curSelectedList[i]||!e.getNodeCache(e,o.curSelectedList[i].tId))&&(o.curSelectedList.splice(i,1),e.treeObj.trigger(g.event.UNSELECTED,[e.treeId,t]),i--,s--)},setCache:function(e,t){x[e.treeId]=t},setRoot:function(e,t){w[e.treeId]=t},setZTreeTools:function(e,t){for(var o=0,i=H.length;o<i;o++)H[o].apply(this,arguments)},transformToArrayFormat:function(e,t){function o(c){i.push(c),(c=e.nodeChildren(e,c))&&(i=i.concat(e.transformToArrayFormat(e,c)))}if(!t)return[];var i=[];if(h.isArray(t))for(var s=0,d=t.length;s<d;s++)o(t[s]);else o(t);return i},transformTozTreeFormat:function(e,t){var o,i,s=e.data.simpleData.idKey,d=e.data.simpleData.pIdKey;if(!s||s==""||!t)return[];if(h.isArray(t)){var c=[],u={};for(o=0,i=t.length;o<i;o++)u[t[o][s]]=t[o];for(o=0,i=t.length;o<i;o++){var f=u[t[o][d]];if(f&&t[o][s]!=t[o][d]){var N=e.nodeChildren(e,f);N||(N=e.nodeChildren(e,f,[])),N.push(t[o])}else c.push(t[o])}return c}else return[t]}},n={bindEvent:function(e){for(var t=0,o=y.length;t<o;t++)y[t].apply(this,arguments)},unbindEvent:function(e){for(var t=0,o=z.length;t<o;t++)z[t].apply(this,arguments)},bindTree:function(e){var t={treeId:e.treeId},o=e.treeObj;e.view.txtSelectedEnable||o.bind("selectstart",v).css({"-moz-user-select":"-moz-none"}),o.bind("click",t,n.proxy),o.bind("dblclick",t,n.proxy),o.bind("mouseover",t,n.proxy),o.bind("mouseout",t,n.proxy),o.bind("mousedown",t,n.proxy),o.bind("mouseup",t,n.proxy),o.bind("contextmenu",t,n.proxy)},unbindTree:function(e){e.treeObj.unbind("selectstart",v).unbind("click",n.proxy).unbind("dblclick",n.proxy).unbind("mouseover",n.proxy).unbind("mouseout",n.proxy).unbind("mousedown",n.proxy).unbind("mouseup",n.proxy).unbind("contextmenu",n.proxy)},doProxy:function(e){for(var t=[],o=0,i=u.length;o<i;o++){var s=u[o].apply(this,arguments);if(t.push(s),s.stop)break}return t},proxy:function(e){var t=e.getSetting(e.data.treeId);if(!h.uCanDo(t,e))return!0;for(var t=n.doProxy(e),o=!0,i=0,s=t.length;i<s;i++){var d=t[i];d.nodeEventCallback&&(o=d.nodeEventCallback.apply(d,[e,d.node])&&o),d.treeEventCallback&&(o=d.treeEventCallback.apply(d,[e,d.node])&&o)}return o}};J=function(e,t){var o=e.getSetting(e.data.treeId);if(t.open){if(h.apply(o.callback.beforeCollapse,[o.treeId,t],!0)==!1)return!0}else if(h.apply(o.callback.beforeExpand,[o.treeId,t],!0)==!1)return!0;return e.getRoot(o).expandTriggerFlag=!0,j.switchNode(o,t),!0},K=function(e,t){var o=e.getSetting(e.data.treeId),i=o.view.autoCancelSelected&&(e.ctrlKey||e.metaKey)&&e.isSelectedNode(o,t)?0:o.view.autoCancelSelected&&(e.ctrlKey||e.metaKey)&&o.view.selectedMulti?2:1;return h.apply(o.callback.beforeClick,[o.treeId,t,i],!0)==!1||(i===0?j.cancelPreSelectedNode(o,t):j.selectNode(o,t,i===2),o.treeObj.trigger(g.event.CLICK,[e,o.treeId,t,i])),!0},L=function(e,t){var o=e.getSetting(e.data.treeId);return h.apply(o.callback.beforeMouseDown,[o.treeId,t],!0)&&h.apply(o.callback.onMouseDown,[e,o.treeId,t]),!0},M=function(e,t){var o=e.getSetting(e.data.treeId);return h.apply(o.callback.beforeMouseUp,[o.treeId,t],!0)&&h.apply(o.callback.onMouseUp,[e,o.treeId,t]),!0},N=function(e,t){var o=e.getSetting(e.data.treeId);return h.apply(o.callback.beforeDblClick,[o.treeId,t],!0)&&h.apply(o.callback.onDblClick,[e,o.treeId,t]),!0},O=function(e,t){var o=e.getSetting(e.data.treeId);return h.apply(o.callback.beforeRightClick,[o.treeId,t],!0)&&h.apply(o.callback.onRightClick,[e,o.treeId,t]),typeof o.callback.onRightClick!="function"},v=function(e){return e=e.originalEvent.srcElement.nodeName.toLowerCase(),e==="input"||e==="textarea"};var h={apply:function(e,t,o){return typeof e=="function"?e.apply(Q,t||[]):o},canAsync:function(e,t){var o=e.nodeChildren(e,t),i=e.nodeIsParent(e,t);return e.async.enable&&t&&i&&!(t.zAsync||o&&o.length>0)},clone:function(e){if(e===null)return null;var t=h.isArray(e)?[]:{},o;for(o in e)t[o]=e[o]instanceof Date?new Date(e[o].getTime()):typeof e[o]=="object"?h.clone(e[o]):e[o];return t},eqs:function(e,t){return e.toLowerCase()===t.toLowerCase()},isArray:function(e){return Object.prototype.toString.apply(e)==="[object Array]"},isElement:function(e){return typeof HTMLElement=="object"?e instanceof HTMLElement:e&&typeof e=="object"&&e!==null&&e.nodeType===1&&typeof e.nodeName=="string"},$:function(e,t,o){return t&&typeof t!="string"&&(o=t,t=""),typeof e=="string"?r(e,o?o.treeObj.get(0).ownerDocument:null):r("#"+e.tId+t,o?o.treeObj:null)},getMDom:function(e,t,o){if(!t)return null;for(;t&&t.id!==e.treeId;){for(var i=0,s=o.length;t.tagName&&i<s;i++)if(h.eqs(t.tagName,o[i].tagName)&&t.getAttribute(o[i].attrName)!==null)return t;t=t.parentNode}return null},getNodeMainDom:function(e){return r(e).parent("li").get(0)||r(e).parentsUntil("li").parent().get(0)},isChildOrSelf:function(e,t){return r(e).closest("#"+t).length>0},uCanDo:function(){return!0}},j={addNodes:function(e,t,o,i,s){var d=e.nodeIsParent(e,t);if(!e.data.keep.leaf||!t||d)if(h.isArray(i)||(i=[i]),e.data.simpleData.enable&&(i=e.transformTozTreeFormat(e,i)),t){var d=l(t,g.id.SWITCH,e),c=l(t,g.id.ICON,e),u=l(t,g.id.UL,e);t.open||(j.replaceSwitchClass(t,d,g.folder.CLOSE),j.replaceIcoClass(t,c,g.folder.CLOSE),t.open=!1,u.css({display:"none"})),e.addNodesData(e,t,o,i),j.createNodes(e,t.level+1,i,t,o),s||j.expandCollapseParentNode(e,t,!0)}else e.addNodesData(e,e.getRoot(e),o,i),j.createNodes(e,0,i,null,o)},appendNodes:function(e,t,o,i,s,d,c){if(!o)return[];var u=[],f=i||e.getRoot(e),f=e.nodeChildren(e,f),N,S;(!f||s>=f.length-o.length)&&(s=-1);for(var _=0,U=o.length;_<U;_++){var g=o[_];d&&(N=(s===0||f.length==o.length)&&_==0,S=s<0&&_==o.length-1,e.initNode(e,t,g,i,N,S,c),e.addNodeCache(e,g)),N=e.nodeIsParent(e,g),S=[];var a=e.nodeChildren(e,g);a&&a.length>0&&(S=j.appendNodes(e,t+1,a,g,-1,d,c&&g.open)),c&&(j.makeDOMNodeMainBefore(u,e,g),j.makeDOMNodeLine(u,e,g),e.getBeforeA(e,g,u),j.makeDOMNodeNameBefore(u,e,g),e.getInnerBeforeA(e,g,u),j.makeDOMNodeIcon(u,e,g),e.getInnerAfterA(e,g,u),j.makeDOMNodeNameAfter(u,e,g),e.getAfterA(e,g,u),N&&g.open&&j.makeUlHtml(e,g,u,S.join("")),j.makeDOMNodeMainAfter(u,e,g),e.addCreatedNode(e,g))}return u},appendParentULDom:function(e,t){var o=[],i=l(t,e);!i.get(0)&&t.parentTId&&(j.appendParentULDom(e,t.getParentNode()),i=l(t,e));var s=l(t,g.id.UL,e);s.get(0)&&s.remove(),s=e.nodeChildren(e,t),s=j.appendNodes(e,t.level+1,s,t,-1,!1,!0),j.makeUlHtml(e,t,o,s.join("")),i.append(o.join(""))},asyncNode:function(a,b,c,d){var f,i;if(f=e.nodeIsParent(a,b),b&&!f)return h.apply(d),!1;if(b&&b.isAjaxing)return!1;if(h.apply(a.callback.beforeAsync,[a.treeId,b],!0)==!1)return h.apply(d),!1;b&&(b.isAjaxing=!0,l(b,g.id.ICON,a).attr({style:"",class:g.className.BUTTON+" "+g.className.ICO_LOADING}));var m={},k=h.apply(a.async.autoParam,[a.treeId,b],a.async.autoParam);for(f=0,i=k.length;b&&f<i;f++){var q=k[f].split("="),o=q;q.length>1&&(o=q[1],q=q[0]),m[o]=b[q]}if(k=h.apply(a.async.otherParam,[a.treeId,b],a.async.otherParam),h.isArray(k))for(f=0,i=k.length;f<i;f+=2)m[k[f]]=k[f+1];else for(var n in k)m[n]=k[n];var s=e.getRoot(a)._ver;return r.ajax({contentType:a.async.contentType,cache:!1,type:a.async.type,url:h.apply(a.async.url,[a.treeId,b],a.async.url),data:a.async.contentType.indexOf("application/json")>-1?JSON.stringify(m):m,dataType:a.async.dataType,headers:a.async.headers,xhrFields:a.async.xhrFields,success:function(i){if(s==e.getRoot(a)._ver){var f=[];try{f=!i||i.length==0?[]:typeof i=="string"?eval("("+i+")"):i}catch(e){f=i}b&&(b.isAjaxing=null,b.zAsync=!0),j.setNodeLineIcos(a,b),f&&f!==""?(f=h.apply(a.async.dataFilter,[a.treeId,b,f],f),j.addNodes(a,b,-1,f?h.clone(f):[],!!c)):j.addNodes(a,b,-1,[],!!c),a.treeObj.trigger(g.event.ASYNC_SUCCESS,[a.treeId,b,i]),h.apply(d)}},error:function(e,t,o){s==e.getRoot(a)._ver&&(b&&(b.isAjaxing=null),j.setNodeLineIcos(a,b),a.treeObj.trigger(g.event.ASYNC_ERROR,[a.treeId,b,e,t,o]))}}),!0},cancelPreSelectedNode:function(e,t,o){var i=e.getRoot(e).curSelectedList,s,d;for(s=i.length-1;s>=0;s--)if(d=i[s],t===d||!t&&(!o||o!==d))if(l(d,g.id.A,e).removeClass(g.node.CURSELECTED),t){e.removeSelectedNode(e,t);break}else i.splice(s,1),e.treeObj.trigger(g.event.UNSELECTED,[e.treeId,d])},createNodeCallback:function(e){if(e.callback.onNodeCreated||e.view.addDiyDom)for(var t=e.getRoot(e);t.createdNodes.length>0;){var o=t.createdNodes.shift();h.apply(e.view.addDiyDom,[e.treeId,o]),e.callback.onNodeCreated&&e.treeObj.trigger(g.event.NODECREATED,[e.treeId,o])}},createNodes:function(e,t,o,i,s){if(o&&o.length!=0){var d=e.getRoot(e),c=!i||i.open||!!l(e.nodeChildren(e,i)[0],e).get(0);d.createdNodes=[];var t=j.appendNodes(e,t,o,i,s,!0,c),u,f;i?(i=l(i,g.id.UL,e),i.get(0)&&(u=i)):u=e.treeObj,u&&(s>=0&&(f=u.children()[s]),s>=0&&f?r(f).before(t.join("")):u.append(t.join(""))),j.createNodeCallback(e)}},destroy:function(e){e&&(e.initCache(e),e.initRoot(e),n.unbindTree(e),n.unbindEvent(e),e.treeObj.empty(),delete t[e.treeId])},expandCollapseNode:function(e,t,o,i,s){var d=e.getRoot(e),c;if(t){var u=e.nodeChildren(e,t),f=e.nodeIsParent(e,t);if(d.expandTriggerFlag&&(c=s,s=function(){c&&c(),t.open?e.treeObj.trigger(g.event.EXPAND,[e.treeId,t]):e.treeObj.trigger(g.event.COLLAPSE,[e.treeId,t])},d.expandTriggerFlag=!1),!t.open&&f&&(!l(t,g.id.UL,e).get(0)||u&&u.length>0&&!l(u[0],e).get(0))&&(j.appendParentULDom(e,t),j.createNodeCallback(e)),t.open==o)h.apply(s,[]);else{var o=l(t,g.id.UL,e),d=l(t,g.id.SWITCH,e),N=l(t,g.id.ICON,e);f?(t.open=!t.open,t.iconOpen&&t.iconClose&&N.attr("style",j.makeNodeIcoStyle(e,t)),t.open?(j.replaceSwitchClass(t,d,g.folder.OPEN),j.replaceIcoClass(t,N,g.folder.OPEN),i==!1||e.view.expandSpeed==""?(o.show(),h.apply(s,[])):u&&u.length>0?o.slideDown(e.view.expandSpeed,s):(o.show(),h.apply(s,[]))):(j.replaceSwitchClass(t,d,g.folder.CLOSE),j.replaceIcoClass(t,N,g.folder.CLOSE),i==!1||e.view.expandSpeed==""||!(u&&u.length>0)?(o.hide(),h.apply(s,[])):o.slideUp(e.view.expandSpeed,s))):h.apply(s,[])}}else h.apply(s,[])},expandCollapseParentNode:function(e,t,o,i,s){t&&(t.parentTId?(j.expandCollapseNode(e,t,o,i),t.parentTId&&j.expandCollapseParentNode(e,t.getParentNode(),o,i,s)):j.expandCollapseNode(e,t,o,i,s))},expandCollapseSonNode:function(e,t,o,i,s){var d=e.getRoot(e),d=t?e.nodeChildren(e,t):e.nodeChildren(e,d),c=t?!1:i,u=e.getRoot(e).expandTriggerFlag;if(e.getRoot(e).expandTriggerFlag=!1,d)for(var f=0,N=d.length;f<N;f++)d[f]&&j.expandCollapseSonNode(e,d[f],o,c);e.getRoot(e).expandTriggerFlag=u,j.expandCollapseNode(e,t,o,i,s)},isSelectedNode:function(e,t){if(!t)return!1;var o=e.getRoot(e).curSelectedList,i;for(i=o.length-1;i>=0;i--)if(t===o[i])return!0;return!1},makeDOMNodeIcon:function(e,t,o){var i=e.nodeName(t,o),i=t.view.nameIsHTML?i:i.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;");e.push("<span id='",o.tId,g.id.ICON,"' title='' treeNode",g.id.ICON," class='",j.makeNodeIcoClass(t,o),"' style='",j.makeNodeIcoStyle(t,o),"'></span><span id='",o.tId,g.id.SPAN,"' class='",g.className.NAME,"'>",i,"</span>")},makeDOMNodeLine:function(e,t,o){e.push("<span id='",o.tId,g.id.SWITCH,"' title='' class='",j.makeNodeLineClass(t,o),"' treeNode",g.id.SWITCH,"></span>")},makeDOMNodeMainAfter:function(e){e.push("</li>")},makeDOMNodeMainBefore:function(e,t,o){e.push("<li id='",o.tId,"' class='",g.className.LEVEL,o.level,"' tabindex='0' hidefocus='true' treenode>")},makeDOMNodeNameAfter:function(e){e.push("</a>")},makeDOMNodeNameBefore:function(e,t,o){var i=e.nodeTitle(t,o),s=j.makeNodeUrl(t,o),d=j.makeNodeFontCss(t,o),c=[],u;for(u in d)c.push(u,":",d[u],";");e.push("<a id='",o.tId,g.id.A,"' class='",g.className.LEVEL,o.level,"' treeNode",g.id.A,' onclick="',o.click||"",'" ',s!=null&&s.length>0?"href='"+s+"'":""," target='",j.makeNodeTarget(o),"' style='",c.join(""),"'"),h.apply(t.view.showTitle,[t.treeId,o],t.view.showTitle)&&i&&e.push("title='",i.replace(/'/g,"&#39;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),"'"),e.push(">")},makeNodeFontCss:function(e,t){var o=h.apply(e.view.fontCss,[e.treeId,t],e.view.fontCss);return o&&typeof o!="function"?o:{}},makeNodeIcoClass:function(e,t){var o=["ico"];if(!t.isAjaxing){var i=e.nodeIsParent(e,t);o[0]=(t.iconSkin?t.iconSkin+"_":"")+o[0],i?o.push(t.open?g.folder.OPEN:g.folder.CLOSE):o.push(g.folder.DOCU)}return g.className.BUTTON+" "+o.join("_")},makeNodeIcoStyle:function(e,t){var o=[];if(!t.isAjaxing){var i=e.nodeIsParent(e,t)&&t.iconOpen&&t.iconClose?t.open?t.iconOpen:t.iconClose:t[e.data.key.icon];i&&o.push("background:url(",i,") 0 0 no-repeat;"),(e.view.showIcon==!1||!h.apply(e.view.showIcon,[e.treeId,t],!0))&&o.push("width:0px;height:0px;")}return o.join("")},makeNodeLineClass:function(e,t){var o=[];return e.view.showLine?t.level==0&&t.isFirstNode&&t.isLastNode?o.push(g.line.ROOT):t.level==0&&t.isFirstNode?o.push(g.line.ROOTS):t.isLastNode?o.push(g.line.BOTTOM):o.push(g.line.CENTER):o.push(g.line.NOLINE),e.nodeIsParent(e,t)?o.push(t.open?g.folder.OPEN:g.folder.CLOSE):o.push(g.folder.DOCU),j.makeNodeLineClassEx(t)+o.join("_")},makeNodeLineClassEx:function(e){return g.className.BUTTON+" "+g.className.LEVEL+e.level+" "+g.className.SWITCH+" "},makeNodeTarget:function(e){return e.target||"_blank"},makeNodeUrl:function(e,t){var o=e.data.key.url;return t[o]?t[o]:null},makeUlHtml:function(e,t,o,i){o.push("<ul id='",t.tId,g.id.UL,"' class='",g.className.LEVEL,t.level," ",j.makeUlLineClass(e,t),"' style='display:",t.open?"block":"none","'>"),o.push(i),o.push("</ul>")},makeUlLineClass:function(e,t){return e.view.showLine&&!t.isLastNode?g.line.LINE:""},removeChildNodes:function(e,t){if(t){var o=e.nodeChildren(e,t);if(o){for(var i=0,s=o.length;i<s;i++)e.removeNodeCache(e,o[i]);e.removeSelectedNode(e),delete t[e.data.key.children],e.data.keep.parent?l(t,g.id.UL,e).empty():(e.nodeIsParent(e,t,!1),t.open=!1,o=l(t,g.id.SWITCH,e),i=l(t,g.id.ICON,e),j.replaceSwitchClass(t,o,g.folder.DOCU),j.replaceIcoClass(t,i,g.folder.DOCU),l(t,g.id.UL,e).remove())}}},scrollIntoView:function(e,t){if(t)if(typeof Element=="undefined"){var o=e.treeObj.get(0).getBoundingClientRect(),i=t.getBoundingClientRect();(i.top<o.top||i.bottom>o.bottom||i.right>o.right||i.left<o.left)&&t.scrollIntoView()}else Element.prototype.scrollIntoViewIfNeeded||(Element.prototype.scrollIntoViewIfNeeded=function(s){function d(g,a){return{start:g,length:a,end:g+a}}function c(g,a){return s===!1||a.start<g.end&&g.start<a.end?Math.max(g.end-a.length,Math.min(a.start,g.start)):(g.start+g.end-a.length)/2}function u(g,a){return{x:g,y:a,translate:function(n,r){return u(g+n,a+r)}}}function f(g,a){for(;g;)a=a.translate(g.offsetLeft,g.offsetTop),g=g.offsetParent;return a}for(var N=f(this,u(0,0)),S=u(this.offsetWidth,this.offsetHeight),_=this.parentNode,U;_ instanceof HTMLElement;)U=f(_,u(_.clientLeft,_.clientTop)),_.scrollLeft=c(d(N.x-U.x,S.x),d(_.scrollLeft,_.clientWidth)),_.scrollTop=c(d(N.y-U.y,S.y),d(_.scrollTop,_.clientHeight)),N=N.translate(-_.scrollLeft,-_.scrollTop),_=_.parentNode}),t.scrollIntoViewIfNeeded()},setFirstNode:function(e,t){var o=e.nodeChildren(e,t);o.length>0&&(o[0].isFirstNode=!0)},setLastNode:function(e,t){var o=e.nodeChildren(e,t);o.length>0&&(o[o.length-1].isLastNode=!0)},removeNode:function(e,t){var o=e.getRoot(e),i=t.parentTId?t.getParentNode():o;if(t.isFirstNode=!1,t.isLastNode=!1,t.getPreNode=function(){return null},t.getNextNode=function(){return null},e.getNodeCache(e,t.tId)){l(t,e).remove(),e.removeNodeCache(e,t),e.removeSelectedNode(e,t);for(var s=e.nodeChildren(e,i),u=0,d=s.length;u<d;u++)if(s[u].tId==t.tId){s.splice(u,1);break}j.setFirstNode(e,i),j.setLastNode(e,i);var c,u=s.length;if(!e.data.keep.parent&&u==0)e.nodeIsParent(e,i,!1),i.open=!1,delete i[e.data.key.children],u=l(i,g.id.UL,e),d=l(i,g.id.SWITCH,e),c=l(i,g.id.ICON,e),j.replaceSwitchClass(i,d,g.folder.DOCU),j.replaceIcoClass(i,c,g.folder.DOCU),u.css("display","none");else if(e.view.showLine&&u>0){var f=s[u-1],u=l(f,g.id.UL,e),d=l(f,g.id.SWITCH,e);c=l(f,g.id.ICON,e),i==o?s.length==1?j.replaceSwitchClass(f,d,g.line.ROOT):(o=l(s[0],g.id.SWITCH,e),j.replaceSwitchClass(s[0],o,g.line.ROOTS),j.replaceSwitchClass(f,d,g.line.BOTTOM)):j.replaceSwitchClass(f,d,g.line.BOTTOM),u.removeClass(g.line.LINE)}}},replaceIcoClass:function(e,t,o){if(t&&!e.isAjaxing&&(e=t.attr("class"),e!=null)){switch(e=e.split("_"),o){case g.folder.OPEN:case g.folder.CLOSE:case g.folder.DOCU:e[e.length-1]=o}t.attr("class",e.join("_"))}},replaceSwitchClass:function(e,t,o){if(t){var i=t.attr("class");if(i!=null){switch(i=i.split("_"),o){case g.line.ROOT:case g.line.ROOTS:case g.line.CENTER:case g.line.BOTTOM:case g.line.NOLINE:i[0]=j.makeNodeLineClassEx(e)+o;break;case g.folder.OPEN:case g.folder.CLOSE:case g.folder.DOCU:i[1]=o}t.attr("class",i.join("_")),o!==g.folder.DOCU?t.removeAttr("disabled"):t.attr("disabled","disabled")}}},selectNode:function(e,t,o){o||j.cancelPreSelectedNode(e,null,t),l(t,g.id.A,e).addClass(g.node.CURSELECTED),e.addSelectedNode(e,t),e.treeObj.trigger(g.event.SELECTED,[e.treeId,t])},setNodeFontCss:function(e,t){var o=l(t,g.id.A,e),i=j.makeNodeFontCss(e,t);i&&o.css(i)},setNodeLineIcos:function(e,t){if(t){var o=l(t,g.id.SWITCH,e),i=l(t,g.id.UL,e),s=l(t,g.id.ICON,e),d=j.makeUlLineClass(e,t);d.length==0?i.removeClass(g.line.LINE):i.addClass(d),o.attr("class",j.makeNodeLineClass(e,t)),e.nodeIsParent(e,t)?o.removeAttr("disabled"):o.attr("disabled","disabled"),s.removeAttr("style"),s.attr("style",j.makeNodeIcoStyle(e,t)),s.attr("class",j.makeNodeIcoClass(e,t))}},setNodeName:function(e,t){var o=e.nodeTitle(e,t),i=l(t,g.id.SPAN,e);i.empty(),e.view.nameIsHTML?i.html(e.nodeName(e,t)):i.text(e.nodeName(e,t)),h.apply(e.view.showTitle,[e.treeId,t],e.view.showTitle)&&l(t,g.id.A,e).attr("title",o||"")},setNodeTarget:function(e,t){l(t,g.id.A,e).attr("target",j.makeNodeTarget(t))},setNodeUrl:function(e,t){var o=l(t,g.id.A,e),i=j.makeNodeUrl(e,t);i==null||i.length==0?o.removeAttr("href"):o.attr("href",i)},switchNode:function(e,t){t.open||!h.canAsync(e,t)?j.expandCollapseNode(e,t,!t.open):e.async.enable?j.asyncNode(e,t)||j.expandCollapseNode(e,t,!t.open):t&&j.expandCollapseNode(e,t,!t.open)}};r.fn.zTree={consts:{className:{BUTTON:"button",LEVEL:"level",ICO_LOADING:"ico_loading",SWITCH:"switch",NAME:"node_name"},event:{NODECREATED:"ztree_nodeCreated",CLICK:"ztree_click",EXPAND:"ztree_expand",COLLAPSE:"ztree_collapse",ASYNC_SUCCESS:"ztree_async_success",ASYNC_ERROR:"ztree_async_error",REMOVE:"ztree_remove",SELECTED:"ztree_selected",UNSELECTED:"ztree_unselected"},id:{A:"_a",ICON:"_ico",SPAN:"_span",SWITCH:"_switch",UL:"_ul"},line:{ROOT:"root",ROOTS:"roots",CENTER:"center",BOTTOM:"bottom",NOLINE:"noline",LINE:"line"},folder:{OPEN:"open",CLOSE:"close",DOCU:"docu"},node:{CURSELECTED:"curSelectedNode"}},_z:{tools:h,view:j,event:n,data:e},getZTreeObj:function(e){return(e=e.getZTreeTools(e))?e:null},destroy:function(e){if(e&&e.length>0)j.destroy(e.getSetting(e));else for(var t in t)j.destroy(t[t])},init:function(e,t,o){var i=h.clone(P);r.extend(!0,i,t),i.treeId=e.attr("id"),i.treeObj=e,i.treeObj.empty(),t[i.treeId]=i,typeof document.body.style.maxHeight=="undefined"&&(i.view.expandSpeed=""),e.initRoot(i),e=e.getRoot(i),o=o?h.clone(h.isArray(o)?o:[o]):[],i.data.simpleData.enable?e.nodeChildren(i,e,e.transformTozTreeFormat(i,o)):e.nodeChildren(i,e,o),e.initCache(i),n.unbindTree(i),n.bindTree(i),n.unbindEvent(i),n.bindEvent(i);var s={setting:i,addNodes:function(d,c,u,f){function N(){j.addNodes(i,d,c,_,f==!0)}d||(d=null);var S=e.nodeIsParent(i,d);if(d&&!S&&i.data.keep.leaf||(S=parseInt(c,10),isNaN(S)?(f=!!u,u=c,c=-1):c=S,!u))return null;var _=h.clone(h.isArray(u)?u:[u]);return h.canAsync(i,d)?j.asyncNode(i,d,f,N):N(),_},cancelSelectedNode:function(d){j.cancelPreSelectedNode(i,d)},destroy:function(){j.destroy(i)},expandAll:function(d){return d=!!d,j.expandCollapseSonNode(i,null,d,!0),d},expandNode:function(d,c,u,f,N){function S(){var _=l(d,i).get(0);_&&f!==!1&&j.scrollIntoView(i,_)}return!d||!e.nodeIsParent(i,d)||(c!==!0&&c!==!1&&(c=!d.open),(N=!!N)&&c&&h.apply(i.callback.beforeExpand,[i.treeId,d],!0)==!1)||N&&!c&&h.apply(i.callback.beforeCollapse,[i.treeId,d],!0)==!1||(c&&d.parentTId&&j.expandCollapseParentNode(i,d.getParentNode(),c,!1),c===d.open&&!u)?null:(e.getRoot(i).expandTriggerFlag=N,!h.canAsync(i,d)&&u?j.expandCollapseSonNode(i,d,c,!0,S):(d.open=!c,j.switchNode(this.setting,d),S()),c)},getNodes:function(){return e.getNodes(i)},getNodeByParam:function(d,c,u){return d?e.getNodeByParam(i,u?e.nodeChildren(i,u):e.getNodes(i),d,c):null},getNodeByTId:function(d){return e.getNodeCache(i,d)},getNodesByParam:function(d,c,u){return d?e.getNodesByParam(i,u?e.nodeChildren(i,u):e.getNodes(i),d,c):null},getNodesByParamFuzzy:function(d,c,u){return d?e.getNodesByParamFuzzy(i,u?e.nodeChildren(i,u):e.getNodes(i),d,c):null},getNodesByFilter:function(d,c,u,f){return c=!!c,!d||typeof d!="function"?c?null:[]:e.getNodesByFilter(i,u?e.nodeChildren(i,u):e.getNodes(i),d,c,f)},getNodeIndex:function(d){if(!d)return null;for(var c=d.parentTId?d.getParentNode():e.getRoot(i),c=e.nodeChildren(i,c),u=0,f=c.length;u<f;u++)if(c[u]==d)return u;return-1},getSelectedNodes:function(){for(var d=[],c=e.getRoot(i).curSelectedList,u=0,f=c.length;u<f;u++)d.push(c[u]);return d},isSelectedNode:function(d){return e.isSelectedNode(i,d)},reAsyncChildNodesPromise:function(d,c,u){return new Promise(function(f,N){try{s.reAsyncChildNodes(d,c,u,function(){f(d)})}catch(S){N(S)}})},reAsyncChildNodes:function(d,c,u,f){if(this.setting.async.enable){var N=!d;if(N&&(d=e.getRoot(i)),c=="refresh"){for(var c=e.nodeChildren(i,d),S=0,_=c?c.length:0;S<_;S++)e.removeNodeCache(i,c[S]);e.removeSelectedNode(i),e.nodeChildren(i,d,[]),N?this.setting.treeObj.empty():l(d,g.id.UL,i).empty()}j.asyncNode(this.setting,N?null:d,!!u,f)}},refresh:function(){this.setting.treeObj.empty();var d=e.getRoot(i),c=e.nodeChildren(i,d);e.initRoot(i),e.nodeChildren(i,d,c),e.initCache(i),j.createNodes(i,0,e.nodeChildren(i,d),null,-1)},removeChildNodes:function(d){if(!d)return null;var c=e.nodeChildren(i,d);return j.removeChildNodes(i,d),c||null},removeNode:function(d,c){d&&(c=!!c,c&&h.apply(i.callback.beforeRemove,[i.treeId,d],!0)==!1||(j.removeNode(i,d),c&&this.setting.treeObj.trigger(g.event.REMOVE,[i.treeId,d])))},selectNode:function(d,c,u){function f(){if(!u){var N=l(d,i).get(0);j.scrollIntoView(i,N)}}if(d&&h.uCanDo(i)){if(c=i.view.selectedMulti&&c,d.parentTId)j.expandCollapseParentNode(i,d.getParentNode(),!0,!1,f);else if(!u)try{l(d,i).focus().blur()}catch(N){}j.selectNode(i,d,c)}},transformTozTreeNodes:function(d){return e.transformTozTreeFormat(i,d)},transformToArray:function(d){return e.transformToArrayFormat(i,d)},updateNode:function(d){d&&l(d,i).get(0)&&h.uCanDo(i)&&(j.setNodeName(i,d),j.setNodeTarget(i,d),j.setNodeUrl(i,d),j.setNodeLineIcos(i,d),j.setNodeFontCss(i,d))}};return e.treeTools=s,e.setZTreeTools(i,s),(o=e.nodeChildren(i,e))&&o.length>0?j.createNodes(i,0,o,null,-1):i.async.enable&&i.async.url&&i.async.url!==""&&j.asyncNode(i),s}};var Q=r.fn.zTree,l=h.$,g=Q.consts})(jQuery),function(e){var t,o,i,s={event:{CHECK:"ztree_check"},id:{CHECK:"_check"},checkbox:{STYLE:"checkbox",DEFAULT:"chk",DISABLED:"disable",FALSE:"false",TRUE:"true",FULL:"full",PART:"part",FOCUS:"focus"},radio:{STYLE:"radio",TYPE_ALL:"all",TYPE_LEVEL:"level"}},d={check:{enable:!1,autoCheckTrigger:!1,chkStyle:s.checkbox.STYLE,nocheckInherit:!1,chkDisabledInherit:!1,radioType:s.radio.TYPE_LEVEL,chkboxType:{Y:"ps",N:"ps"}},data:{key:{checked:"checked"}},callback:{beforeCheck:null,onCheck:null}};t=function(a,n){if(n.chkDisabled===!0)return!1;var r=N.getSetting(a.data.treeId);if(c.apply(r.callback.beforeCheck,[r.treeId,n],!0)==!1)return!0;var l=N.nodeChecked(r,n);return N.nodeChecked(r,n,!l),f.checkNodeRelation(r,n),l=S(n,u.id.CHECK,r),f.setChkClass(r,l,n),f.repairParentChkClassWithSelf(r,n),r.treeObj.trigger(u.event.CHECK,[a,r.treeId,n]),!0},o=function(a,n){if(n.chkDisabled===!0)return!1;var r=N.getSetting(a.data.treeId),l=S(n,u.id.CHECK,r);return n.check_Focus=!0,f.setChkClass(r,l,n),!0},i=function(a,n){if(n.chkDisabled===!0)return!1;var r=N.getSetting(a.data.treeId),l=S(n,u.id.CHECK,r);return n.check_Focus=!1,f.setChkClass(r,l,n),!0},e.extend(!0,e.fn.zTree.consts,s),e.extend(!0,e.fn.zTree._z,{tools:{},view:{checkNodeRelation:function(a,n){var r,l,p;if(l=u.radio,r=N.nodeChecked(a,n),a.check.chkStyle==l.STYLE){var h=N.getRadioCheckedList(a);if(r)if(a.check.radioType==l.TYPE_ALL){for(l=h.length-1;l>=0;l--){r=h[l];var C=N.nodeChecked(a,r);C&&r!=n&&(N.nodeChecked(a,r,!1),h.splice(l,1),f.setChkClass(a,S(r,u.id.CHECK,a),r),r.parentTId!=n.parentTId&&f.repairParentChkClassWithSelf(a,r))}h.push(n)}else for(h=n.parentTId?n.getParentNode():N.getRoot(a),h=N.nodeChildren(a,h),l=0,p=h.length;l<p;l++)r=h[l],(C=N.nodeChecked(a,r))&&r!=n&&(N.nodeChecked(a,r,!1),f.setChkClass(a,S(r,u.id.CHECK,a),r));else if(a.check.radioType==l.TYPE_ALL){for(l=0,p=h.length;l<p;l++)if(n==h[l]){h.splice(l,1);break}}}else h=N.nodeChildren(a,n),r&&(!h||h.length==0||a.check.chkboxType.Y.indexOf("s")>-1)&&f.setSonNodeCheckBox(a,n,!0),!r&&(!h||h.length==0||a.check.chkboxType.N.indexOf("s")>-1)&&f.setSonNodeCheckBox(a,n,!1),r&&a.check.chkboxType.Y.indexOf("p")>-1&&f.setParentNodeCheckBox(a,n,!0),!r&&a.check.chkboxType.N.indexOf("p")>-1&&f.setParentNodeCheckBox(a,n,!1)},makeChkClass:function(a,n){var r=u.checkbox,l=u.radio,p="",h=N.nodeChecked(a,n),p=n.chkDisabled===!0?r.DISABLED:n.halfCheck?r.PART:a.check.chkStyle==l.STYLE?n.check_Child_State<1?r.FULL:r.PART:h?n.check_Child_State===2||n.check_Child_State===-1?r.FULL:r.PART:n.check_Child_State<1?r.FULL:r.PART,l=a.check.chkStyle+"_"+(h?r.TRUE:r.FALSE)+"_"+p,l=n.check_Focus&&n.chkDisabled!==!0?l+"_"+r.FOCUS:l;return u.className.BUTTON+" "+r.DEFAULT+" "+l},repairAllChk:function(a,n){if(a.check.enable&&a.check.chkStyle===u.checkbox.STYLE)for(var r=N.getRoot(a),r=N.nodeChildren(a,r),l=0,p=r.length;l<p;l++){var h=r[l];h.nocheck!==!0&&h.chkDisabled!==!0&&N.nodeChecked(a,h,n),f.setSonNodeCheckBox(a,h,n)}},repairChkClass:function(a,n){if(n&&(N.makeChkFlag(a,n),n.nocheck!==!0)){var r=S(n,u.id.CHECK,a);f.setChkClass(a,r,n)}},repairParentChkClass:function(a,n){if(n&&n.parentTId){var r=n.getParentNode();f.repairChkClass(a,r),f.repairParentChkClass(a,r)}},repairParentChkClassWithSelf:function(a,n){if(n){var r=N.nodeChildren(a,n);r&&r.length>0?f.repairParentChkClass(a,r[0]):f.repairParentChkClass(a,n)}},repairSonChkDisabled:function(a,n,r,l){if(n&&(n.chkDisabled!=r&&(n.chkDisabled=r),f.repairChkClass(a,n),(n=N.nodeChildren(a,n))&&l))for(var p=0,h=n.length;p<h;p++)f.repairSonChkDisabled(a,n[p],r,l)},repairParentChkDisabled:function(a,n,r,l){n&&(n.chkDisabled!=r&&l&&(n.chkDisabled=r),f.repairChkClass(a,n),f.repairParentChkDisabled(a,n.getParentNode(),r,l))},setChkClass:function(a,n,r){n&&(r.nocheck===!0?n.hide():n.show(),n.attr("class",f.makeChkClass(a,r)))},setParentNodeCheckBox:function(a,n,r,l){var p=S(n,u.id.CHECK,a);if(l||(l=n),N.makeChkFlag(a,n),n.nocheck!==!0&&n.chkDisabled!==!0&&(N.nodeChecked(a,n,r),f.setChkClass(a,p,n),a.check.autoCheckTrigger&&n!=l&&a.treeObj.trigger(u.event.CHECK,[null,a.treeId,n])),n.parentTId){if(p=!0,!r)for(var h=N.nodeChildren(a,n.getParentNode()),C=0,m=h.length;C<m;C++){var v=h[C],k=N.nodeChecked(a,v);if(v.nocheck!==!0&&v.chkDisabled!==!0&&k||(v.nocheck===!0||v.chkDisabled===!0)&&v.check_Child_State>0){p=!1;break}}p&&f.setParentNodeCheckBox(a,n.getParentNode(),r,l)}},setSonNodeCheckBox:function(a,n,r,l){if(n){var p=S(n,u.id.CHECK,a);l||(l=n);var h=!1,C=N.nodeChildren(a,n);if(C)for(var m=0,v=C.length;m<v;m++){var k=C[m];f.setSonNodeCheckBox(a,k,r,l),k.chkDisabled===!0&&(h=!0)}n!=N.getRoot(a)&&n.chkDisabled!==!0&&(h&&n.nocheck!==!0&&N.makeChkFlag(a,n),n.nocheck!==!0&&n.chkDisabled!==!0?(N.nodeChecked(a,n,r),!h&&(n.check_Child_State=C&&C.length>0?r?2:0:-1)):n.check_Child_State=-1,f.setChkClass(a,p,n),a.check.autoCheckTrigger&&n!=l&&n.nocheck!==!0&&n.chkDisabled!==!0&&a.treeObj.trigger(u.event.CHECK,[null,a.treeId,n]))}}},event:{},data:{getRadioCheckedList:function(a){for(var n=N.getRoot(a).radioCheckedList,r=0,l=n.length;r<l;r++)N.getNodeCache(a,n[r].tId)||(n.splice(r,1),r--,l--);return n},getCheckStatus:function(a,n){if(!a.check.enable||n.nocheck||n.chkDisabled)return null;var r=N.nodeChecked(a,n);return{checked:r,half:n.halfCheck?n.halfCheck:a.check.chkStyle==u.radio.STYLE?n.check_Child_State===2:r?n.check_Child_State>-1&&n.check_Child_State<2:n.check_Child_State>0}},getTreeCheckedNodes:function(a,n,r,l){if(!n)return[];for(var p=r&&a.check.chkStyle==u.radio.STYLE&&a.check.radioType==u.radio.TYPE_ALL,l=l||[],h=0,C=n.length;h<C;h++){var m=n[h],v=N.nodeChildren(a,m),k=N.nodeChecked(a,m);if(m.nocheck!==!0&&m.chkDisabled!==!0&&k==r&&(l.push(m),p)||(N.getTreeCheckedNodes(a,v,r,l),p&&l.length>0))break}return l},getTreeChangeCheckedNodes:function(a,n,r){if(!n)return[];for(var r=r||[],l=0,p=n.length;l<p;l++){var h=n[l],C=N.nodeChildren(a,h),m=N.nodeChecked(a,h);h.nocheck!==!0&&h.chkDisabled!==!0&&m!=h.checkedOld&&r.push(h),N.getTreeChangeCheckedNodes(a,C,r)}return r},makeChkFlag:function(a,n){if(n){var r=-1,l=N.nodeChildren(a,n);if(l)for(var p=0,h=l.length;p<h;p++){var C=l[p],m=N.nodeChecked(a,C),v=-1;if(a.check.chkStyle==u.radio.STYLE)if(v=C.nocheck===!0||C.chkDisabled===!0?C.check_Child_State:C.halfCheck===!0||m||C.check_Child_State>0?2:0,v==2){r=2;break}else v==0&&(r=0);else if(a.check.chkStyle==u.checkbox.STYLE)if(v=C.nocheck===!0||C.chkDisabled===!0?C.check_Child_State:C.halfCheck===!0?1:m?C.check_Child_State===-1||C.check_Child_State===2?2:1:C.check_Child_State>0?1:0,v===1){r=1;break}else if(v===2&&r>-1&&p>0&&v!==r){r=1;break}else if(r===2&&v>-1&&v<2){r=1;break}else v>-1&&(r=v)}n.check_Child_State=r}}}});var e=e.fn.zTree,c=e._z.tools,u=e.consts,f=e._z.view,N=e._z.data,S=c.$;N.nodeChecked=function(a,n,r){return n?(a=a.data.key.checked,typeof r!="undefined"&&(typeof r=="string"&&(r=c.eqs(r,"true")),n[a]=!!r),n[a]):!1},N.exSetting(d),N.addInitBind(function(a){a.treeObj.bind(u.event.CHECK,function(n,r,l,p){n.srcEvent=r,c.apply(a.callback.onCheck,[n,l,p])})}),N.addInitUnBind(function(a){a.treeObj.unbind(u.event.CHECK)}),N.addInitCache(function(){}),N.addInitNode(function(a,n,r,l){r&&(n=N.nodeChecked(a,r),n=N.nodeChecked(a,r,n),r.checkedOld=n,typeof r.nocheck=="string"&&(r.nocheck=c.eqs(r.nocheck,"true")),r.nocheck=!!r.nocheck||a.check.nocheckInherit&&l&&!!l.nocheck,typeof r.chkDisabled=="string"&&(r.chkDisabled=c.eqs(r.chkDisabled,"true")),r.chkDisabled=!!r.chkDisabled||a.check.chkDisabledInherit&&l&&!!l.chkDisabled,typeof r.halfCheck=="string"&&(r.halfCheck=c.eqs(r.halfCheck,"true")),r.halfCheck=!!r.halfCheck,r.check_Child_State=-1,r.check_Focus=!1,r.getCheckStatus=function(){return N.getCheckStatus(a,r)},a.check.chkStyle==u.radio.STYLE&&a.check.radioType==u.radio.TYPE_ALL&&n&&N.getRoot(a).radioCheckedList.push(r))}),N.addInitProxy(function(a){var n=a.target,r=N.getSetting(a.data.treeId),l="",p=null,h="",C=null;if(c.eqs(a.type,"mouseover")?r.check.enable&&c.eqs(n.tagName,"span")&&n.getAttribute("treeNode"+u.id.CHECK)!==null&&(l=c.getNodeMainDom(n).id,h="mouseoverCheck"):c.eqs(a.type,"mouseout")?r.check.enable&&c.eqs(n.tagName,"span")&&n.getAttribute("treeNode"+u.id.CHECK)!==null&&(l=c.getNodeMainDom(n).id,h="mouseoutCheck"):c.eqs(a.type,"click")&&r.check.enable&&c.eqs(n.tagName,"span")&&n.getAttribute("treeNode"+u.id.CHECK)!==null&&(l=c.getNodeMainDom(n).id,h="checkNode"),l.length>0)switch(p=N.getNodeCache(r,l),h){case"checkNode":C=t;break;case"mouseoverCheck":C=o;break;case"mouseoutCheck":C=i}return{stop:h==="checkNode",node:p,nodeEventType:h,nodeEventCallback:C,treeEventType:"",treeEventCallback:null}},!0),N.addInitRoot(function(a){N.getRoot(a).radioCheckedList=[]}),N.addBeforeA(function(a,n,r){a.check.enable&&(N.makeChkFlag(a,n),r.push("<span ID='",n.tId,u.id.CHECK,"' class='",f.makeChkClass(a,n),"' treeNode",u.id.CHECK,n.nocheck===!0?" style='display:none;'":"","></span>"))}),N.addZTreeTools(function(a,n){n.checkNode=function(l,p,h,C){var m=N.nodeChecked(a,l);l.chkDisabled!==!0&&(p!==!0&&p!==!1&&(p=!m),C=!!C,(m!==p||h)&&!(C&&c.apply(this.setting.callback.beforeCheck,[this.setting.treeId,l],!0)==!1)&&c.uCanDo(this.setting)&&this.setting.check.enable&&l.nocheck!==!0)&&(N.nodeChecked(a,l,p),p=S(l,u.id.CHECK,this.setting),(h||this.setting.check.chkStyle===u.radio.STYLE)&&f.checkNodeRelation(this.setting,l),f.setChkClass(this.setting,p,l),f.repairParentChkClassWithSelf(this.setting,l),C&&this.setting.treeObj.trigger(u.event.CHECK,[null,this.setting.treeId,l]))},n.checkAllNodes=function(l){f.repairAllChk(this.setting,!!l)},n.getCheckedNodes=function(l){var l=l!==!1,p=N.nodeChildren(a,N.getRoot(this.setting));return N.getTreeCheckedNodes(this.setting,p,l)},n.getChangeCheckedNodes=function(){var l=N.nodeChildren(a,N.getRoot(this.setting));return N.getTreeChangeCheckedNodes(this.setting,l)},n.setChkDisabled=function(l,p,h,C){p=!!p,h=!!h,f.repairSonChkDisabled(this.setting,l,p,!!C),f.repairParentChkDisabled(this.setting,l.getParentNode(),p,h)};var r=n.updateNode;n.updateNode=function(l,p){if(r&&r.apply(n,arguments),l&&this.setting.check.enable&&S(l,this.setting).get(0)&&c.uCanDo(this.setting)){var h=S(l,u.id.CHECK,this.setting);(p==!0||this.setting.check.chkStyle===u.radio.STYLE)&&f.checkNodeRelation(this.setting,l),f.setChkClass(this.setting,h,l),f.repairParentChkClassWithSelf(this.setting,l)}}});var _=f.createNodes;f.createNodes=function(a,n,r,l,p){_&&_.apply(f,arguments),r&&f.repairParentChkClassWithSelf(a,l)};var U=f.removeNode;f.removeNode=function(a,n){var r=n.getParentNode();U&&U.apply(f,arguments),n&&r&&(f.repairChkClass(a,r),f.repairParentChkClass(a,r))};var g=f.appendNodes;f.appendNodes=function(a,n,r,l,p,h,C){var m="";return g&&(m=g.apply(f,arguments)),l&&N.makeChkFlag(a,l),m}}(jQuery),function(e){var t={event:{DRAG:"ztree_drag",DROP:"ztree_drop",RENAME:"ztree_rename",DRAGMOVE:"ztree_dragmove"},id:{EDIT:"_edit",INPUT:"_input",REMOVE:"_remove"},move:{TYPE_INNER:"inner",TYPE_PREV:"prev",TYPE_NEXT:"next"},node:{CURSELECTED_EDIT:"curSelectedNode_Edit",TMPTARGET_TREE:"tmpTargetzTree",TMPTARGET_NODE:"tmpTargetNode"}},o={onHoverOverNode:function(n,r){var l=u.getSetting(n.data.treeId),p=u.getRoot(l);p.curHoverNode!=r&&o.onHoverOutNode(n),p.curHoverNode=r,c.addHoverDom(l,r)},onHoverOutNode:function(n){var n=u.getSetting(n.data.treeId),r=u.getRoot(n);r.curHoverNode&&!u.isSelectedNode(n,r.curHoverNode)&&(c.removeTreeDom(n,r.curHoverNode),r.curHoverNode=null)},onMousedownNode:function(n,r){function l(R){if(k.dragFlag==0&&Math.abs(de-R.clientX)<v.edit.drag.minMoveSize&&Math.abs(le-R.clientY)<v.edit.drag.minMoveSize)return!0;var b,B,E,z;if(A.css("cursor","pointer"),k.dragFlag==0){if(s.apply(v.callback.beforeDrag,[v.treeId,T],!0)==!1)return p(R),!0;for(b=0,B=T.length;b<B;b++)b==0&&(k.dragNodeShowBefore=[]),E=T[b],u.nodeIsParent(v,E)&&E.open?(c.expandCollapseNode(v,E,!E.open),k.dragNodeShowBefore[E.tId]=!0):k.dragNodeShowBefore[E.tId]=!1;k.dragFlag=1,I.showHoverDom=!1,s.showIfameMask(v,!0),z=!0;var P=-1;if(T.length>1){var H=T[0].parentTId?u.nodeChildren(v,T[0].getParentNode()):u.getNodes(v);for(E=[],b=0,B=H.length;b<B;b++)if(k.dragNodeShowBefore[H[b].tId]!==void 0&&(z&&P>-1&&P+1!==b&&(z=!1),E.push(H[b]),P=b),T.length===E.length){T=E;break}}for(z&&(q=T[0].getPreNode(),te=T[T.length-1].getNextNode()),Y=f("<ul class='zTreeDragUL'></ul>",v),b=0,B=T.length;b<B;b++)E=T[b],E.editNameFlag=!1,c.selectNode(v,E,b>0),c.removeTreeDom(v,E),b>v.edit.drag.maxShowNodeNum-1||(z=f("<li id='"+E.tId+"_tmp'></li>",v),z.append(f(E,d.id.A,v).clone()),z.css("padding","0"),z.children("#"+E.tId+d.id.A).removeClass(d.node.CURSELECTED),Y.append(z),b==v.edit.drag.maxShowNodeNum-1&&(z=f("<li id='"+E.tId+"_moretmp'><a>  ...  </a></li>",v),Y.append(z)));Y.attr("id",T[0].tId+d.id.UL+"_tmp"),Y.addClass(v.treeObj.attr("class")),Y.appendTo(A),w=f("<span class='tmpzTreeMove_arrow'></span>",v),w.attr("id","zTreeMove_arrow_tmp"),w.appendTo(A),v.treeObj.trigger(d.event.DRAG,[R,v.treeId,T])}if(k.dragFlag==1){O&&w.attr("id")==R.target.id&&x&&R.clientX+F.scrollLeft()+2>e("#"+x+d.id.A,O).offset().left?(E=e("#"+x+d.id.A,O),R.target=E.length>0?E.get(0):R.target):O&&(O.removeClass(d.node.TMPTARGET_TREE),x&&e("#"+x+d.id.A,O).removeClass(d.node.TMPTARGET_NODE+"_"+d.move.TYPE_PREV).removeClass(d.node.TMPTARGET_NODE+"_"+t.move.TYPE_NEXT).removeClass(d.node.TMPTARGET_NODE+"_"+t.move.TYPE_INNER)),x=O=null,G=!1,y=v,E=u.getSettings();for(var D in E)E[D].treeId&&E[D].edit.enable&&E[D].treeId!=v.treeId&&(R.target.id==E[D].treeId||e(R.target).parents("#"+E[D].treeId).length>0)&&(G=!0,y=E[D]);D=F.scrollTop(),z=F.scrollLeft(),P=y.treeObj.offset(),b=y.treeObj.get(0).scrollHeight,E=y.treeObj.get(0).scrollWidth,B=R.clientY+D-P.top;var V=y.treeObj.height()+P.top-R.clientY-D,ee=R.clientX+z-P.left,Q=y.treeObj.width()+P.left-R.clientX-z,P=B<v.edit.drag.borderMax&&B>v.edit.drag.borderMin,H=V<v.edit.drag.borderMax&&V>v.edit.drag.borderMin,X=ee<v.edit.drag.borderMax&&ee>v.edit.drag.borderMin,ne=Q<v.edit.drag.borderMax&&Q>v.edit.drag.borderMin,V=B>v.edit.drag.borderMin&&V>v.edit.drag.borderMin&&ee>v.edit.drag.borderMin&&Q>v.edit.drag.borderMin,ee=P&&y.treeObj.scrollTop()<=0,Q=H&&y.treeObj.scrollTop()+y.treeObj.height()+10>=b,oe=X&&y.treeObj.scrollLeft()<=0,ae=ne&&y.treeObj.scrollLeft()+y.treeObj.width()+10>=E;if(R.target&&s.isChildOrSelf(R.target,y.treeId)){for(var W=R.target;W&&W.tagName&&!s.eqs(W.tagName,"li")&&W.id!=y.treeId;)W=W.parentNode;var re=!0;for(b=0,B=T.length;b<B;b++)if(E=T[b],W.id===E.tId){re=!1;break}else if(f(E,v).find("#"+W.id).length>0){re=!1;break}re&&R.target&&s.isChildOrSelf(R.target,W.id+d.id.A)&&(O=e(W),x=W.id)}if(E=T[0],V&&s.isChildOrSelf(R.target,y.treeId)&&(!O&&(R.target.id==y.treeId||ee||Q||oe||ae)&&(G||!G&&E.parentTId)&&(O=y.treeObj),P?y.treeObj.scrollTop(y.treeObj.scrollTop()-10):H&&y.treeObj.scrollTop(y.treeObj.scrollTop()+10),X?y.treeObj.scrollLeft(y.treeObj.scrollLeft()-10):ne&&y.treeObj.scrollLeft(y.treeObj.scrollLeft()+10),O&&O!=y.treeObj&&O.offset().left<y.treeObj.offset().left&&y.treeObj.scrollLeft(y.treeObj.scrollLeft()+O.offset().left-y.treeObj.offset().left)),Y.css({top:R.clientY+D+3+"px",left:R.clientX+z+3+"px"}),b=z=0,O&&O.attr("id")!=y.treeId){var K=x==null?null:u.getNodeCache(y,x),P=(R.ctrlKey||R.metaKey)&&v.edit.drag.isMove&&v.edit.drag.isCopy||!v.edit.drag.isMove&&v.edit.drag.isCopy;B=!!(q&&x===q.tId),X=!!(te&&x===te.tId),H=E.parentTId&&E.parentTId==x,E=(P||!X)&&s.apply(y.edit.drag.prev,[y.treeId,T,K],!!y.edit.drag.prev),B=(P||!B)&&s.apply(y.edit.drag.next,[y.treeId,T,K],!!y.edit.drag.next),P=(P||!H)&&!(y.data.keep.leaf&&!u.nodeIsParent(v,K))&&s.apply(y.edit.drag.inner,[y.treeId,T,K],!!y.edit.drag.inner),H=function(){O=null,x="",M=d.move.TYPE_INNER,w.css({display:"none"}),window.zTreeMoveTimer&&(clearTimeout(window.zTreeMoveTimer),window.zTreeMoveTargetNodeTId=null)},!E&&!B&&!P?H():(X=e("#"+x+d.id.A,O),ne=K.isLastNode?null:e("#"+K.getNextNode().tId+d.id.A,O.next()),V=X.offset().top,ee=X.offset().left,Q=E?P?.25:B?.5:1:-1,oe=B?P?.75:E?.5:0:-1,D=(R.clientY+D-V)/X.height(),(Q==1||D<=Q&&D>=-.2)&&E?(z=1-w.width(),b=V-w.height()/2,M=d.move.TYPE_PREV):(oe==0||D>=oe&&D<=1.2)&&B?(z=1-w.width(),b=ne==null||u.nodeIsParent(v,K)&&K.open?V+X.height()-w.height()/2:ne.offset().top-w.height()/2,M=d.move.TYPE_NEXT):P?(z=5-w.width(),b=V,M=d.move.TYPE_INNER):H(),O&&(w.css({display:"block",top:b+"px",left:ee+z+"px"}),X.addClass(d.node.TMPTARGET_NODE+"_"+M),(J!=x||Z!=M)&&(ie=new Date().getTime()),K&&u.nodeIsParent(v,K)&&M==d.move.TYPE_INNER&&(D=!0,window.zTreeMoveTimer&&window.zTreeMoveTargetNodeTId!==K.tId?(clearTimeout(window.zTreeMoveTimer),window.zTreeMoveTargetNodeTId=null):window.zTreeMoveTimer&&window.zTreeMoveTargetNodeTId===K.tId&&(D=!1),D)&&(window.zTreeMoveTimer=setTimeout(function(){M==d.move.TYPE_INNER&&K&&u.nodeIsParent(v,K)&&!K.open&&new Date().getTime()-ie>y.edit.drag.autoOpenTime&&s.apply(y.callback.beforeDragOpen,[y.treeId,K],!0)&&(c.switchNode(y,K),y.edit.drag.autoExpandTrigger&&y.treeObj.trigger(d.event.EXPAND,[y.treeId,K]))},y.edit.drag.autoOpenTime+50),window.zTreeMoveTargetNodeTId=K.tId)))}else M=d.move.TYPE_INNER,O&&s.apply(y.edit.drag.inner,[y.treeId,T,null],!!y.edit.drag.inner)?O.addClass(d.node.TMPTARGET_TREE):O=null,w.css({display:"none"}),window.zTreeMoveTimer&&(clearTimeout(window.zTreeMoveTimer),window.zTreeMoveTargetNodeTId=null);J=x,Z=M,v.treeObj.trigger(d.event.DRAGMOVE,[R,v.treeId,T])}return!1}function p(R){if(window.zTreeMoveTimer&&(clearTimeout(window.zTreeMoveTimer),window.zTreeMoveTargetNodeTId=null),Z=J=null,F.unbind("mousemove",l),F.unbind("mouseup",p),F.unbind("selectstart",h),A.css("cursor",""),O&&(O.removeClass(d.node.TMPTARGET_TREE),x&&e("#"+x+d.id.A,O).removeClass(d.node.TMPTARGET_NODE+"_"+d.move.TYPE_PREV).removeClass(d.node.TMPTARGET_NODE+"_"+t.move.TYPE_NEXT).removeClass(d.node.TMPTARGET_NODE+"_"+t.move.TYPE_INNER)),s.showIfameMask(v,!1),I.showHoverDom=!0,k.dragFlag!=0){k.dragFlag=0;var b,B,E;for(b=0,B=T.length;b<B;b++)E=T[b],u.nodeIsParent(v,E)&&k.dragNodeShowBefore[E.tId]&&!E.open&&(c.expandCollapseNode(v,E,!E.open),delete k.dragNodeShowBefore[E.tId]);Y&&Y.remove(),w&&w.remove();var z=(R.ctrlKey||R.metaKey)&&v.edit.drag.isMove&&v.edit.drag.isCopy||!v.edit.drag.isMove&&v.edit.drag.isCopy;if(!z&&O&&x&&T[0].parentTId&&x==T[0].parentTId&&M==d.move.TYPE_INNER&&(O=null),O){var P=x==null?null:u.getNodeCache(y,x);if(s.apply(v.callback.beforeDrop,[y.treeId,T,P,M,z],!0)==!1)c.selectNodes($,T);else{var H=z?s.clone(T):T;b=function(){if(G){if(!z)for(var D=0,V=T.length;D<V;D++)c.removeNode(v,T[D]);M==d.move.TYPE_INNER?c.addNodes(y,P,-1,H):c.addNodes(y,P.getParentNode(),M==d.move.TYPE_PREV?P.getIndex():P.getIndex()+1,H)}else if(z&&M==d.move.TYPE_INNER)c.addNodes(y,P,-1,H);else if(z)c.addNodes(y,P.getParentNode(),M==d.move.TYPE_PREV?P.getIndex():P.getIndex()+1,H);else if(M!=d.move.TYPE_NEXT)for(D=0,V=H.length;D<V;D++)c.moveNode(y,P,H[D],M,!1);else for(D=-1,V=H.length-1;D<V;V--)c.moveNode(y,P,H[V],M,!1);c.selectNodes(y,H),D=f(H[0],v).get(0),c.scrollIntoView(v,D),v.treeObj.trigger(d.event.DROP,[R,y.treeId,H,P,M,z])},M==d.move.TYPE_INNER&&s.canAsync(y,P)?c.asyncNode(y,P,!1,b):b()}}else c.selectNodes($,T),v.treeObj.trigger(d.event.DROP,[R,v.treeId,T,null,null,null])}}function h(){return!1}var C,m,v=u.getSetting(n.data.treeId),k=u.getRoot(v),I=u.getRoots();if(n.button==2||!v.edit.enable||!v.edit.drag.isCopy&&!v.edit.drag.isMove)return!0;var L=n.target,j=u.getRoot(v).curSelectedList,T=[];if(u.isSelectedNode(v,r))for(C=0,m=j.length;C<m;C++){if(j[C].editNameFlag&&s.eqs(L.tagName,"input")&&L.getAttribute("treeNode"+d.id.INPUT)!==null)return!0;if(T.push(j[C]),T[0].parentTId!==j[C].parentTId){T=[r];break}}else T=[r];c.editNodeBlur=!0,c.cancelCurEditNode(v);var F=e(v.treeObj.get(0).ownerDocument),A=e(v.treeObj.get(0).ownerDocument.body),Y,w,O,G=!1,y=v,$=v,q,te,J=null,Z=null,x=null,M=d.move.TYPE_INNER,de=n.clientX,le=n.clientY,ie=new Date().getTime();return s.uCanDo(v)&&F.bind("mousemove",l),F.bind("mouseup",p),F.bind("selectstart",h),!0}};e.extend(!0,e.fn.zTree.consts,t),e.extend(!0,e.fn.zTree._z,{tools:{getAbs:function(n){return n=n.getBoundingClientRect(),[n.left+(document.body.scrollLeft+document.documentElement.scrollLeft),n.top+(document.body.scrollTop+document.documentElement.scrollTop)]},inputFocus:function(n){n.get(0)&&(n.focus(),s.setCursorPosition(n.get(0),n.val().length))},inputSelect:function(n){n.get(0)&&(n.focus(),n.select())},setCursorPosition:function(n,r){if(n.setSelectionRange)n.focus(),n.setSelectionRange(r,r);else if(n.createTextRange){var l=n.createTextRange();l.collapse(!0),l.moveEnd("character",r),l.moveStart("character",r),l.select()}},showIfameMask:function(n,r){for(var l=u.getRoot(n);l.dragMaskList.length>0;)l.dragMaskList[0].remove(),l.dragMaskList.shift();if(r)for(var p=f("iframe",n),h=0,C=p.length;h<C;h++){var m=p.get(h),v=s.getAbs(m),m=f("<div id='zTreeMask_"+h+"' class='zTreeMask' style='top:"+v[1]+"px; left:"+v[0]+"px; width:"+m.offsetWidth+"px; height:"+m.offsetHeight+"px;'></div>",n);m.appendTo(f("body",n)),l.dragMaskList.push(m)}}},view:{addEditBtn:function(n,r){if(!(r.editNameFlag||f(r,d.id.EDIT,n).length>0)&&s.apply(n.edit.showRenameBtn,[n.treeId,r],n.edit.showRenameBtn)){var l=f(r,d.id.A,n),p="<span class='"+d.className.BUTTON+" edit' id='"+r.tId+d.id.EDIT+"' title='"+s.apply(n.edit.renameTitle,[n.treeId,r],n.edit.renameTitle)+"' treeNode"+d.id.EDIT+" style='display:none;'></span>";l.append(p),f(r,d.id.EDIT,n).bind("click",function(){return!s.uCanDo(n)||s.apply(n.callback.beforeEditName,[n.treeId,r],!0)==!1||c.editNode(n,r),!1}).show()}},addRemoveBtn:function(n,r){if(!(r.editNameFlag||f(r,d.id.REMOVE,n).length>0)&&s.apply(n.edit.showRemoveBtn,[n.treeId,r],n.edit.showRemoveBtn)){var l=f(r,d.id.A,n),p="<span class='"+d.className.BUTTON+" remove' id='"+r.tId+d.id.REMOVE+"' title='"+s.apply(n.edit.removeTitle,[n.treeId,r],n.edit.removeTitle)+"' treeNode"+d.id.REMOVE+" style='display:none;'></span>";l.append(p),f(r,d.id.REMOVE,n).bind("click",function(){return!s.uCanDo(n)||s.apply(n.callback.beforeRemove,[n.treeId,r],!0)==!1||(c.removeNode(n,r),n.treeObj.trigger(d.event.REMOVE,[n.treeId,r])),!1}).bind("mousedown",function(){return!0}).show()}},addHoverDom:function(n,r){u.getRoots().showHoverDom&&(r.isHover=!0,n.edit.enable&&(c.addEditBtn(n,r),c.addRemoveBtn(n,r)),s.apply(n.view.addHoverDom,[n.treeId,r]))},cancelCurEditNode:function(n,r,l){var p=u.getRoot(n),h=p.curEditNode;if(h){var C=p.curEditInput,r=r||(l?u.nodeName(n,h):C.val());if(s.apply(n.callback.beforeRename,[n.treeId,h,r,l],!0)===!1)return!1;u.nodeName(n,h,r),f(h,d.id.A,n).removeClass(d.node.CURSELECTED_EDIT),C.unbind(),c.setNodeName(n,h),h.editNameFlag=!1,p.curEditNode=null,p.curEditInput=null,c.selectNode(n,h,!1),n.treeObj.trigger(d.event.RENAME,[n.treeId,h,l])}return p.noSelection=!0},editNode:function(n,r){var l=u.getRoot(n);if(c.editNodeBlur=!1,u.isSelectedNode(n,r)&&l.curEditNode==r&&r.editNameFlag)setTimeout(function(){s.inputFocus(l.curEditInput)},0);else{r.editNameFlag=!0,c.removeTreeDom(n,r),c.cancelCurEditNode(n),c.selectNode(n,r,!1),f(r,d.id.SPAN,n).html("<input type=text class='rename' id='"+r.tId+d.id.INPUT+"' treeNode"+d.id.INPUT+" >");var p=f(r,d.id.INPUT,n);p.attr("value",u.nodeName(n,r)),n.edit.editNameSelectAll?s.inputSelect(p):s.inputFocus(p),p.bind("blur",function(){c.editNodeBlur||c.cancelCurEditNode(n)}).bind("keydown",function(h){h.keyCode=="13"?(c.editNodeBlur=!0,c.cancelCurEditNode(n)):h.keyCode=="27"&&c.cancelCurEditNode(n,null,!0)}).bind("click",function(){return!1}).bind("dblclick",function(){return!1}),f(r,d.id.A,n).addClass(d.node.CURSELECTED_EDIT),l.curEditInput=p,l.noSelection=!1,l.curEditNode=r}},moveNode:function(n,r,l,p,h,C){var m=u.getRoot(n);if(r!=l&&(!n.data.keep.leaf||!r||u.nodeIsParent(n,r)||p!=d.move.TYPE_INNER)){var v=l.parentTId?l.getParentNode():m,k=r===null||r==m;k&&r===null&&(r=m),k&&(p=d.move.TYPE_INNER),m=r.parentTId?r.getParentNode():m,p!=d.move.TYPE_PREV&&p!=d.move.TYPE_NEXT&&(p=d.move.TYPE_INNER),p==d.move.TYPE_INNER&&(k?l.parentTId=null:(u.nodeIsParent(n,r)||(u.nodeIsParent(n,r,!0),r.open=!!r.open,c.setNodeLineIcos(n,r)),l.parentTId=r.tId));var I;k?I=k=n.treeObj:(!C&&p==d.move.TYPE_INNER?c.expandCollapseNode(n,r,!0,!1):C||c.expandCollapseNode(n,r.getParentNode(),!0,!1),k=f(r,n),I=f(r,d.id.UL,n),k.get(0)&&!I.get(0)&&(I=[],c.makeUlHtml(n,r,I,""),k.append(I.join(""))),I=f(r,d.id.UL,n));var L=f(l,n);L.get(0)?k.get(0)||L.remove():L=c.appendNodes(n,l.level,[l],null,-1,!1,!0).join(""),I.get(0)&&p==d.move.TYPE_INNER?I.append(L):k.get(0)&&p==d.move.TYPE_PREV?k.before(L):k.get(0)&&p==d.move.TYPE_NEXT&&k.after(L);var j;I=-1;var L=0,T=null,k=null,F=l.level,A=u.nodeChildren(n,v),Y=u.nodeChildren(n,m),w=u.nodeChildren(n,r);if(l.isFirstNode)I=0,A.length>1&&(T=A[1],T.isFirstNode=!0);else if(l.isLastNode)I=A.length-1,T=A[I-1],T.isLastNode=!0;else for(m=0,j=A.length;m<j;m++)if(A[m].tId==l.tId){I=m;break}if(I>=0&&A.splice(I,1),p!=d.move.TYPE_INNER)for(m=0,j=Y.length;m<j;m++)Y[m].tId==r.tId&&(L=m);p==d.move.TYPE_INNER?(w||(w=u.nodeChildren(n,r,[])),w.length>0&&(k=w[w.length-1],k.isLastNode=!1),w.splice(w.length,0,l),l.isLastNode=!0,l.isFirstNode=w.length==1):r.isFirstNode&&p==d.move.TYPE_PREV?(Y.splice(L,0,l),k=r,k.isFirstNode=!1,l.parentTId=r.parentTId,l.isFirstNode=!0,l.isLastNode=!1):r.isLastNode&&p==d.move.TYPE_NEXT?(Y.splice(L+1,0,l),k=r,k.isLastNode=!1,l.parentTId=r.parentTId,l.isFirstNode=!1,l.isLastNode=!0):(p==d.move.TYPE_PREV?Y.splice(L,0,l):Y.splice(L+1,0,l),l.parentTId=r.parentTId,l.isFirstNode=!1,l.isLastNode=!1),u.fixPIdKeyValue(n,l),u.setSonNodeLevel(n,l.getParentNode(),l),c.setNodeLineIcos(n,l),c.repairNodeLevelClass(n,l,F),!n.data.keep.parent&&A.length<1?(u.nodeIsParent(n,v,!1),v.open=!1,r=f(v,d.id.UL,n),p=f(v,d.id.SWITCH,n),m=f(v,d.id.ICON,n),c.replaceSwitchClass(v,p,d.folder.DOCU),c.replaceIcoClass(v,m,d.folder.DOCU),r.css("display","none")):T&&c.setNodeLineIcos(n,T),k&&c.setNodeLineIcos(n,k),n.check&&n.check.enable&&c.repairChkClass&&(c.repairChkClass(n,v),c.repairParentChkClassWithSelf(n,v),v!=l.parent&&c.repairParentChkClassWithSelf(n,l)),C||c.expandCollapseParentNode(n,l.getParentNode(),!0,h)}},removeEditBtn:function(n,r){f(r,d.id.EDIT,n).unbind().remove()},removeRemoveBtn:function(n,r){f(r,d.id.REMOVE,n).unbind().remove()},removeTreeDom:function(n,r){r.isHover=!1,c.removeEditBtn(n,r),c.removeRemoveBtn(n,r),s.apply(n.view.removeHoverDom,[n.treeId,r])},repairNodeLevelClass:function(n,r,l){if(l!==r.level){var p=f(r,n),h=f(r,d.id.A,n),n=f(r,d.id.UL,n),l=d.className.LEVEL+l,r=d.className.LEVEL+r.level;p.removeClass(l),p.addClass(r),h.removeClass(l),h.addClass(r),n.removeClass(l),n.addClass(r)}},selectNodes:function(n,r){for(var l=0,p=r.length;l<p;l++)c.selectNode(n,r[l],l>0)}},event:{},data:{setSonNodeLevel:function(n,r,l){if(l){var p=u.nodeChildren(n,l);if(l.level=r?r.level+1:0,p)for(var r=0,h=p.length;r<h;r++)p[r]&&u.setSonNodeLevel(n,l,p[r])}}}});var i=e.fn.zTree,s=i._z.tools,d=i.consts,c=i._z.view,u=i._z.data,f=s.$;u.exSetting({edit:{enable:!1,editNameSelectAll:!1,showRemoveBtn:!0,showRenameBtn:!0,removeTitle:"remove",renameTitle:"rename",drag:{autoExpandTrigger:!1,isCopy:!0,isMove:!0,prev:!0,next:!0,inner:!0,minMoveSize:5,borderMax:10,borderMin:-5,maxShowNodeNum:5,autoOpenTime:500}},view:{addHoverDom:null,removeHoverDom:null},callback:{beforeDrag:null,beforeDragOpen:null,beforeDrop:null,beforeEditName:null,beforeRename:null,onDrag:null,onDragMove:null,onDrop:null,onRename:null}}),u.addInitBind(function(n){var r=n.treeObj,l=d.event;r.bind(l.RENAME,function(p,h,C,m){s.apply(n.callback.onRename,[p,h,C,m])}),r.bind(l.DRAG,function(p,h,C,m){s.apply(n.callback.onDrag,[h,C,m])}),r.bind(l.DRAGMOVE,function(p,h,C,m){s.apply(n.callback.onDragMove,[h,C,m])}),r.bind(l.DROP,function(p,h,C,m,v,k,I){s.apply(n.callback.onDrop,[h,C,m,v,k,I])})}),u.addInitUnBind(function(n){var n=n.treeObj,r=d.event;n.unbind(r.RENAME),n.unbind(r.DRAG),n.unbind(r.DRAGMOVE),n.unbind(r.DROP)}),u.addInitCache(function(){}),u.addInitNode(function(n,r,l){l&&(l.isHover=!1,l.editNameFlag=!1)}),u.addInitProxy(function(n){var r=n.target,l=u.getSetting(n.data.treeId),p=n.relatedTarget,h="",C=null,m="",v=null,k=null;if(s.eqs(n.type,"mouseover")?(k=s.getMDom(l,r,[{tagName:"a",attrName:"treeNode"+d.id.A}]))&&(h=s.getNodeMainDom(k).id,m="hoverOverNode"):s.eqs(n.type,"mouseout")?(k=s.getMDom(l,p,[{tagName:"a",attrName:"treeNode"+d.id.A}]),k||(h="remove",m="hoverOutNode")):s.eqs(n.type,"mousedown")&&(k=s.getMDom(l,r,[{tagName:"a",attrName:"treeNode"+d.id.A}]))&&(h=s.getNodeMainDom(k).id,m="mousedownNode"),h.length>0)switch(C=u.getNodeCache(l,h),m){case"mousedownNode":v=o.onMousedownNode;break;case"hoverOverNode":v=o.onHoverOverNode;break;case"hoverOutNode":v=o.onHoverOutNode}return{stop:!1,node:C,nodeEventType:m,nodeEventCallback:v,treeEventType:"",treeEventCallback:null}}),u.addInitRoot(function(n){var n=u.getRoot(n),r=u.getRoots();n.curEditNode=null,n.curEditInput=null,n.curHoverNode=null,n.dragFlag=0,n.dragNodeShowBefore=[],n.dragMaskList=[],r.showHoverDom=!0}),u.addZTreeTools(function(n,r){r.cancelEditName=function(l){u.getRoot(this.setting).curEditNode&&c.cancelCurEditNode(this.setting,l||null,!0)},r.copyNode=function(l,p,h,C){if(!p)return null;var m=u.nodeIsParent(n,l);if(l&&!m&&this.setting.data.keep.leaf&&h===d.move.TYPE_INNER)return null;var v=this,k=s.clone(p);return l||(l=null,h=d.move.TYPE_INNER),h==d.move.TYPE_INNER?(p=function(){c.addNodes(v.setting,l,-1,[k],C)},s.canAsync(this.setting,l)?c.asyncNode(this.setting,l,C,p):p()):(c.addNodes(this.setting,l.parentNode,-1,[k],C),c.moveNode(this.setting,l,k,h,!1,C)),k},r.editName=function(l){l&&l.tId&&l===u.getNodeCache(this.setting,l.tId)&&(l.parentTId&&c.expandCollapseParentNode(this.setting,l.getParentNode(),!0),c.editNode(this.setting,l))},r.moveNode=function(l,p,h,C){function m(){c.moveNode(k.setting,l,p,h,!1,C)}if(!p)return p;var v=u.nodeIsParent(n,l);if(l&&!v&&this.setting.data.keep.leaf&&h===d.move.TYPE_INNER)return null;if(l&&(p.parentTId==l.tId&&h==d.move.TYPE_INNER||f(p,this.setting).find("#"+l.tId).length>0))return null;l||(l=null);var k=this;return s.canAsync(this.setting,l)&&h===d.move.TYPE_INNER?c.asyncNode(this.setting,l,C,m):m(),p},r.setEditable=function(l){return this.setting.edit.enable=l,this.refresh()}});var N=c.cancelPreSelectedNode;c.cancelPreSelectedNode=function(n,r){for(var l=u.getRoot(n).curSelectedList,p=0,h=l.length;p<h&&!((!r||r===l[p])&&(c.removeTreeDom(n,l[p]),r));p++);N&&N.apply(c,arguments)};var S=c.createNodes;c.createNodes=function(n,r,l,p,h){S&&S.apply(c,arguments),l&&c.repairParentChkClassWithSelf&&c.repairParentChkClassWithSelf(n,p)};var _=c.makeNodeUrl;c.makeNodeUrl=function(n,r){return n.edit.enable?null:_.apply(c,arguments)};var U=c.removeNode;c.removeNode=function(n,r){var l=u.getRoot(n);l.curEditNode===r&&(l.curEditNode=null),U&&U.apply(c,arguments)};var g=c.selectNode;c.selectNode=function(n,r,l){var p=u.getRoot(n);return u.isSelectedNode(n,r)&&p.curEditNode==r&&r.editNameFlag?!1:(g&&g.apply(c,arguments),c.addHoverDom(n,r),!0)};var a=s.uCanDo;s.uCanDo=function(n,r){var l=u.getRoot(n);return r&&(s.eqs(r.type,"mouseover")||s.eqs(r.type,"mouseout")||s.eqs(r.type,"mousedown")||s.eqs(r.type,"mouseup"))?!0:(l.curEditNode&&(c.editNodeBlur=!1,l.curEditInput.focus()),!l.curEditNode&&(a?a.apply(c,arguments):!0))}}(jQuery),function(e){e.extend(!0,e.fn.zTree._z,{view:{clearOldFirstNode:function(g,a){for(var n=a.getNextNode();n;){if(n.isFirstNode){n.isFirstNode=!1,i.setNodeLineIcos(g,n);break}if(n.isLastNode)break;n=n.getNextNode()}},clearOldLastNode:function(g,a,n){for(a=a.getPreNode();a;){if(a.isLastNode){a.isLastNode=!1,n&&i.setNodeLineIcos(g,a);break}if(a.isFirstNode)break;a=a.getPreNode()}},makeDOMNodeMainBefore:function(g,a,n){a=s.isHidden(a,n),g.push("<li ",a?"style='display:none;' ":"","id='",n.tId,"' class='",o.className.LEVEL,n.level,"' tabindex='0' hidefocus='true' treenode>")},showNode:function(g,a){s.isHidden(g,a,!1),s.initShowForExCheck(g,a),d(a,g).show()},showNodes:function(g,a,n){if(a&&a.length!=0){var r={},l,p;for(l=0,p=a.length;l<p;l++){var h=a[l];if(!r[h.parentTId]){var C=h.getParentNode();r[h.parentTId]=C===null?s.getRoot(g):h.getParentNode()}i.showNode(g,h,n)}for(var m in r)a=s.nodeChildren(g,r[m]),i.setFirstNodeForShow(g,a),i.setLastNodeForShow(g,a)}},hideNode:function(g,a){s.isHidden(g,a,!0),a.isFirstNode=!1,a.isLastNode=!1,s.initHideForExCheck(g,a),i.cancelPreSelectedNode(g,a),d(a,g).hide()},hideNodes:function(g,a,n){if(a&&a.length!=0){var r={},l,p;for(l=0,p=a.length;l<p;l++){var h=a[l];if((h.isFirstNode||h.isLastNode)&&!r[h.parentTId]){var C=h.getParentNode();r[h.parentTId]=C===null?s.getRoot(g):h.getParentNode()}i.hideNode(g,h,n)}for(var m in r)a=s.nodeChildren(g,r[m]),i.setFirstNodeForHide(g,a),i.setLastNodeForHide(g,a)}},setFirstNode:function(g,a){var n=s.nodeChildren(g,a),r=s.isHidden(g,n[0],!1);n.length>0&&!r?n[0].isFirstNode=!0:n.length>0&&i.setFirstNodeForHide(g,n)},setLastNode:function(g,a){var n=s.nodeChildren(g,a),r=s.isHidden(g,n[0]);n.length>0&&!r?n[n.length-1].isLastNode=!0:n.length>0&&i.setLastNodeForHide(g,n)},setFirstNodeForHide:function(g,a){var n,r,l;for(r=0,l=a.length;r<l&&(n=a[r],!n.isFirstNode);r++)if(!s.isHidden(g,n)&&!n.isFirstNode){n.isFirstNode=!0,i.setNodeLineIcos(g,n);break}else n=null;return n},setFirstNodeForShow:function(g,a){var n,r,l,p,h;for(r=0,l=a.length;r<l;r++){n=a[r];var C=s.isHidden(g,n);if(!p&&!C&&n.isFirstNode){p=n;break}else if(!p&&!C&&!n.isFirstNode)n.isFirstNode=!0,p=n,i.setNodeLineIcos(g,n);else if(p&&n.isFirstNode){n.isFirstNode=!1,h=n,i.setNodeLineIcos(g,n);break}}return{new:p,old:h}},setLastNodeForHide:function(g,a){var n,r;for(r=a.length-1;r>=0&&(n=a[r],!n.isLastNode);r--)if(!s.isHidden(g,n)&&!n.isLastNode){n.isLastNode=!0,i.setNodeLineIcos(g,n);break}else n=null;return n},setLastNodeForShow:function(g,a){var n,r,l,p;for(r=a.length-1;r>=0;r--){n=a[r];var h=s.isHidden(g,n);if(!l&&!h&&n.isLastNode){l=n;break}else if(!l&&!h&&!n.isLastNode)n.isLastNode=!0,l=n,i.setNodeLineIcos(g,n);else if(l&&n.isLastNode){n.isLastNode=!1,p=n,i.setNodeLineIcos(g,n);break}}return{new:l,old:p}}},data:{initHideForExCheck:function(g,a){s.isHidden(g,a)&&g.check&&g.check.enable&&(typeof a._nocheck=="undefined"&&(a._nocheck=!!a.nocheck,a.nocheck=!0),a.check_Child_State=-1,i.repairParentChkClassWithSelf&&i.repairParentChkClassWithSelf(g,a))},initShowForExCheck:function(g,a){if(!s.isHidden(g,a)&&g.check&&g.check.enable){if(typeof a._nocheck!="undefined"&&(a.nocheck=a._nocheck,delete a._nocheck),i.setChkClass){var n=d(a,o.id.CHECK,g);i.setChkClass(g,n,a)}i.repairParentChkClassWithSelf&&i.repairParentChkClassWithSelf(g,a)}}}});var e=e.fn.zTree,t=e._z.tools,o=e.consts,i=e._z.view,s=e._z.data,d=t.$;s.isHidden=function(g,a,n){return a?(g=g.data.key.isHidden,typeof n!="undefined"&&(typeof n=="string"&&(n=t.eqs(checked,"true")),a[g]=!!n),a[g]):!1},s.exSetting({data:{key:{isHidden:"isHidden"}}}),s.addInitNode(function(g,a,n){a=s.isHidden(g,n),s.isHidden(g,n,a),s.initHideForExCheck(g,n)}),s.addBeforeA(function(){}),s.addZTreeTools(function(g,a){a.showNodes=function(r,l){i.showNodes(g,r,l)},a.showNode=function(r,l){r&&i.showNodes(g,[r],l)},a.hideNodes=function(r,l){i.hideNodes(g,r,l)},a.hideNode=function(r,l){r&&i.hideNodes(g,[r],l)};var n=a.checkNode;n&&(a.checkNode=function(r,l,p,h){(!r||!s.isHidden(g,r))&&n.apply(a,arguments)})});var c=s.initNode;s.initNode=function(g,a,n,r,l,p,h){var C=(r||s.getRoot(g))[g.data.key.children];s.tmpHideFirstNode=i.setFirstNodeForHide(g,C),s.tmpHideLastNode=i.setLastNodeForHide(g,C),h&&(i.setNodeLineIcos(g,s.tmpHideFirstNode),i.setNodeLineIcos(g,s.tmpHideLastNode)),l=s.tmpHideFirstNode===n,p=s.tmpHideLastNode===n,c&&c.apply(s,arguments),h&&p&&i.clearOldLastNode(g,n,h)};var u=s.makeChkFlag;u&&(s.makeChkFlag=function(g,a){(!a||!s.isHidden(g,a))&&u.apply(s,arguments)});var f=s.getTreeCheckedNodes;f&&(s.getTreeCheckedNodes=function(g,a,n,r){if(a&&a.length>0){var l=a[0].getParentNode();if(l&&s.isHidden(g,l))return[]}return f.apply(s,arguments)});var N=s.getTreeChangeCheckedNodes;N&&(s.getTreeChangeCheckedNodes=function(g,a,n){if(a&&a.length>0){var r=a[0].getParentNode();if(r&&s.isHidden(g,r))return[]}return N.apply(s,arguments)});var S=i.expandCollapseSonNode;S&&(i.expandCollapseSonNode=function(g,a,n,r,l){(!a||!s.isHidden(g,a))&&S.apply(i,arguments)});var _=i.setSonNodeCheckBox;_&&(i.setSonNodeCheckBox=function(g,a,n,r){(!a||!s.isHidden(g,a))&&_.apply(i,arguments)});var U=i.repairParentChkClassWithSelf;U&&(i.repairParentChkClassWithSelf=function(g,a){(!a||!s.isHidden(g,a))&&U.apply(i,arguments)})}(jQuery),TreeSelect.prototype.render=function(e){var t=e.elem,o=e.data,i=e.headers,s=e.type===void 0?"GET":e.type,d=e.click,c=e.success,u=e.placeholder===void 0?"\u8BF7\u9009\u62E9":e.placeholder,f=e.search===void 0?!1:e.search,N=e.style,S=new Date().getTime(),_={},U="layui-form-selected",g=void 0,a="treeSelect-input-"+S,n="layui-treeselect",r="layui-treeSelect-"+S,l="layui-treeSelect",p="layui-select-title-"+S,h="layui-select-title",C="layui-treeSelect-body-"+S,m="layui-treeSelect-body",v="layui-treeSelect-search-ed",k={init:function(){_=o,k.hideElem().input().toggleSelect().loadCss().preventEvent(),$.fn.zTree.init($("#"+C),k.setting(),o),g=$.fn.zTree.getZTreeObj(C),f&&k.searchParam(),k.configStyle();var I={treeId:r,data:o};return c(I),k},checkDefaultValue:function(){},setting:function(){var I={callback:{onClick:k.onClick,onExpand:k.onExpand,onCollapse:k.onCollapse,beforeExpand:k.ztreeCallBack.beforeExpand},data:{key:{name:"className"},simpleData:{enable:!0,idKey:"classId"}}};return I},ztreeCallBack:{beforeExpand:function(){k.configStyle()}},onCollapse:function(){k.focusInput()},onExpand:function(I,L,j){var T=$("#designId").val()||getQueryString("designId"),F=$.fn.zTree.getZTreeObj(L),A=F.getNodeByTId(j.tId),Y=[{classId:2,className:"aaa"}];A.hasChildren&&(A.children==null||A.children=="undefined"||A.children.length==0)&&$.ajax({type:"GET",dataType:"json",url:"/api/user/getClassInfosWithoutLogin?projectid=13",data:{superClassId:A.classId,designId:T},success:function(w){if(w.success){var O=w.data&&w.data.length?toParse(w.data):[];newNode=F.addNodes(A,O)}},error:function(w,O,G){}}),k.configStyle(),k.focusInput()},focusInput:function(){$("#"+a).focus()},onClick:function(I,L,j){var T=j.className,F=j.classId,A=$("#"+p+" input");if(A.val(T),$(t).attr("value",F).val(F),$("#"+r).removeClass(U),d){var Y={data:_,current:j,treeId:r};d(Y)}return k},hideElem:function(){return $(t).hide(),k},input:function(){var I="";f||(I="readonly");var L='<div class="'+l+' layui-unselect layui-form-select" id="'+r+'"><div class="'+h+'" id="'+p+'"> <input type="text" id="'+a+'" placeholder="'+u+'" value="" '+I+' class="layui-input layui-unselect"><i class="layui-edge"></i></div><div class="layui-anim layui-anim-upbit" style=""><div class="'+m+' ztree" id="'+C+'"></div></div></div>';return $(t).parent().append(L),k},toggleSelect:function(){var I="#"+p;return k.event("click",I,function(L){var j=$("#"+r);j.hasClass(U)?(j.removeClass(U),$("#"+a).blur()):($(".layui-form-select").removeClass(U),j.addClass(U)),L.stopPropagation()}),$(document).click(function(){var L=$("#"+r);L.hasClass(U)&&(L.removeClass(U),$("#"+a).blur())}),k},searchParam:function(){if(!!f){var I="#"+a;k.fuzzySearch(I,null,!0)}},fuzzySearch:function(I,L,j){var T=g;T||alert("fail to get ztree object");var F=T.setting.data.key.name;L=L!==!1,j=!!j,T.setting.view.nameIsHTML=L;var A="[\\[\\]\\\\^\\$\\.\\|\\?\\*\\+\\(\\)]",Y=new RegExp(A,"gi");function w($,q,te){q||(q="");function J(x){return x&&x.oldname&&x.oldname.length>0&&(x[F]=x.oldname),$.updateNode(x),q.length==0?($.showNode(x),$.expandNode(x,j),!0):x[F]&&x[F].toLowerCase().indexOf(q.toLowerCase())!=-1?($.showNode(x),!0):($.hideNode(x),!1)}var Z=$.getNodesByFilter(J);O(Z,q)}function O($,q){if($&&$.length>0)if(q.length>0)$.each($,function(J,Z){var x=Z.getPath();if(x&&x.length>0)for(var M=0;M<x.length-1;M++)T.showNode(x[M]),T.expandNode(x[M],!0)});else{var te=T.getNodesByParam("level","0");$.each(te,function(J,Z){T.expandNode(Z,!0)})}}$(I).bind("input propertychange",function(){var $=$(this).val();y($)});var G=null;function y($){G&&clearTimeout(G),G=setTimeout(function(){w(T,$),$(I).focus()},500)}},checkNodes:function(I){for(var L=0;L<I.length;L++){var j=I[L],T=j.parentTId,F=j.tId;if(T!==null){$("#"+T).addClass(v);var A=g.getNodesByParam("tId",T,null);g.expandNode(A[0],!0,!1,!0)}$("#"+F).addClass(v)}},preventEvent:function(){var I="#"+r+" .layui-anim";return k.event("click",I,function(L){L.stopPropagation()}),k},loadCss:function(){var I='.ztree *{padding:0;margin:0;font-size:12px;font-family:Verdana,Arial,Helvetica,AppleGothic,sans-serif}.ztree{margin:0;padding:5px;color:#333}.ztree li{padding:0;margin:0;list-style:none;line-height:14px;text-align:left;white-space:nowrap;outline:0}.ztree li ul{margin:0;padding:0 0 0 18px}.ztree li ul.line{background:url(./img/line_conn.gif) 0 0 repeat-y;}.ztree li a{padding:1px 3px 0 0;margin:0;cursor:pointer;height:17px;color:#333;background-color:transparent;text-decoration:none;vertical-align:top;display:inline-block}.ztree li a:hover{text-decoration:underline}.ztree li a.curSelectedNode{padding-top:0px;background-color:#FFE6B0;color:black;height:16px;border:1px #FFB951 solid;opacity:0.8;}.ztree li a.curSelectedNode_Edit{padding-top:0px;background-color:#FFE6B0;color:black;height:16px;border:1px #FFB951 solid;opacity:0.8;}.ztree li a.tmpTargetNode_inner{padding-top:0px;background-color:#316AC5;color:white;height:16px;border:1px #316AC5 solid;opacity:0.8;filter:alpha(opacity=80)}.ztree li a.tmpTargetNode_prev{}.ztree li a.tmpTargetNode_next{}.ztree li a input.rename{height:14px;width:80px;padding:0;margin:0;font-size:12px;border:1px #7EC4CC solid;*border:0px}.ztree li span{line-height:16px;margin-right:2px}.ztree li span.button{line-height:0;margin:0;width:16px;height:16px;display:inline-block;vertical-align:middle;border:0 none;cursor:pointer;outline:none;background-color:transparent;background-repeat:no-repeat;background-attachment:scroll;background-image:url("./img/zTreeStandard.png");*background-image:url("./img/zTreeStandard.gif")}.ztree li span.button.chk{width:13px;height:13px;margin:0 3px 0 0;cursor:auto}.ztree li span.button.chk.checkbox_false_full{background-position:0 0}.ztree li span.button.chk.checkbox_false_full_focus{background-position:0 -14px}.ztree li span.button.chk.checkbox_false_part{background-position:0 -28px}.ztree li span.button.chk.checkbox_false_part_focus{background-position:0 -42px}.ztree li span.button.chk.checkbox_false_disable{background-position:0 -56px}.ztree li span.button.chk.checkbox_true_full{background-position:-14px 0}.ztree li span.button.chk.checkbox_true_full_focus{background-position:-14px -14px}.ztree li span.button.chk.checkbox_true_part{background-position:-14px -28px}.ztree li span.button.chk.checkbox_true_part_focus{background-position:-14px -42px}.ztree li span.button.chk.checkbox_true_disable{background-position:-14px -56px}.ztree li span.button.chk.radio_false_full{background-position:-28px 0}.ztree li span.button.chk.radio_false_full_focus{background-position:-28px -14px}.ztree li span.button.chk.radio_false_part{background-position:-28px -28px}.ztree li span.button.chk.radio_false_part_focus{background-position:-28px -42px}.ztree li span.button.chk.radio_false_disable{background-position:-28px -56px}.ztree li span.button.chk.radio_true_full{background-position:-42px 0}.ztree li span.button.chk.radio_true_full_focus{background-position:-42px -14px}.ztree li span.button.chk.radio_true_part{background-position:-42px -28px}.ztree li span.button.chk.radio_true_part_focus{background-position:-42px -42px}.ztree li span.button.chk.radio_true_disable{background-position:-42px -56px}.ztree li span.button.switch{width:18px;height:18px}.ztree li span.button.root_open{background-position:-92px -54px}.ztree li span.button.root_close{background-position:-74px -54px}.ztree li span.button.roots_open{background-position:-92px 0}.ztree li span.button.roots_close{background-position:-74px 0}.ztree li span.button.center_open{background-position:-92px -18px}.ztree li span.button.center_close{background-position:-74px -18px}.ztree li span.button.bottom_open{background-position:-92px -36px}.ztree li span.button.bottom_close{background-position:-74px -36px}.ztree li span.button.noline_open{background-position:-92px -72px}.ztree li span.button.noline_close{background-position:-74px -72px}.ztree li span.button.root_docu{background:none;}.ztree li span.button.roots_docu{background-position:-56px 0}.ztree li span.button.center_docu{background-position:-56px -18px}.ztree li span.button.bottom_docu{background-position:-56px -36px}.ztree li span.button.noline_docu{background:none;}.ztree li span.button.ico_open{margin-right:2px;background-position:-110px -16px;vertical-align:top;*vertical-align:middle}.ztree li span.button.ico_close{margin-right:2px;background-position:-110px 0;vertical-align:top;*vertical-align:middle}.ztree li span.button.ico_docu{margin-right:2px;background-position:-110px -32px;vertical-align:top;*vertical-align:middle}.ztree li span.button.edit{margin-right:2px;background-position:-110px -48px;vertical-align:top;*vertical-align:middle}.ztree li span.button.remove{margin-right:2px;background-position:-110px -64px;vertical-align:top;*vertical-align:middle}.ztree li span.button.ico_loading{margin-right:2px;background:url(./img/loading.gif) no-repeat scroll 0 0 transparent;vertical-align:top;*vertical-align:middle}ul.tmpTargetzTree{background-color:#FFE6B0;opacity:0.8;filter:alpha(opacity=80)}span.tmpzTreeMove_arrow{width:16px;height:16px;display:inline-block;padding:0;margin:2px 0 0 1px;border:0 none;position:absolute;background-color:transparent;background-repeat:no-repeat;background-attachment:scroll;background-position:-110px -80px;background-image:url("./img/zTreeStandard.png");*background-image:url("./img/zTreeStandard.gif")}ul.ztree.zTreeDragUL{margin:0;padding:0;position:absolute;width:auto;height:auto;overflow:hidden;background-color:#cfcfcf;border:1px #00B83F dotted;opacity:0.8;filter:alpha(opacity=80)}.zTreeMask{z-index:10000;background-color:#cfcfcf;opacity:0.0;filter:alpha(opacity=0);position:absolute}',L='.layui-treeSelect .ztree li span.button{font-family:layui-icon!important;font-size:16px;font-style:normal;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;background:none;line-height:inherit;}.layui-treeSelect .ztree li span.button.ico_open{display:none;}.layui-treeSelect .ztree li span.button.ico_close{display:none;}.layui-treeSelect .ztree li span.button.ico_docu:before{content:"\\e621";}.layui-treeSelect .ztree li span.button.bottom_close:before,.layui-treeSelect .ztree li span.button.center_close:before,.layui-treeSelect .ztree li span.button.roots_close:before,.layui-treeSelect .ztree li span.button.root_close:before{content:"\\e623";}.layui-treeSelect .ztree li span.button.bottom_open:before,.layui-treeSelect .ztree li span.button.roots_open:before,.layui-treeSelect .ztree li span.button.center_open:before,.layui-treeSelect .ztree li span.button.root_open:before{content:"\\e625";}.layui-treeSelect .ztree li a:hover{text-decoration:none;}.layui-treeSelect .ztree *{font-size:14px;}.layui-treeSelect .ztree li{line-height:inherit;padding:2px 0;}.layui-treeSelect .ztree li span.button.switch{position:relative;top:-1px;}.layui-treeSelect .ztree li a,.ztree li span{line-height:18px;height:inherit;}.layui-treeSelect .ztree li a.curSelectedNode{color:#5FB878;background:none;border:none;height:inherit;padding-top:1px;}.layui-treeSelect .layui-anim::-webkit-scrollbar{width:6px;height:6px;background-color:#F5F5F5;}.layui-treeSelect .layui-anim::-webkit-scrollbar-track{box-shadow:inset 0 0 6px rgba(107,98,98,0.3);border-radius:10px;background-color:#F5F5F5;}.layui-treeSelect .layui-anim::-webkit-scrollbar-thumb{border-radius:10px;box-shadow:inset 0 0 6px rgba(107,98,98,0.3);background-color:#555;}.layui-treeSelect.layui-form-select .layui-anim{display:none;position:absolute;left:0;top:42px;padding:5px 0;z-index:9999;min-width:100%;border:1px solid #d2d2d2;max-height:300px;overflow-y:auto;background-color:#fff;border-radius:2px;box-shadow:0 2px 4px rgba(0,0,0,.12);box-sizing:border-box;}.layui-treeSelect.layui-form-selected .layui-anim{display:block;}.layui-treeSelect .ztree li ul.line{background:none;position:relative;}.layui-treeSelect .ztree li ul.line:before{content:"";height:100%;border-left:1px dotted #ece;position:absolute;left:8px;}.layui-treeSelect .ztree li .center_docu:before,.ztree li .bottom_docu::before{content:"";height:100%;border-left:1px dotted #ece;position:absolute;left:8px;}.layui-treeSelect .ztree li .center_docu::after,.ztree li .bottom_docu::after{content:"";position:absolute;left:8px;top:8px;width:8px;border-top:1px dotted #ece;}.layui-treeSelect .ztree li span.button.ico_open{display:inline-block;position:relative;top:1px;}.layui-treeSelect .ztree li span.button.ico_close{display:inline-block;position:relative;top:1px;}.layui-treeSelect .ztree li span.button.ico_open:before{content:"\\e643";}.layui-treeSelect .ztree li span.button.ico_close:before{content:"\\e63f";}';return $head=$("head"),ztreeStyle=$head.find("style[ztree]"),ztreeStyle.length===0&&$head.append($("<style ztree>").append(I).append(L)),k},configStyle:function(){(N==null||N.line==null||!N.line.enable)&&$("#"+r).find("li .center_docu,li .bottom_docu").hide(),(N==null||N.folder==null||!N.folder.enable)&&($("#"+r).find("li span.button.ico_open").hide(),$("#"+r).find("li span.button.ico_close").hide())},event:function(I,L,j){$("body").on(I,L,j)}};return k.init(),new TreeSelect},TreeSelect.prototype.refresh=function(e){var t=obj.treeObj(e);t.reAsyncChildNodes(null,"refresh")},TreeSelect.prototype.checkNode=function(e,t){var o=obj.filter(e),i=o.find(".layui-select-title input"),s=obj.treeObj(e),d=s.getNodeByParam("id",t,null),c=d.name;i.val(c),o.find("a[treenode_a]").removeClass("curSelectedNode"),obj.get(e).val(t).attr("value",t),s.selectNode(d)},TreeSelect.prototype.revokeNode=function(e,t){var o=obj.filter(e);o.find("a[treenode_a]").removeClass("curSelectedNode"),o.find(".layui-select-title input.layui-input").val(""),obj.get(e).attr("value","").val(""),obj.treeObj(e).expandAll(!1),t&&t({treeId:o.attr("id")})},TreeSelect.prototype.destroy=function(e){var t=obj.filter(e);t.remove(),obj.get(e).show()},TreeSelect.prototype.zTree=function(e){return obj.treeObj(e)};var obj={get:function(e){return e||layui.hint().error("filter \u4E0D\u80FD\u4E3A\u7A7A"),$("*[lay-filter="+e+"]")},filter:function(e){var t=obj.get(e),o=t.next();return o},treeObj:function(e){var t=obj.filter(e),o=t.find(".layui-treeSelect-body").attr("id"),i=$.fn.zTree.getZTreeObj(o);return i}},mod=new TreeSelect;exports(_MOD,mod)});
