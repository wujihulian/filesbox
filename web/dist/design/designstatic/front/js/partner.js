if(!cdnPath)var cdnPath="";var peIde=getPar("typeId")?getPar("typeId"):"",infoValue=getPar("infoValue")?getPar("infoValue"):"1",infoValuePeIde=getPar("typeId")?getPar("typeId"):"",issendhou=!1,isGoOut=!1,peId,peId2,peId3,peId4,peId5,item,item2,item3,item4,item5,currentPage=1,total=0,$grid=$("#plate-navcm").masonry({itemSelector:".box",gutter:10,isAnimated:!0,isResizeBound:!0});function resetImgSrc(r){var t=r.replace(/([^.]*).([^.]*)$/g,"$1!medium.$2");return t}function coverError(r){var t=event.target;parseInt(t.dataset.errorcount)==0?(t.setAttribute("data-errorcount",1),t.src=r):parseInt(t.dataset.errorcount)==1&&(t.setAttribute("data-errorcount",2),t.src="/static/common/image/information/defult.jpg")}function list(r,t,n,e){$.ajax({type:"GET",headers:{token:getCookie("token")},url:"/api/common/getHomepageList?projectid=41",contentType:"application/json",dataType:"json",data:{infoTypeId:r,currentPage:t,pageSize:20,keywords:n,infoType:"8"},async:!0,success:function(s){var o=s.data.list;total=s.data.total||0;for(var a="",i=0,d=o.length;i<d;i++){var c=o[i].commonHomepageInfoId,g=getTimeZhCN(o[i].gmtModified),m=o[i].computerPicPath,v=o[i].infoType=="1",p=m?JSON.parse(m):[],f=p&&p.length?p[0].sourcePath:"/static/common/image/information/defult.jpg",h=p&&p.length?p[0].title:"",u=location.port=="81"?"/pages/information.html?aid="+c:"/information/"+c+".shtml",I=o[i].introduce.replace(/<[^>]+>/g,"");a+='  <a class="box" href="'+u+'" target="_blank">',a+=" <img src="+(cdnPath+resetImgSrc(f))+'  data-errorcount="0" onerror="coverError(&quot'+cdnPath+f+'&quot)" >',a+=' <div class="detail" >',a+="	<h2>",a+=h,a+="	</h2>",a+="	</div>",a+=" </a>"}if($(".plate-navcm .nodata").remove(),o.length==0){if($grid){var l=$(".plate-navcm .box");$grid.masonry("remove",l).masonry("layout")}$(".plate-navcm").html("<div class='nodata'></div>")}else{if(e){var l=$(".plate-navcm .box");$grid.masonry("remove",l).masonry("layout")}var y=$(a);$grid.append(y).masonry("appended",y),$grid.imagesLoaded().progress(function(){$grid.masonry("layout"),issendhou=!1})}}})}list(peIde,1),$(document).on("scroll",function(){var r=$(".foot").height()||0;if($(window).scrollTop()+$(window).height()>$(document).height()-100-r){if(isGoOut||issendhou)return!1;if(issendhou=!0,currentPage*10>=total)return currentPage<2,void 0;currentPage=currentPage+1,list(window.peIde,currentPage,window.keyWord)}}),function(r,t){var n={init:function(){this.getListHomepageSetting()},getListHomepageSetting:function(){var e=this;r.ajax({type:"GET",url:"/api/common/listHomepageSetting",contentType:"application/json",dataType:"json",data:{busType:"8"},async:!0,success:function(s){window.classifyData=s.data;var o=s.data,a=o;parseInt(infoValue)==0&&(a=e.getParentObj(o,peIde,!0)),e.renderNav(a,peIde),e.filterrigEvent(a)}})},renderNav:function(e,s){for(var o=this,a="",i=e,d=e,c=1,g=o.getParentObj(e,s),m=parseInt(c)==1,v=0,p=g.length;v<p;v++){var f=g[v-1]||0,h=g[v];if(i=d,parseInt(c)==0&&g[v]==infoValuePeIde&&(m=!0),i&&m){h?a+='<div class="plate-nav"> <a class="pid" tabs="'+f+'" href="javascript:void(0);">\u5168\u90E8</a>':a+='<div class="plate-nav"> <a class="pid curs" tabs="0" href="javascript:void(0);">\u5168\u90E8</a>';for(var u=0,I=i.length;u<I;u++){var l=i[u];parseInt(h)==parseInt(l.commonHomepageInfoTypeId)?(d=l.children,a+='<a class="pid curs" tabs="'+l.commonHomepageInfoTypeId+'" href="javascript:void(0);">'+l.typeName+"</a>"):a+='<a class="pid" tabs="'+l.commonHomepageInfoTypeId+'" href="javascript:void(0);">'+l.typeName+"</a>"}a+="</div>"}else if(i)for(var u=0,I=i.length;u<I;u++){var l=i[u];parseInt(h)==parseInt(l.commonHomepageInfoTypeId)&&(d=l.children)}}r(".filterrig .plate-nav").html(a)},getParentObj:function(e,s,o){var a="",i=e;function d(c,g,m){for(var v=0,p=c.length;v<p;v++){var f=c[v];if(parseInt(f.commonHomepageInfoTypeId)==parseInt(g))i=c,a=m+f.commonHomepageInfoTypeId+",";else if(f.children){var h=m+f.commonHomepageInfoTypeId+",";d(f.children,g,h)}}}return d(e,s,[]),o?i:a.split(",")},filterrigEvent:function(e){var s=this;r(".searchtxt").on("keypress",function(o){o.keyCode==13&&(t.keyWord=r(this).val(),currentPage=1,list(t.peIde,1,t.keyWord,1))}),r(".filterrig").on("click","a",function(){var o=r(this);if(currentPage=1,o.hasClass("searchbtn"))t.keyWord=r(".searchtxt").val(),list(t.peIde,1,t.keyWord,1);else{var a=o.attr("tabs");t.peIde=a,s.peId=a,s.renderNav(e,a),list(t.peIde,1,t.keyWord,1)}})}};n.init()}(jQuery,window),Date.prototype.format=function(r){var t={"M+":this.getMonth()+1,"d+":this.getDate(),"h+":this.getHours(),"m+":this.getMinutes(),"s+":this.getSeconds(),"q+":Math.floor((this.getMonth()+3)/3),S:this.getMilliseconds()};/(y+)/.test(r)&&(r=r.replace(RegExp.$1,(this.getFullYear()+"").substr(4-RegExp.$1.length)));for(var n in t)new RegExp("("+n+")").test(r)&&(r=r.replace(RegExp.$1,RegExp.$1.length==1?t[n]:("00"+t[n]).substr((""+t[n]).length)));return r};function getTimeZhCN(r,t){if(new Date(parseInt(r))=="Invalid Date"&&new Date(parseInt(r)*1e3)=="Invalid Date")return"--";new Date(parseInt(t))=="Invalid Date"&&new Date(parseInt(t)*1e3)=="Invalid Date"&&(t=Date.parse(new Date));var n=t-r;if(n<0)return"\u521A\u521A";if(n<6e4)return parseInt(n/1e3,10)+"\u79D2\u524D";if(n<3600*1e3)return parseInt(n/1e3/60,10)+"\u5206\u949F\u524D";if(n<24*3600*1e3)return parseInt(n/1e3/3600,10)+"\u5C0F\u65F6\u524D";if(n<7*24*3600*1e3)return parseInt(n/1e3/3600/24,10)+"\u5929\u524D";if(n<30*24*3600*1e3)return parseInt(n/1e3/3600/24/7,10)+"\u5468\u524D";if(n<365*24*3600*1e3)return parseInt(n/1e3/3600/24/30,10)+"\u4E2A\u6708\u524D";var e=new Date(parseInt(r)),s=parseInt(e.getMonth()+1)<10?"0"+(e.getMonth()+1):e.getMonth()+1,o=parseInt(e.getDate())<10?"0"+e.getDate():e.getDate(),a=parseInt(e.getHours())<10?"0"+e.getHours():e.getHours(),i=parseInt(e.getMinutes())<10?"0"+e.getMinutes():e.getMinutes();return e.getFullYear()+"-"+s+"-"+o+" "+a+":"+i}function getPar(r){var t=document.location.href,n=t.indexOf(r+"=");if(n==-1)return!1;var e=t.slice(r.length+n+1),s=e.indexOf("&");return s!=-1&&(e=e.slice(0,s)),e}function getCookie(r){for(var t=document.cookie,n=t.split("; "),e=0;e<n.length;e++){var s=n[e].split("=");if(s[0]==r)return s[1]}return""}
