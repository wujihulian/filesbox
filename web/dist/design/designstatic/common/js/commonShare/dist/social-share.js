/**
 * social-share.js
 *
 * @license MIT
 *
 * @example
 * <pre>
 * socialShare('.share-components');
 *
 * // or
 *
 * socialShare('.share-bar', {
 *     sites: ['qzone', 'qq', 'weibo','wechat'],
 *     // ...
 * });
 * </pre>
 */(function(n,o,f){var g=Array.prototype.indexOf,u=Object.assign,x=/MicroMessenger/i.test(navigator.userAgent),y=o.documentElement.clientWidth<=768,I=(o.images[0]||0).src||"",L=p("site")||p("Site")||o.title,C=p("title")||p("Title")||o.title,b=p("description")||p("Description")||"",P={url:location.href,origin:location.origin,source:L,title:C,description:b,image:I,imageSelector:f,weiboKey:"",wechatQrcodeTitle:"\u5FAE\u4FE1\u626B\u4E00\u626B\uFF1A\u5206\u4EAB",wechatQrcodeHelper:"<p>\u6253\u5F00\u5FAE\u4FE1\u626B\u4E00\u626B</p><p>\u4E8C\u7EF4\u7801\u4FBF\u53EF\u5206\u4EAB\u7ED9\u670B\u53CB\u3002</p>",wechatQrcodeSize:100,momentsQrcodeTitle:"\u5FAE\u4FE1\u626B\u4E00\u626B\uFF1A\u5206\u4EAB",momentsQrcodeHelper:"<p>\u5FAE\u4FE1\u91CC\u70B9\u201C\u53D1\u73B0\u201D\uFF0C\u626B\u4E00\u4E0B</p><p>\u4E8C\u7EF4\u7801\u4FBF\u53EF\u5206\u4EAB\u81F3\u670B\u53CB\u5708\u3002</p>",momentsQrcodeSize:100,dingdingQrcodeTitle:"\u9489\u9489\u626B\u4E00\u626B\uFF1A\u5206\u4EAB",dingdingQrcodeHelper:"<p>\u6253\u5F00\u9489\u9489\u626B\u4E00\u626B</p><p>\u4E8C\u7EF4\u7801\u4FBF\u53EF\u5206\u4EAB\u7ED9\u670B\u53CB\u3001\u540C\u4E8B\u3002</p>",dingdingQrcodeSize:100,sites:["weibo","qq","moments","dingding","wechat","douban","qzone","linkedin","facebook","twitter","google","picture","copylink"],mobileSites:[],disabled:[],initialized:!1},T={qzone:"http://sns.qzone.qq.com/cgi-bin/qzshare/cgi_qzshare_onekey?url={{URL}}&title={{TITLE}}&desc={{DESCRIPTION}}&summary={{SUMMARY}}&site={{SOURCE}}&pics={{IMAGE}}",qq:'http://connect.qq.com/widget/shareqq/index.html?url={{URL}}&title={{TITLE}}&source={{SOURCE}}&desc={{DESCRIPTION}}&pics={{IMAGE}}&summary="{{SUMMARY}}"',weibo:"https://service.weibo.com/share/share.php?url={{URL}}&title={{TITLE}}&pic={{IMAGE}}&appkey={{WEIBOKEY}}",wechat:"javascript:;",dingding:"javascript:;",moments:"javascript:;",picture:"javascript:;",copylink:"javascript:;",douban:"http://shuo.douban.com/!service/share?href={{URL}}&name={{TITLE}}&text={{DESCRIPTION}}&image={{IMAGE}}&starid=0&aid=0&style=11",linkedin:"http://www.linkedin.com/shareArticle?mini=true&ro=true&title={{TITLE}}&url={{URL}}&summary={{SUMMARY}}&source={{SOURCE}}&armin=armin",facebook:"https://www.facebook.com/sharer/sharer.php?u={{URL}}",twitter:"https://twitter.com/intent/tweet?text={{TITLE}}&url={{URL}}&via={{ORIGIN}}",google:"https://plus.google.com/share?url={{URL}}"};n.socialShare=function(i,e){i=typeof i=="string"?m(i):i,i.length===f&&(i=[i]),c(i,function(t){t.initialized||q(t,e)})},j(function(){socialShare(".social-share, .share-component")});function q(i,e){var t=N({},P,e||{},B(i));t.url=t.url?t.url:location.href,t.imageSelector&&(t.image=m(t.imageSelector).map(function(r){return r.src}).join("||")),z(i,"share-component social-share"),E(i,t),R(i,t),Q(i,t),k(i,t),i.initialized=!0}function E(i,e){var t=A(e),r=e.mode=="prepend";c(r?t.reverse():t,function(a){var l=U(a,e),s=e.initialized?h(i,"icon-"+a):d('<a class="social-share-icon icon-'+a+'"></a>');if(!s.length)return!0;if(s[0].href=l,a==="wechat"||a==="dingding"||a==="moments"||a==="picture"||a==="copylink")if(s[0].tabindex=-1,a==="picture")s[0].title="\u70B9\u51FB\u5206\u4EAB!",s[0].onclick=function(){n.socialShareaddShareLog(a),reportVisitLog&&reportVisitLog.callaction("03")};else if(a==="copylink"){s[0].title="\u70B9\u51FB\u5206\u4EAB!",s[0].setAttribute("data-clipboard-text",e.url);var S=new ClipboardJS(".icon-copylink");S.on("success",function(O){n.layer?n.layer.msg("\u590D\u5236\u6210\u529F\uFF01"):alert("\u590D\u5236\u6210\u529F\uFF01")}),S.on("error",function(O){console.log(O)}),s[0].onclick=function(){n.socialShareaddShareLog(a),reportVisitLog&&reportVisitLog.callaction("03")}}else s[0].onclick=function(){reportVisitLog&&reportVisitLog.callaction("03"),a!="dingding"&&a!="wechat"&&a!="moments"&&n.socialShareaddShareLog(a)};else s[0].title="\u70B9\u51FB\u5206\u4EAB!",s[0].target="_blank",s[0].onclick=function(){reportVisitLog&&reportVisitLog.callaction("03"),a!="dingding"&&a!="wechat"&&a!="moments"&&n.socialShareaddShareLog(a)};e.initialized||(r?i.insertBefore(s[0],i.firstChild):i.appendChild(s[0]))})}function R(i,e){var t=h(i,"icon-wechat","a");if(t.length===0)return!1;var r=d('<div class="wechat-qrcode"><h4>'+e.wechatQrcodeTitle+'</h4><div class="qrcode"></div><div class="help">'+e.wechatQrcodeHelper+"</div></div>"),a=h(r[0],"qrcode","div");new QRCode(a[0],{text:e.url,width:e.wechatQrcodeSize,height:e.wechatQrcodeSize,correctLevel:QRCode.CorrectLevel.L}),t[0].appendChild(r[0])}function k(i,e){var t=h(i,"icon-moments","a");if(t.length===0)return!1;var r=d('<div class="wechat-qrcode"><h4>'+e.momentsQrcodeTitle+'</h4><div class="qrcode"></div><div class="help">'+e.momentsQrcodeHelper+"</div></div>"),a=h(r[0],"qrcode","div");new QRCode(a[0],{text:e.url,width:e.momentsQrcodeSize,height:e.momentsQrcodeSize,correctLevel:QRCode.CorrectLevel.L}),t[0].appendChild(r[0])}function Q(i,e){var t=h(i,"icon-dingding","a");if(t.length===0)return!1;var r=d('<div class="wechat-qrcode"><h4>'+e.dingdingQrcodeTitle+'</h4><div class="qrcode"></div><div class="help">'+e.dingdingQrcodeHelper+"</div></div>"),a=h(r[0],"qrcode","div");new QRCode(a[0],{text:e.url,width:e.dingdingQrcodeSize,height:e.dingdingQrcodeSize,correctLevel:QRCode.CorrectLevel.L}),t[0].appendChild(r[0])}function A(i){i.mobileSites.length||(i.mobileSites=i.sites);var e=(y?i.mobileSites:i.sites).slice(0),t=i.disabled;return typeof e=="string"&&(e=e.split(/\s*,\s*/)),typeof t=="string"&&(t=t.split(/\s*,\s*/)),x&&t.push("wechat"),t.length&&c(t,function(r){v(r,e)>-1&&e.splice(v(r,e),1)}),e}function U(i,e){return e.summary||(e.summary=e.description),T[i].replace(/\{\{(\w)(\w*)\}\}/g,function(t,r,a){var l=i+r+a.toLowerCase();return a=(r+a).toLowerCase(),encodeURIComponent((e[l]===f?e[a]:e[l])||"")})}function m(i){return(o.querySelectorAll||n.jQuery||n.Zepto||M).call(o,i)}function M(i){var e=[];return c(i.split(/\s*,\s*/),function(t){var r=t.match(/([#.])(\w+)/);if(r===null)throw Error("Supports only simple single #ID or .CLASS selector.");if(r[1]){var a=o.getElementById(r[2]);a&&e.push(a)}e=e.concat(h(i))}),e}function z(i,e){if(e&&typeof e=="string"){var t=(i.className+" "+e).split(/\s+/),r=" ";c(t,function(a){r.indexOf(" "+a+" ")<0&&(r+=a+" ")}),i.className=r.slice(1,-1)}}function p(i){return(o.getElementsByName(i)[0]||0).content}function h(i,e,t){if(i.getElementsByClassName)return i.getElementsByClassName(e);var r=[],a=i.getElementsByTagName(t||"*");return e=" "+e+" ",c(a,function(l){(" "+(l.className||"")+" ").indexOf(e)>=0&&r.push(l)}),r}function d(i){var e=o.createElement("div");return e.innerHTML=i,e.childNodes}function N(){var i=arguments;if(u)return u.apply(null,i);var e={};return c(i,function(t){c(t,function(r,a){e[a]=r})}),i[0]=e}function B(i){if(i.dataset)return JSON.parse(JSON.stringify(i.dataset));var e={};return i.hasAttributes()?(c(i.attributes,function(t){var r=t.name;if(r.indexOf("data-")!==0)return!0;r=r.replace(/^data-/i,"").replace(/-(\w)/g,function(a,l){return l.toUpperCase()}),e[r]=t.value}),e):{}}function v(i,e,t){var r;if(e){if(g)return g.call(e,i,t);for(r=e.length,t=t?t<0?Math.max(0,r+t):t:0;t<r;t++)if(t in e&&e[t]===i)return t}return-1}function c(i,e){var t=i.length;if(t===f){for(var r in i)if(i.hasOwnProperty(r)&&e.call(i[r],i[r],r)===!1)break}else for(var a=0;a<t&&e.call(i[a],i[a],a)!==!1;a++);}function j(i){var e="addEventListener",t=o[e]?"":"on";~o.readyState.indexOf("m")?i():"load DOMContentLoaded readystatechange".replace(/\w+/g,function(r,a){(a?o:n)[t?"attachEvent":e](t+r,function(){i&&(a<6||~o.readyState.indexOf("m"))&&(i(),i=0)},!1)})}function D(i,e){for(var t=0;i.indexOf(e)!=-1;)i=i.replace(e,""),t++;return t}n.socialShareaddShareLog=function(i){var e=n.socialSharegetcluesourceType();e.clientType=n.socialSharegetclueChannel(),e.action=n.socialSharegetaction(i),n.routeId&&(e.routeId=n.socialSharegetParam("routeId")||f),$.ajax({type:"POST",headers:{token:getCookie("token")},url:"/api/common/addShareLog",contentType:"application/json",dataType:"json",data:JSON.stringify(e),async:!0,success:function(t){parseInt(t.code)==200}})},n.socialSharegetcluesourceType=function(){var i=n.socialSharegetParam("sourceType")||n.information_sourceType||"",e=n.socialSharegetParam("sourceId")||n.information_sourceId||0,t=n.location.href;return(t.indexOf("pages/info.html")>=0||t.indexOf("pages/wap/info.html")>=0||t.indexOf("pages/bundle.html")>=0||t.indexOf("pages/wap/bundle.html")>=0)&&(i="3",e=n.socialSharegetParam("cid")||0),t.indexOf("shop/item.html")>=0&&(i="4",e=n.socialSharegetParam("itemid")||0),t.indexOf("lookpic")>=0&&(i="32",e=n.socialSharegetParam("homepageInfoId")||0),t.indexOf("business/pictureLive.html")>=0&&(i="31",e=n.socialSharegetParam("picLiveId")||0),(t.indexOf("designschool/form/answer.html")>=0||t.indexOf("pages/company/answer.html")>=0||t.indexOf("/portal/form.html")>=0)&&(i="5",e=n.socialSharegetParam("formId")||0),t.indexOf("vscard/views.html")>=0&&(i="7",busStr=me.socialSharegetParam("vcardId")?decodeURIComponent(me.socialSharegetParam("vcardId")):"",e=0),(t.indexOf("pages/ware.html")>=0||t.indexOf("pages/wap/ware.html")>=0)&&(i="15",e=n.socialSharegetParam("rid")||0),t.indexOf("/portal/preview/doc.html")>=0&&(i="16",e=n.socialSharegetParam("aid")||0),t.indexOf("shop/discount.html")>=0&&(i="20",e=0,busStr=me.socialSharegetParam("couponCode")?decodeURIComponent(me.socialSharegetParam("couponCode")):""),t.indexOf("business/shareFolder.html")>=0&&(i="25",e=me.socialSharegetParam("fileIds")?decodeURIComponent(me.socialSharegetParam("fileIds")):""),(t.indexOf("/pages/newslist.html")>=0||t.indexOf("/pages/wap/newslist.html")>=0||t.indexOf("/pages/listrmation.html")>=0||t.indexOf("/pages/wap/listrmation.html")>=0)&&!me.socialSharegetParam("busType")&&(i="1",e=0),t.indexOf("/pages/QA.html")>=0&&(i="12",e=0),t.indexOf("/pages/Wikipedia.html")>=0&&(i="11",e=0),t.indexOf("/pages/products.html")>=0&&(i="10",e=0),t.indexOf("/pages/cases.html")>=0&&(i="9",e=0),t.indexOf("/pages/photos.html")>=0&&(i="13",e=0),t.indexOf("/pages/recruit.html")>=0&&(i="8",e=0),t.indexOf("/pages/partner.html")>=0&&(i="19",e=0),t.indexOf("/pages/qualification.html")>=0&&(i="17",e=0),t.indexOf("/pages/honour.html")>=0&&(i="18",e=0),t.indexOf("/portal/preview/doc.html")>=0&&(i="16",e=me.socialSharegetParam("aid")||0),(D(n.location.pathname,"/")==1&&t.indexOf(".shtml")>=0||location.pathname==""||location.pathname=="/")&&(i="14",e=0),t.indexOf("scale-h5server")>=0&&(i="28",e=me.socialSharegetParam("moduleId")||me.socialSharegetParam("plateId")?decodeURIComponent(me.socialSharegetParam("moduleId")||me.socialSharegetParam("plateId")):999999),{busType:i||"0",busId:e,title:$(o).attr("title"),url:n.location.href,sreId:n.isrequestSreId?n.socialSharegetParam("sreId")||"":f}},n.socialSharegetclueChannel=function(){var i=navigator.userAgent.toLowerCase(),e;if(n.__wxjs_environment==="miniprogram")e=4;else if(i.match(/MicroMessenger/i)=="micromessenger"){var t={win:!1,mac:!1},r=navigator.platform;t.win=r.indexOf("Win")==0,t.mac=r.indexOf("Mac")==0,t.win||t.mac?e=9:e=1}else localStorage.appAdapt===!0||localStorage.appAdapt==="true"?e=n.socialSharegetParam("channel")||5:n.socialSharegetParam("channel")?e=n.socialSharegetParam("channel"):/Android|webOS|iPhone|iPod|BlackBerry/i.test(navigator.userAgent)?e=2:e=3;return e},n.socialSharegetaction=function(i){var e="0";switch(i){case"copylink":e="1";break;case"wechat1":e="3";break;case"picture":e="2";break;case"weibo":e="8";break;case"qq":e="6";break;default:e="0"}return e},n.socialSharegetParam=function(i){var e=new RegExp("(^|&)"+i+"=([^&]*)(&|$)"),t=n.location.search.substr(1).match(e);return t!=null?unescape(t[2]):null}})(window,document);
