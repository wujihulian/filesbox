(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[28530],{43160:function(S){S.exports={audiomodalbox:"audiomodalbox___2IZ2B"}},16214:function(S,L,t){"use strict";t.r(L),t.d(L,{default:function(){return ne}});var ie=t(66126),C=t(99177),oe=t(34792),I=t(48086),R=t(34895),M=t(37406),B=t(45195),K=t(54549),W=t(28216),N=t(67294),Z=t(22004),V=t(33953),$=t.n(V),F=t(52989),J=t.n(F),z=t(45733),G=t.n(z),H=t(15316),Q=t.n(H),X=t(37461),Y=t.n(X),w=t(76877),k=t.n(w),b=t(17057),q=t.n(b),ee=t(43160),se=t.n(ee),n=t(85893),j,T,U,P,ne=(j=(0,W.$j)(A=>{var d=A.common;return{common:d}}),T=Reflect.metadata("design:type",Function),U=Reflect.metadata("design:paramtypes",[void 0]),j(P=T(P=U(P=class extends N.PureComponent{constructor(d){super(d);this.getaudioinfo=()=>{var a=this,e=this.props,s=e.dispatch,c=e.sourceID,l=e.isVersion,v=e.fileID,y=e.common,p=y.musicList,r=p===void 0?[]:p,_=r.length?r.findIndex(o=>l?o.fileID==v:o.sourceID==c):-1;a.setSheetState({player:a.player,playIndex:_,playing:!0})},this.onEnd=a=>{var e=this.props.common,s=e.volume,c=e.playing,l=e.playIndex,v=e.percent,y=e.playedSeconds,p=e.duration,r=e.playmode,_=e.musicList,o=_===void 0?[]:_,i=o.map((x,E)=>x.downloadUrl&&x.fileType=="mp3"?E:void 0).filter(x=>x!=null),m=i.indexOf(l),g=i.length>m+1?m+1:0,h=i.length?(0,M.sZ)(0,i.length-1):0,u=r=="1"?i[g]:r=="3"?l:i[h]==l?i[g]:i[h];if(l===u&&r!="3"){I.ZP.info("\u6682\u65E0\u66F4\u591A\u97F3\u4E50",2,null,!1);return}r!="3"?this.setSheetState({playIndex:u}):(this.player&&this.player.seekTo(0),this.setSheetState({playIndex:u}),this.goNext(u,!0))},this.prevNext=a=>{var e=this.props.common,s=e.volume,c=e.playing,l=e.playIndex,v=e.percent,y=e.playedSeconds,p=e.duration,r=e.playmode,_=e.musicList,o=_.map((E,f)=>E.downloadUrl&&E.fileType=="mp3"?f:void 0).filter(E=>E!=null),i=o.indexOf(l),m=o.length>i+1?i+1:0,g=i-1>=0?i-1:o.length-1,h=a=="next"?m:g,u=o.length?(0,M.sZ)(0,o.length-1):0,x=r=="1"?o[h]:r=="3"?l:o[u]==l?o[h]:o[u];if(l===o[h]){I.ZP.info("\u6682\u65E0\u66F4\u591A\u97F3\u4E50",2,null,!1);return}this.setSheetState({playIndex:o[h]})},this.goNext=(a,e)=>{var s=this.props.common,c=s.volume,l=s.playing,v=s.playIndex,y=s.percent,p=s.playedSeconds,r=s.duration,_=s.playmode,o=s.musicList,i=o[a]||{};this.setSheetState({percent:0,playedSeconds:0,playing:e,duration:v===a?r:0,playIndex:a}),this.setState({isinit:!0}),this.player&&this.player.seekTo(0)},this.onPercentChange=a=>{var e=this.props.common,s=e.player,c=e.duration;this.setSheetState({playing:!0,percent:a,playedSeconds:a/100*c}),s.seekTo(parseFloat(a/100))},this.onVolumeChange=a=>{var e=this.props.common,s=e.player,c=e.duration;this.setSheetState({volume:a/100})},this.setSheetState=a=>{this.props.dispatch({type:"common/setState",payload:a})},this.removeActiveMusic=a=>{a.preventDefault();var e=this,s=this.props.common,c=s.sourceID,l=s.volume,v=s.playmode,y=s.playing,p=s.playIndex,r=s.percent,_=s.playedSeconds,o=s.duration,i=s.musicList,m=i;m.splice(p,1),e.setSheetState({musicList:i,playIndex:m.length-1})},this.onDuration=this.onDuration.bind(this),this.onProgress=this.onProgress.bind(this),this.onEnd=this.onEnd.bind(this),this.state={modelZindex:100,isinit:!1}}componentDidUpdate(d){var a=this,e=a.state.isinit,s=d.common||{},c=this.props.common||{};s.playIndex!==c.playIndex&&setTimeout(function(){a.goNext(c.playIndex,!0)})}componentDidMount(){var d=this;d.getaudioinfo()}onDuration(d){this.setSheetState({duration:d})}onProgress(d){var a=this,e=this.props.common,s=e.volume,c=e.playing,l=e.playIndex,v=e.percent,y=e.playedSeconds,p=e.duration,r=e.musicList,_=r[l],o=_.videoAuditionSet?JSON.parse(_.videoAuditionSet):{},i=o.time||0;i&&d.playedSeconds>=i&&!_.isPay?this.onPercentChangefalse(i/p*100):a.setSheetState({percent:d.played*100,playedSeconds:d.playedSeconds})}render(){var d=this,a=d.props,e=a.dispatch,s=a.common,c=a.open,l=a.setOpenModel,v=a.videoOption,y=a.issmall,p=a.showIndex,r=s.sourceID,_=s.volume,o=s.playmode,i=s.playing,m=s.playIndex,g=s.percent,h=s.playedSeconds,u=s.duration,x=s.musicList,E=this.state.modelZindex,f=x[m]||{},O=f.sourceInfo||{},ae=D=>{d.setState({modelZindex:D})};return(0,n.jsx)(n.Fragment,{children:(0,n.jsx)(R.Z,{open:c,issmall:y,showIndex:p,modelZindex:E,setOpenModel:l,setModelZindex:ae,type:"audio",title:f.name,children:(0,n.jsxs)("div",{className:se().audiomodalbox,children:[(0,n.jsxs)("div",{className:"progress",children:[(0,n.jsx)("div",{className:"progressLeft",children:(0,M.mr)(h)}),(0,n.jsx)(C.Z,{value:g,tooltip:{formatter:null},onChange:this.onPercentChange}),(0,n.jsx)("div",{className:"progressRight",children:(0,M.mr)(u)})]}),(0,n.jsxs)("div",{className:"playpause",children:[(0,n.jsxs)("div",{className:"playpauseCenter",children:[(0,n.jsx)("a",{onClick:()=>{this.prevNext("prev")},className:"prev",children:(0,n.jsx)("img",{src:k()})}),i?(0,n.jsx)("a",{onClick:()=>{this.setSheetState({playing:!i})},className:"play",children:(0,n.jsx)("img",{src:G()})}):(0,n.jsx)("a",{onClick:()=>{this.setSheetState({playing:!i})},className:"play",children:(0,n.jsx)("img",{src:Q()})})," ",(0,n.jsx)("a",{onClick:()=>{this.prevNext("next")},className:"next",children:(0,n.jsx)("img",{src:J()})})]}),(0,n.jsxs)("div",{className:"playpauseRight",children:[o=="1"?(0,n.jsx)("a",{onClick:()=>{this.setSheetState({playmode:"2"}),I.ZP.info("\u968F\u673A\u64AD\u653E",2,null,!1)},className:"playmode",children:(0,n.jsx)("img",{src:q()})}):"",o=="2"?(0,n.jsx)("a",{onClick:()=>{this.setSheetState({playmode:"3"}),I.ZP.info("\u5355\u66F2\u64AD\u653E",2,null,!1)},className:"playmode1",children:(0,n.jsx)("img",{src:$()})}):"",o=="3"?(0,n.jsx)("a",{onClick:()=>{this.setSheetState({playmode:"1"}),I.ZP.info("\u987A\u5E8F\u64AD\u653E",2,null,!1)},className:"playmode",children:(0,n.jsx)("img",{src:Y()})}):""]}),(0,n.jsx)(B.Z,{}),(0,n.jsxs)("div",{className:"volumeBox",children:[" ",(0,n.jsx)(C.Z,{onChange:this.onVolumeChange,defaultValue:_*100})]})]}),(0,n.jsx)("div",{className:"musicList",children:x.map((D,te)=>(0,n.jsxs)("div",{onClick:()=>{this.goNext(te,!0)},className:"musicLi",children:[(0,n.jsxs)("div",{className:"nusicname",children:[" ",D.name]}),(0,n.jsx)("div",{onClick:this.removeActiveMusic,className:"removebtn",children:(0,n.jsx)(K.Z,{})})]}))}),(0,n.jsx)("div",{style:{display:"none"},children:(0,n.jsx)(Z.Z,{volume:_,url:O.h264Path||O.downloadUrl?O.h264Path||O.downloadUrl:f.h264Path||f.downloadUrl,controls:!0,playing:i,ref:D=>{this.player=D},onProgress:this.onProgress,onDuration:this.onDuration,onEnded:this.onEnd})})]})})})}})||P)||P)||P)}}]);
