"use strict";var FontInspector=function(){let l,r=!1;const h="data-font-name";function s(){const o=document.querySelectorAll(`span[${h}]`);for(const e of o)e.className=""}function i(){const o=document.querySelectorAll(`span[${h}]`);for(const e of o)e.className="debuggerHideText"}function t(o,e){const c=document.querySelectorAll(`span[${h}=${o}]`);for(const a of c)a.className=e?"debuggerShowText":"debuggerHideText"}function n(o){if(!o.target.dataset.fontName||o.target.tagName.toUpperCase()!=="SPAN")return;const e=o.target.dataset.fontName,c=document.getElementsByTagName("input");for(let a=0;a<c.length;++a){const d=c[a];d.dataset.fontName===e&&(d.checked=!d.checked,t(e,d.checked),d.scrollIntoView())}}return{id:"FontInspector",name:"Font Inspector",panel:null,manager:null,init:function(e){const c=this.panel,a=document.createElement("button");a.addEventListener("click",i),a.textContent="Refresh",c.appendChild(a),l=document.createElement("div"),c.appendChild(l)},cleanup:function(){l.textContent=""},enabled:!1,get active(){return r},set active(o){r=o,r?(document.body.addEventListener("click",n,!0),i()):(document.body.removeEventListener("click",n,!0),s())},fontAdded:function(e,c){function a(E,x){const S=document.createElement("table");for(let k=0;k<x.length;k++){const v=document.createElement("tr"),y=document.createElement("td");y.textContent=x[k],v.appendChild(y);const b=document.createElement("td");b.textContent=E[x[k]].toString(),v.appendChild(b),S.appendChild(v)}return S}const d=a(e,["name","type"]),u=e.loadedName,p=document.createElement("div"),g=document.createElement("span");g.textContent=u;const f=document.createElement("a");c?(c=/url\(['"]?([^)"']+)/.exec(c),f.href=c[1]):e.data&&(f.href=URL.createObjectURL(new Blob([e.data],{type:e.mimeType}))),f.textContent="Download";const m=document.createElement("a");m.href="",m.textContent="Log",m.addEventListener("click",function(E){E.preventDefault(),console.log(e)});const C=document.createElement("input");C.setAttribute("type","checkbox"),C.dataset.fontName=u,C.addEventListener("click",function(){t(u,C.checked)}),p.appendChild(C),p.appendChild(g),p.appendChild(document.createTextNode(" ")),p.appendChild(f),p.appendChild(document.createTextNode(" ")),p.appendChild(m),p.appendChild(d),l.appendChild(p),setTimeout(()=>{this.active&&i()},2e3)}}}();let opMap;var StepperManager=function(){let l=[],r=null,h=null,s=null,i=Object.create(null);return{id:"Stepper",name:"Stepper",panel:null,manager:null,init:function(n){const o=this;h=document.createElement("div"),s=document.createElement("select"),s.addEventListener("change",function(e){o.selectStepper(this.value)}),h.appendChild(s),r=document.createElement("div"),this.panel.appendChild(h),this.panel.appendChild(r),sessionStorage.getItem("pdfjsBreakPoints")&&(i=JSON.parse(sessionStorage.getItem("pdfjsBreakPoints"))),opMap=Object.create(null);for(const e in n.OPS)opMap[n.OPS[e]]=e},cleanup:function(){s.textContent="",r.textContent="",l=[]},enabled:!1,active:!1,create:function(n){const o=document.createElement("div");o.id="stepper"+n,o.hidden=!0,o.className="stepper",r.appendChild(o);const e=document.createElement("option");e.textContent="Page "+(n+1),e.value=n,s.appendChild(e);const c=i[n]||[],a=new Stepper(o,n,c);return l.push(a),l.length===1&&this.selectStepper(n,!1),a},selectStepper:function(n,o){let e;for(n|=0,o&&this.manager.selectPanel(this),e=0;e<l.length;++e){const a=l[e];a.panel.hidden=a.pageIndex!==n}const c=s.options;for(e=0;e<c.length;++e){const a=c[e];a.selected=(a.value|0)===n}},saveBreakPoints:function(n,o){i[n]=o,sessionStorage.setItem("pdfjsBreakPoints",JSON.stringify(i))}}}();const Stepper=function(){function l(s,i){const t=document.createElement(s);return i&&(t.textContent=i),t}function r(s){if(typeof s=="string"){const t=75;return s.length<=t?s:s.substring(0,t)+"..."}if(typeof s!="object"||s===null)return s;if("length"in s){const t=10,n=[];let o,e;for(o=0,e=Math.min(t,s.length);o<e;o++)n.push(r(s[o]));return o<s.length&&n.push("..."),n}const i={};for(const t in s)i[t]=r(s[t]);return i}class h{constructor(i,t,n){this.panel=i,this.breakPoint=0,this.nextBreakPoint=null,this.pageIndex=t,this.breakPoints=n,this.currentIdx=-1,this.operatorListIdx=0,this.indentLevel=0}init(i){const t=this.panel,n=l("div","c=continue, s=step"),o=l("table");n.appendChild(o),o.cellSpacing=0;const e=l("tr");o.appendChild(e),e.appendChild(l("th","Break")),e.appendChild(l("th","Idx")),e.appendChild(l("th","fn")),e.appendChild(l("th","args")),t.appendChild(n),this.table=o,this.updateOperatorList(i)}updateOperatorList(i){const t=this;function n(){const a=+this.dataset.idx;this.checked?t.breakPoints.push(a):t.breakPoints.splice(t.breakPoints.indexOf(a),1),StepperManager.saveBreakPoints(t.pageIndex,t.breakPoints)}const o=15e3;if(this.operatorListIdx>o)return;const e=document.createDocumentFragment(),c=Math.min(o,i.fnArray.length);for(let a=this.operatorListIdx;a<c;a++){const d=l("tr");d.className="line",d.dataset.idx=a,e.appendChild(d);const u=this.breakPoints.includes(a),p=i.argsArray[a]||[],g=l("td"),f=l("input");f.type="checkbox",f.className="points",f.checked=u,f.dataset.idx=a,f.onclick=n,g.appendChild(f),d.appendChild(g),d.appendChild(l("td",a.toString()));const m=opMap[i.fnArray[a]];let C=p;if(m==="showText"){const E=p[0],x=l("tr"),S=l("tr"),k=l("tr");for(let y=0;y<E.length;y++){const b=E[y];if(typeof b=="object"&&b!==null)x.appendChild(l("td",b.originalCharCode)),S.appendChild(l("td",b.fontChar)),k.appendChild(l("td",b.unicode));else{const N=l("td",b);N.classList.add("advance"),x.appendChild(N),S.appendChild(l("td")),k.appendChild(l("td"))}}C=l("td");const v=l("table");v.classList.add("showText"),C.appendChild(v),v.appendChild(x),v.appendChild(S),v.appendChild(k)}else m==="restore"&&this.indentLevel--;d.appendChild(l("td"," ".repeat(this.indentLevel*2)+m)),m==="save"&&this.indentLevel++,C instanceof HTMLElement?d.appendChild(C):d.appendChild(l("td",JSON.stringify(r(C))))}if(c<i.fnArray.length){const a=l("td","...");a.colspan=4,e.appendChild(a)}this.operatorListIdx=i.fnArray.length,this.table.appendChild(e)}getNextBreakPoint(){this.breakPoints.sort(function(i,t){return i-t});for(let i=0;i<this.breakPoints.length;i++)if(this.breakPoints[i]>this.currentIdx)return this.breakPoints[i];return null}breakIt(i,t){StepperManager.selectStepper(this.pageIndex,!0),this.currentIdx=i;const n=o=>{switch(o.keyCode){case 83:document.removeEventListener("keydown",n),this.nextBreakPoint=this.currentIdx+1,this.goTo(-1),t();break;case 67:document.removeEventListener("keydown",n),this.nextBreakPoint=this.getNextBreakPoint(),this.goTo(-1),t();break}};document.addEventListener("keydown",n),this.goTo(i)}goTo(i){const t=this.panel.getElementsByClassName("line");for(let n=0,o=t.length;n<o;++n){const e=t[n];(e.dataset.idx|0)===i?(e.style.backgroundColor="rgb(251,250,207)",e.scrollIntoView()):e.style.backgroundColor=null}}}return h}();var Stats=function(){let l=[];function r(s){s.textContent=""}function h(s){for(let i=0,t=l.length;i<t;++i)if(l[i].pageNumber===s)return i;return!1}return{id:"Stats",name:"Stats",panel:null,manager:null,init(s){},enabled:!1,active:!1,add(s,i){if(!i)return;const t=h(s);t!==!1&&(l[t].div.remove(),l.splice(t,1));const n=document.createElement("div");n.className="stats";const o=document.createElement("div");o.className="title",o.textContent="Page: "+s;const e=document.createElement("div");e.textContent=i.toString(),n.appendChild(o),n.appendChild(e),l.push({pageNumber:s,div:n}),l.sort(function(c,a){return c.pageNumber-a.pageNumber}),r(this.panel);for(let c=0,a=l.length;c<a;++c)this.panel.appendChild(l[c].div)},cleanup(){l=[],r(this.panel)}}}();window.PDFBug=function(){const l=300,r=[];let h=null;return{tools:[FontInspector,StepperManager,Stats],enable(s){const i=s.length===1&&s[0]==="all",t=this.tools;for(let n=0;n<t.length;++n){const o=t[n];(i||s.includes(o.id))&&(o.enabled=!0)}i||t.sort(function(n,o){let e=s.indexOf(n.id);e=e<0?t.length:e;let c=s.indexOf(o.id);return c=c<0?t.length:c,e-c})},init(s,i,t){this.enable(t);const n=document.createElement("div");n.id="PDFBug";const o=document.createElement("div");o.setAttribute("class","controls"),n.appendChild(o);const e=document.createElement("div");e.setAttribute("class","panels"),n.appendChild(e),i.appendChild(n),i.style.right=l+"px";const c=this.tools,a=this;for(let d=0;d<c.length;++d){const u=c[d],p=document.createElement("div"),g=document.createElement("button");g.textContent=u.name,g.addEventListener("click",function(f){return function(m){m.preventDefault(),a.selectPanel(f)}}(d)),o.appendChild(g),e.appendChild(p),u.panel=p,u.manager=this,u.enabled?u.init(s):p.textContent=`${u.name} is disabled. To enable add "${u.id}" to the pdfBug parameter and refresh (separate multiple by commas).`,r.push(g)}this.selectPanel(0)},cleanup(){for(let s=0,i=this.tools.length;s<i;s++)this.tools[s].enabled&&this.tools[s].cleanup()},selectPanel(s){if(typeof s!="number"&&(s=this.tools.indexOf(s)),s===h)return;h=s;const i=this.tools;for(let t=0;t<i.length;++t){const n=t===s;r[t].classList.toggle("active",n),i[t].active=n,i[t].panel.hidden=!n}}}}();
