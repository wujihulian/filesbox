(function(){"use strict";function M(){}function d(n){return function(){return n}}function h(){return N}var _,j=tinymce.util.Tools.resolve("tinymce.PluginManager"),D=tinymce.util.Tools.resolve("tinymce.dom.DOMUtils"),T=tinymce.util.Tools.resolve("tinymce.EditorManager"),R=tinymce.util.Tools.resolve("tinymce.Env"),m=tinymce.util.Tools.resolve("tinymce.util.Tools"),U=function(n){return n.getParam("importcss_merge_classes")},z=function(n){return n.getParam("importcss_exclusive")},b=function(n){return n.getParam("importcss_selector_converter")},q=function(n){return n.getParam("importcss_selector_filter")},B=function(n){return n.getParam("importcss_groups")},F=function(n){return n.getParam("importcss_append")},L=function(n){return n.getParam("importcss_file_filter")},x=d(!1),k=d(!0),N=(_={fold:function(n,o){return n()},is:x,isSome:x,isNone:k,getOr:P,getOrThunk:A,getOrDie:function(n){throw new Error(n||"error: getOrDie called on none.")},getOrNull:d(null),getOrUndefined:d(void 0),or:P,orThunk:A,map:h,each:M,bind:h,exists:x,forall:k,filter:h,equals:S,equals_:S,toArray:function(){return[]},toString:d("none()")},Object.freeze&&Object.freeze(_),_);function S(n){return n.isNone()}function A(n){return n()}function P(n){return n}function w(n){return function(o){return function(r){if(r===null)return"null";var u=typeof r;return u=="object"&&(Array.prototype.isPrototypeOf(r)||r.constructor&&r.constructor.name==="Array")?"array":u=="object"&&(String.prototype.isPrototypeOf(r)||r.constructor&&r.constructor.name==="String")?"string":u}(o)===n}}function C(n,o){return function(r){for(var u=[],c=0,l=r.length;c<l;++c){if(!$(r[c]))throw new Error("Arr.flatten item "+c+" was not an array, input: "+r);J.apply(u,r[c])}return u}(function(r,u){for(var c=r.length,l=new Array(c),s=0;s<c;s++){var v=r[s];l[s]=u(v,s)}return l}(n,o))}function O(n){return typeof n=="string"?function(o){return o.indexOf(n)!==-1}:n instanceof RegExp?function(o){return n.test(o)}:n}function G(n,o,r){var u=[],c={};function l(s,v){var f,a=s.href;if((a=function(t){var e=R.cacheSuffix;return typeof t=="string"&&(t=t.replace("?"+e,"").replace("&"+e,"")),t}(a))&&r(a,v)&&!function(t,e){var i=t.settings,p=i.skin!==!1&&(i.skin||"oxide");if(p){var g=i.skin_url?t.documentBaseURI.toAbsolute(i.skin_url):T.baseURL+"/skins/ui/"+p,y=T.baseURL+"/skins/content/";return e===g+"/content"+(t.inline?".inline":"")+".min.css"||e.indexOf(y)!==-1}return!1}(n,a)){m.each(s.imports,function(t){l(t,!0)});try{f=s.cssRules||s.rules}catch(t){}m.each(f,function(t){t.styleSheet?l(t.styleSheet,!0):t.selectorText&&m.each(t.selectorText.split(","),function(e){u.push(m.trim(e))})})}}m.each(n.contentCSS,function(s){c[s]=!0}),r=r||function(s,v){return v||c[s]};try{m.each(o.styleSheets,function(s){l(s)})}catch(s){}return u}function E(n,o){var r,u=/^(?:([a-z0-9\-_]+))?(\.[a-z0-9_\-\.]+)$/i.exec(o);if(u){var c=u[1],l=u[2].substr(1).split(".").join(" "),s=m.makeMap("a,img");return u[1]?(r={title:o},n.schema.getTextBlockElements()[c]?r.block=c:n.schema.getBlockElements()[c]||s[c.toLowerCase()]?r.selector=c:r.inline=c):u[2]&&(r={inline:"span",title:o.substr(1),classes:l}),U(n)!==!1?r.classes=l:r.attributes={class:l},r}}function I(n,o){return o===null||z(n)!==!1}var $=w("array"),H=w("function"),W=Array.prototype.slice,J=Array.prototype.push,K=(H(Array.from)&&Array.from,E),Q=function(n){n.on("init",function(o){function r(f,a){if(function(i,p,g,y){return!(I(i,g)?p in y:p in g.selectors)}(n,f,a,c)){(function(i,p,g,y){I(i,g)?y[p]=!0:g.selectors[p]=!0})(n,f,a,c);var t=function(i,p,g,y){return(y&&y.selector_converter?y.selector_converter:b(i)?b(i):function(){return E(i,g)}).call(p,g,y)}(n,n.plugins.importcss,f,a);if(t){var e=t.name||D.DOM.uniqueId();return n.formatter.register(e,t),m.extend({},{title:t.title,format:e})}}return null}var u=function(){var f=[],a=[],t={};return{addItemToGroup:function(e,i){t[e]?t[e].push(i):(a.push(e),t[e]=[i])},addItem:function(e){f.push(e)},toFormats:function(){return C(a,function(e){var i=t[e];return i.length===0?[]:[{title:e,items:i}]}).concat(f)}}}(),c={},l=O(q(n)),s=function(f){return m.map(f,function(a){return m.extend({},a,{original:a,selectors:{},filter:O(a.filter),item:{text:a.title,menu:[]}})})}(B(n));m.each(G(n,n.getDoc(),O(L(n))),function(f){if(f.indexOf(".mce-")===-1&&(!l||l(f))){var a=function(e,i){return m.grep(e,function(p){return!p.filter||p.filter(i)})}(s,f);if(0<a.length)m.each(a,function(e){var i=r(f,e);i&&u.addItemToGroup(e.title,i)});else{var t=r(f,null);t&&u.addItem(t)}}});var v=u.toFormats();n.fire("addStyleModifications",{items:v,replace:!F(n)})})},V=function(n){return{convertSelectorToFormat:function(o){return K(n,o)}}};(function(){j.add("importcss",function(o){return Q(o),V(o)})})()})();
