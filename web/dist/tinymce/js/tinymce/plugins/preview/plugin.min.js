(function(){"use strict";var c=tinymce.util.Tools.resolve("tinymce.PluginManager"),s=tinymce.util.Tools.resolve("tinymce.util.Tools"),d=function(e){return e.getParam("content_style","")},l=function(e){return e.getParam("content_css_cors",!1,"boolean")},m=tinymce.util.Tools.resolve("tinymce.Env"),u=function(e){var t="",n=e.dom.encode,r=d(e);t+='<base href="'+n(e.documentBaseURI.getURI())+'">',r&&(t+='<style type="text/css">'+r+"</style>");var f=l(e)?' crossorigin="anonymous"':"";s.each(e.contentCSS,function(w){t+='<link type="text/css" rel="stylesheet" href="'+n(e.documentBaseURI.toAbsolute(w))+'"'+f+">"});var i=e.settings.body_id||"tinymce";i.indexOf("=")!==-1&&(i=(i=e.getParam("body_id","","hash"))[e.id]||i);var o=e.settings.body_class||"";o.indexOf("=")!==-1&&(o=(o=e.getParam("body_class","","hash"))[e.id]||"");var p='<script>document.addEventListener && document.addEventListener("click", function(e) {for (var elm = e.target; elm; elm = elm.parentNode) {if (elm.nodeName === "A" && !('+(m.mac?"e.metaKey":"e.ctrlKey && !e.altKey")+")) {e.preventDefault();}}}, false);</script> ",a=e.getBody().dir,g=a?' dir="'+n(a)+'"':"";return"<!DOCTYPE html><html><head>"+t+'</head><body id="'+n(i)+'" class="mce-content-body '+n(o)+'"'+g+">"+e.getContent()+p+"</body></html>"},y=function(e){e.addCommand("mcePreview",function(){(function(t){var n=u(t);t.windowManager.open({title:"Preview",size:"large",body:{type:"panel",items:[{name:"preview",type:"iframe",sandboxed:!0}]},buttons:[{type:"cancel",name:"close",text:"Close",primary:!0}],initialData:{preview:n}}).focus("close")})(e)})},v=function(e){e.ui.registry.addButton("preview",{icon:"preview",tooltip:"Preview",onAction:function(){return e.execCommand("mcePreview")}}),e.ui.registry.addMenuItem("preview",{icon:"preview",text:"Preview",onAction:function(){return e.execCommand("mcePreview")}})};(function(){c.add("preview",function(t){y(t),v(t)})})()})();
