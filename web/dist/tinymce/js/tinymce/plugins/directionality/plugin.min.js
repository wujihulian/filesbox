(function(o){"use strict";function v(){}function d(t){return function(){return t}}function a(){return s}var m,C=tinymce.util.Tools.resolve("tinymce.PluginManager"),A=tinymce.util.Tools.resolve("tinymce.util.Tools"),g=function(t,n){var e,u=t.dom,i=t.selection.getSelectedBlocks();i.length&&(e=u.getAttrib(i[0],"dir"),A.each(i,function(r){u.getParent(r.parentNode,'*[dir="'+n+'"]',u.getRoot())||u.setAttrib(r,"dir",e!==n?n:null)}),t.nodeChanged())},w=function(t){t.addCommand("mceDirectionLTR",function(){g(t,"ltr")}),t.addCommand("mceDirectionRTL",function(){g(t,"rtl")})},f=d(!1),N=d(!0),s=(m={fold:function(t,n){return t()},is:f,isSome:f,isNone:N,getOr:O,getOrThunk:E,getOrDie:function(t){throw new Error(t||"error: getOrDie called on none.")},getOrNull:d(null),getOrUndefined:d(void 0),or:O,orThunk:E,map:a,each:v,bind:a,exists:f,forall:N,filter:a,equals:T,equals_:T,toArray:function(){return[]},toString:d("none()")},Object.freeze&&Object.freeze(m),m);function T(t){return t.isNone()}function E(t){return t()}function O(t){return t}function S(t,n){var e=t.dom(),u=o.window.getComputedStyle(e).getPropertyValue(n),i=u!==""||function(r){var c=b(r)?r.dom().parentNode:r.dom();return c!=null&&c.ownerDocument.body.contains(c)}(t)?u:L(e,n);return i===null?void 0:i}function y(t,n){return function(e){function u(i){var r=M.fromDom(i.element);e.setActive(function(c){return S(c,"direction")==="rtl"?"rtl":"ltr"}(r)===n)}return t.on("NodeChange",u),function(){return t.off("NodeChange",u)}}}var D,h,p=function(t){function n(){return i}function e(r){return r(t)}var u=d(t),i={fold:function(r,c){return c(t)},is:function(r){return t===r},isSome:N,isNone:f,getOr:u,getOrThunk:u,getOrDie:u,getOrNull:u,getOrUndefined:u,or:n,orThunk:n,map:function(r){return p(r(t))},each:function(r){r(t)},bind:e,exists:e,forall:e,filter:function(r){return r(t)?i:s},toArray:function(){return[t]},toString:function(){return"some("+t+")"},equals:function(r){return r.is(t)},equals_:function(r,c){return r.fold(f,function(U){return c(t,U)})}};return i},R=function(t){return t==null?s:p(t)},l=function(t){if(t==null)throw new Error("Node cannot be null or undefined");return{dom:d(t)}},M={fromHtml:function(t,n){var e=(n||o.document).createElement("div");if(e.innerHTML=t,!e.hasChildNodes()||1<e.childNodes.length)throw o.console.error("HTML does not have a single root node",t),new Error("HTML must have a single root node");return l(e.childNodes[0])},fromTag:function(t,n){var e=(n||o.document).createElement(t);return l(e)},fromText:function(t,n){var e=(n||o.document).createTextNode(t);return l(e)},fromDom:l,fromPoint:function(t,n,e){var u=t.dom();return R(u.elementFromPoint(n,e)).map(l)}},_=(D="function",function(t){return function(n){if(n===null)return"null";var e=typeof n;return e=="object"&&(Array.prototype.isPrototypeOf(n)||n.constructor&&n.constructor.name==="Array")?"array":e=="object"&&(String.prototype.isPrototypeOf(n)||n.constructor&&n.constructor.name==="String")?"string":e}(t)===D}),x=Array.prototype.slice,P=(_(Array.from)&&Array.from,o.Node.ATTRIBUTE_NODE,o.Node.CDATA_SECTION_NODE,o.Node.COMMENT_NODE,o.Node.DOCUMENT_NODE,o.Node.DOCUMENT_TYPE_NODE,o.Node.DOCUMENT_FRAGMENT_NODE,o.Node.ELEMENT_NODE,o.Node.TEXT_NODE),b=(o.Node.PROCESSING_INSTRUCTION_NODE,o.Node.ENTITY_REFERENCE_NODE,o.Node.ENTITY_NODE,o.Node.NOTATION_NODE,typeof o.window!="undefined"?o.window:Function("return this;")(),h=P,function(t){return function(n){return n.dom().nodeType}(t)===h}),L=function(t,n){return function(e){return e.style!==void 0&&_(e.style.getPropertyValue)}(t)?t.style.getPropertyValue(n):""},I=function(t){t.ui.registry.addToggleButton("ltr",{tooltip:"Left to right",icon:"ltr",onAction:function(){return t.execCommand("mceDirectionLTR")},onSetup:y(t,"ltr")}),t.ui.registry.addToggleButton("rtl",{tooltip:"Right to left",icon:"rtl",onAction:function(){return t.execCommand("mceDirectionRTL")},onSetup:y(t,"rtl")})};(function(){C.add("directionality",function(n){w(n),I(n)})})()})(window);
