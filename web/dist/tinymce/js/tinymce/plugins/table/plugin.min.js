(function(O){"use strict";function dt(t){return t}var mt=function(t){function n(){return e}var e=t;return{get:n,set:function(r){e=r},clone:function(){return mt(n())}}},y=function(){},ro=function(t,n){return function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];return t(n.apply(null,e))}},h=function(t){return function(){return t}};function N(t){for(var n=[],e=1;e<arguments.length;e++)n[e-1]=arguments[e];return function(){for(var r=[],o=0;o<arguments.length;o++)r[o]=arguments[o];var i=n.concat(r);return t.apply(null,i)}}function Be(t){return function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];return!t.apply(null,n)}}function Jn(){return Me}var Pe,rt=h(!1),G=h(!0),Me=(Pe={fold:function(t,n){return t()},is:rt,isSome:rt,isNone:G,getOr:uo,getOrThunk:io,getOrDie:function(t){throw new Error(t||"error: getOrDie called on none.")},getOrNull:h(null),getOrUndefined:h(void 0),or:uo,orThunk:io,map:Jn,each:y,bind:Jn,exists:rt,forall:G,filter:Jn,equals:oo,equals_:oo,toArray:function(){return[]},toString:h("none()")},Object.freeze&&Object.freeze(Pe),Pe);function oo(t){return t.isNone()}function io(t){return t()}function uo(t){return t}function xn(t){return function(n){return function(e){if(e===null)return"null";var r=typeof e;return r=="object"&&(Array.prototype.isPrototypeOf(e)||e.constructor&&e.constructor.name==="Array")?"array":r=="object"&&(String.prototype.isPrototypeOf(e)||e.constructor&&e.constructor.name==="String")?"string":r}(n)===t}}function X(t,n){return-1<function(e,r){return Ic.call(e,r)}(t,n)}function Rn(t,n){for(var e=0,r=t.length;e<r;e++)if(n(t[e],e))return!0;return!1}function C(t,n){for(var e=t.length,r=new Array(e),o=0;o<e;o++){var i=t[o];r[o]=n(i,o)}return r}function x(t,n){for(var e=0,r=t.length;e<r;e++)n(t[e],e)}function ot(t,n){for(var e=[],r=0,o=t.length;r<o;r++){var i=t[r];n(i,r)&&e.push(i)}return e}function Tn(t,n,e){return function(r,o){for(var i=r.length-1;0<=i;i--)o(r[i],i)}(t,function(r){e=n(e,r)}),e}function yt(t,n,e){return x(t,function(r){e=n(e,r)}),e}function Ct(t,n){for(var e=0,r=t.length;e<r;e++){var o=t[e];if(n(o,e))return s.some(o)}return s.none()}function zt(t,n){for(var e=0,r=t.length;e<r;e++)if(n(t[e],e))return s.some(e);return s.none()}function We(t){for(var n=[],e=0,r=t.length;e<r;++e){if(!ne(t[e]))throw new Error("Arr.flatten item "+e+" was not an array, input: "+t);Bc.apply(n,t[e])}return n}function gt(t,n){return We(C(t,n))}function On(t,n){for(var e=0,r=t.length;e<r;++e)if(n(t[e],e)!==!0)return!1;return!0}function co(t){var n=kc.call(t,0);return n.reverse(),n}function Zt(t,n){for(var e=0;e<t.length;e++){var r=n(t[e],e);if(r.isSome())return r}return s.none()}function tn(t,n){for(var e=un(t),r=0,o=e.length;r<o;r++){var i=e[r];n(t[i],i)}}function ao(t,n){return Mc(t,function(e,r){return{k:r,v:n(e,r)}})}function It(t,n){return Wc(t,n)?s.from(t[n]):s.none()}function D(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];if(t.length!==e.length)throw new Error('Wrong number of arguments to struct. Expected "['+t.length+']", got '+e.length+" arguments");var o={};return x(t,function(i,u){o[i]=h(e[u])}),o}}function Dn(t){return t.slice(0).sort()}function lo(t,n){throw new Error("All required keys ("+Dn(t).join(", ")+") were not specified. Specified keys were: "+Dn(n).join(", ")+".")}function fo(t){throw new Error("Unsupported keys for object: "+Dn(t).join(", "))}function _e(t,n){if(!ne(n))throw new Error("The "+t+" fields must be an array. Was: "+n+".");x(n,function(e){if(!Ft(e))throw new Error("The value "+e+" in the "+t+" fields was not a string.")})}function so(t){var n=Dn(t);Ct(n,function(e,r){return r<n.length-1&&e===n[r+1]}).each(function(e){throw new Error("The field: "+e+" occurs more than once in the combined fields: ["+n.join(", ")+"].")})}function mo(t){return t.dom().nodeType}function go(t){return function(n){return mo(n)===t}}function Sc(t){return mo(t)===_c||I(t)==="#comment"}function po(t,n,e){if(!(Ft(e)||Nc(e)||To(e)))throw O.console.error("Invalid call to Attr.set. Key ",n,":: Value ",e,":: Element ",t),new Error("Attribute value was not simple");t.setAttribute(n,e+"")}function tt(t,n,e){po(t.dom(),n,e)}function An(t,n){var e=t.dom();tn(n,function(r,o){po(e,o,r)})}function z(t,n){var e=t.dom().getAttribute(n);return e===null?void 0:e}function ct(t,n){var e=t.dom();return!(!e||!e.hasAttribute)&&e.hasAttribute(n)}function H(t,n){t.dom().removeAttribute(n)}function ho(t){return yt(t.dom().attributes,function(n,e){return n[e.name]=e.value,n},{})}function vo(t,n,e){return n===""||!(t.length<n.length)&&t.substr(e,e+n.length)===n}function $(t,n){return t.indexOf(n)!==-1}function bo(t,n){return vo(t,n,0)}function nn(t){return t.style!==void 0&&on(t.style.getPropertyValue)}function en(t){var n,e=!1;return function(){for(var r=[],o=0;o<arguments.length;o++)r[o]=arguments[o];return e||(e=!0,n=t.apply(null,r)),n}}function Qn(t){var n=Pt(t)?t.dom().parentNode:t.dom();return n!=null&&n.ownerDocument.body.contains(n)}function wo(t,n,e){if(!Ft(e))throw O.console.error("Invalid call to CSS.set. Property ",n,":: Value ",e,":: Element ",t),new Error("CSS value must be a string: "+e);nn(t)&&t.style.setProperty(n,e)}function Y(t,n,e){var r=t.dom();wo(r,n,e)}function En(t,n){var e=t.dom();tn(n,function(r,o){wo(e,o,r)})}function St(t,n){var e=t.dom(),r=O.window.getComputedStyle(e).getPropertyValue(n),o=r!==""||Qn(t)?r:Do(e,n);return o===null?void 0:o}function xt(t,n){var e=t.dom(),r=Do(e,n);return s.from(r).filter(function(o){return 0<o.length})}function Ht(t,n){(function(e,r){nn(e)&&e.style.removeProperty(r)})(t.dom(),n),ct(t,"style")&&function(e){return e.replace(/^\s+|\s+$/g,"")}(z(t,"style"))===""&&H(t,"style")}function xc(t,n,e){return(t.compareDocumentPosition(n)&e)!=0}function Rc(t,n){var e=function(o,i){for(var u=0;u<o.length;u++){var c=o[u];if(c.test(i))return c}}(t,n);if(!e)return{major:0,minor:0};function r(o){return Number(n.replace(e,"$"+o))}return qe(r(1),r(2))}function rn(t,n){return function(){return n===t}}function Bt(t,n){return function(){return n===t}}function yo(t,n){var e=String(n).toLowerCase();return Ct(t,function(r){return r.search(e)})}function Rt(t){return function(n){return $(n,t)}}function Nn(){return Yc.get()}function at(t,n){var e=t.dom();if(e.nodeType!==zo)return!1;var r=e;if(r.matches!==void 0)return r.matches(n);if(r.msMatchesSelector!==void 0)return r.msMatchesSelector(n);if(r.webkitMatchesSelector!==void 0)return r.webkitMatchesSelector(n);if(r.mozMatchesSelector!==void 0)return r.mozMatchesSelector(n);throw new Error("Browser lacks native selectors")}function Co(t){return t.nodeType!==zo&&t.nodeType!==Kc||t.childElementCount===0}function Le(t){return v.fromDom(t.dom().ownerDocument)}function lt(t){return s.from(t.dom().parentNode).map(v.fromDom)}function So(t,n){for(var e=on(n)?n:rt,r=t.dom(),o=[];r.parentNode!==null&&r.parentNode!==void 0;){var i=r.parentNode,u=v.fromDom(i);if(o.push(u),e(u)===!0)break;r=i}return o}function xo(t){return s.from(t.dom().previousSibling).map(v.fromDom)}function Zn(t){return s.from(t.dom().nextSibling).map(v.fromDom)}function V(t){return C(t.dom().childNodes,v.fromDom)}function je(t,n){var e=t.dom().childNodes;return s.from(e[n]).map(v.fromDom)}function te(t,n){lt(t).each(function(e){e.dom().insertBefore(n.dom(),t.dom())})}function ze(t,n){Zn(t).fold(function(){lt(t).each(function(e){j(e,n)})},function(e){te(e,n)})}function Ro(t,n){(function(e){return je(e,0)})(t).fold(function(){j(t,n)},function(e){t.dom().insertBefore(n.dom(),e.dom())})}function Tc(t,n){te(t,n),j(n,t)}function Oc(t,n){x(n,function(e,r){var o=r===0?t:n[r-1];ze(o,e)})}function kn(t,n){x(n,function(e){j(t,e)})}function He(t){t.dom().textContent="",x(V(t),function(n){it(n)})}function Dc(t){var n=V(t);0<n.length&&function(e,r){x(r,function(o){te(e,o)})}(t,n),it(t)}function In(t,n,e){return function(r,o,i){return ot(So(r,i),o)}(t,function(r){return at(r,n)},e)}function Ac(t,n){return function(e,r){return ot(V(e),r)}(t,function(e){return at(e,n)})}function nt(t,n){return function(e,r){var o=r===void 0?O.document:r.dom();return Co(o)?[]:C(o.querySelectorAll(e),v.fromDom)}(n,t)}var Fe=function(t){function n(){return o}function e(i){return i(t)}var r=h(t),o={fold:function(i,u){return u(t)},is:function(i){return t===i},isSome:G,isNone:rt,getOr:r,getOrThunk:r,getOrDie:r,getOrNull:r,getOrUndefined:r,or:n,orThunk:n,map:function(i){return Fe(i(t))},each:function(i){i(t)},bind:e,exists:e,forall:e,filter:function(i){return i(t)?o:Me},toArray:function(){return[t]},toString:function(){return"some("+t+")"},equals:function(i){return i.is(t)},equals_:function(i,u){return i.fold(rt,function(c){return u(t,c)})}};return o},s={some:Fe,none:Jn,from:function(t){return t==null?Me:Fe(t)}},Ec=tinymce.util.Tools.resolve("tinymce.PluginManager"),Ft=xn("string"),ne=xn("array"),Nc=xn("boolean"),on=xn("function"),To=xn("number"),kc=Array.prototype.slice,Ic=Array.prototype.indexOf,Bc=Array.prototype.push,un=(on(Array.from)&&Array.from,Object.keys),Pc=Object.hasOwnProperty,Mc=function(t,n){var e={};return tn(t,function(r,o){var i=n(r,o);e[i.k]=i.v}),e},Wc=function(t,n){return Pc.call(t,n)},Ue=function(t,n){var e=t.concat(n);if(e.length===0)throw new Error("You must specify at least one required or optional field.");return _e("required",t),_e("optional",n),so(e),function(r){var o=un(r);On(t,function(c){return X(o,c)})||lo(t,o);var i=ot(o,function(c){return!X(e,c)});0<i.length&&fo(i);var u={};return x(t,function(c){u[c]=h(r[c])}),x(n,function(c){u[c]=h(Object.prototype.hasOwnProperty.call(r,c)?s.some(r[c]):s.none())}),u}},_c=(O.Node.ATTRIBUTE_NODE,O.Node.CDATA_SECTION_NODE,O.Node.COMMENT_NODE),Lc=O.Node.DOCUMENT_NODE,Oo=(O.Node.DOCUMENT_TYPE_NODE,O.Node.DOCUMENT_FRAGMENT_NODE,O.Node.ELEMENT_NODE),jc=O.Node.TEXT_NODE,I=(O.Node.PROCESSING_INSTRUCTION_NODE,O.Node.ENTITY_REFERENCE_NODE,O.Node.ENTITY_NODE,O.Node.NOTATION_NODE,typeof O.window!="undefined"?O.window:Function("return this;")(),function(t){return t.dom().nodeName.toLowerCase()}),cn=go(Oo),Pt=go(jc),Bn=function(t){if(t==null)throw new Error("Node cannot be null or undefined");return{dom:h(t)}},v={fromHtml:function(t,n){var e=(n||O.document).createElement("div");if(e.innerHTML=t,!e.hasChildNodes()||1<e.childNodes.length)throw O.console.error("HTML does not have a single root node",t),new Error("HTML must have a single root node");return Bn(e.childNodes[0])},fromTag:function(t,n){var e=(n||O.document).createElement(t);return Bn(e)},fromText:function(t,n){var e=(n||O.document).createTextNode(t);return Bn(e)},fromDom:Bn,fromPoint:function(t,n,e){var r=t.dom();return s.from(r.elementFromPoint(n,e)).map(Bn)}},zc=en(function(){return Hc(v.fromDom(O.document))}),Hc=function(t){var n=t.dom().body;if(n==null)throw new Error("Body is not available yet");return v.fromDom(n)},Do=function(t,n){return nn(t)?t.style.getPropertyValue(n):""},Fc=function(t,n){return xc(t,n,O.Node.DOCUMENT_POSITION_CONTAINED_BY)},k=function(){return(k=Object.assign||function(t){for(var n,e=1,r=arguments.length;e<r;e++)for(var o in n=arguments[e])Object.prototype.hasOwnProperty.call(n,o)&&(t[o]=n[o]);return t}).apply(this,arguments)},Ao=function(){return qe(0,0)},qe=function(t,n){return{major:t,minor:n}},ee={nu:qe,detect:function(t,n){var e=String(n).toLowerCase();return t.length===0?Ao():Rc(t,e)},unknown:Ao},Eo="Firefox",No=function(t){var n=t.current;return{current:n,version:t.version,isEdge:rn("Edge",n),isChrome:rn("Chrome",n),isIE:rn("IE",n),isOpera:rn("Opera",n),isFirefox:rn(Eo,n),isSafari:rn("Safari",n)}},ko={unknown:function(){return No({current:void 0,version:ee.unknown()})},nu:No,edge:h("Edge"),chrome:h("Chrome"),ie:h("IE"),opera:h("Opera"),firefox:h(Eo),safari:h("Safari")},Io="Windows",Bo="Android",Po="Solaris",Mo="FreeBSD",Wo="ChromeOS",_o=function(t){var n=t.current;return{current:n,version:t.version,isWindows:Bt(Io,n),isiOS:Bt("iOS",n),isAndroid:Bt(Bo,n),isOSX:Bt("OSX",n),isLinux:Bt("Linux",n),isSolaris:Bt(Po,n),isFreeBSD:Bt(Mo,n),isChromeOS:Bt(Wo,n)}},Lo={unknown:function(){return _o({current:void 0,version:ee.unknown()})},nu:_o,windows:h(Io),ios:h("iOS"),android:h(Bo),linux:h("Linux"),osx:h("OSX"),solaris:h(Po),freebsd:h(Mo),chromeos:h(Wo)},Uc=function(t,n){return yo(t,n).map(function(e){var r=ee.detect(e.versionRegexes,n);return{current:e.name,version:r}})},qc=function(t,n){return yo(t,n).map(function(e){var r=ee.detect(e.versionRegexes,n);return{current:e.name,version:r}})},Ve=/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,Vc=[{name:"Edge",versionRegexes:[/.*?edge\/ ?([0-9]+)\.([0-9]+)$/],search:function(t){return $(t,"edge/")&&$(t,"chrome")&&$(t,"safari")&&$(t,"applewebkit")}},{name:"Chrome",versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/,Ve],search:function(t){return $(t,"chrome")&&!$(t,"chromeframe")}},{name:"IE",versionRegexes:[/.*?msie\ ?([0-9]+)\.([0-9]+).*/,/.*?rv:([0-9]+)\.([0-9]+).*/],search:function(t){return $(t,"msie")||$(t,"trident")}},{name:"Opera",versionRegexes:[Ve,/.*?opera\/([0-9]+)\.([0-9]+).*/],search:Rt("opera")},{name:"Firefox",versionRegexes:[/.*?firefox\/\ ?([0-9]+)\.([0-9]+).*/],search:Rt("firefox")},{name:"Safari",versionRegexes:[Ve,/.*?cpu os ([0-9]+)_([0-9]+).*/],search:function(t){return($(t,"safari")||$(t,"mobile/"))&&$(t,"applewebkit")}}],Gc=[{name:"Windows",search:Rt("win"),versionRegexes:[/.*?windows\ nt\ ?([0-9]+)\.([0-9]+).*/]},{name:"iOS",search:function(t){return $(t,"iphone")||$(t,"ipad")},versionRegexes:[/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,/.*cpu os ([0-9]+)_([0-9]+).*/,/.*cpu iphone os ([0-9]+)_([0-9]+).*/]},{name:"Android",search:Rt("android"),versionRegexes:[/.*?android\ ?([0-9]+)\.([0-9]+).*/]},{name:"OSX",search:Rt("mac os x"),versionRegexes:[/.*?mac\ os\ x\ ?([0-9]+)_([0-9]+).*/]},{name:"Linux",search:Rt("linux"),versionRegexes:[]},{name:"Solaris",search:Rt("sunos"),versionRegexes:[]},{name:"FreeBSD",search:Rt("freebsd"),versionRegexes:[]},{name:"ChromeOS",search:Rt("cros"),versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/]}],jo={browsers:h(Vc),oses:h(Gc)},Yc=mt(function(t,n){var e=jo.browsers(),r=jo.oses(),o=Uc(e,t).fold(ko.unknown,ko.nu),i=qc(r,t).fold(Lo.unknown,Lo.nu);return{browser:o,os:i,deviceType:function(u,c,a,l){var f=u.isiOS()&&/ipad/i.test(a)===!0,d=u.isiOS()&&!f,g=u.isiOS()||u.isAndroid(),p=g||l("(pointer:coarse)"),m=f||!d&&g&&l("(min-device-width:768px)"),b=d||g&&!m,w=c.isSafari()&&u.isiOS()&&/safari/i.test(a)===!1,R=!b&&!m&&!w;return{isiPad:h(f),isiPhone:h(d),isTablet:h(m),isPhone:h(b),isTouch:h(p),isAndroid:u.isAndroid,isiOS:u.isiOS,isWebView:h(w),isDesktop:h(R)}}(i,o,t,n)}}(O.navigator.userAgent,function(t){return O.window.matchMedia(t).matches})),zo=Oo,Kc=Lc,A=function(t,n){return t.dom()===n.dom()},Ge=Nn().browser.isIE()?function(t,n){return Fc(t.dom(),n.dom())}:function(t,n){var e=t.dom(),r=n.dom();return e!==r&&e.contains(r)},Xc=at,j=(D("element","offset"),function(t,n){t.dom().appendChild(n.dom())}),it=function(t){var n=t.dom();n.parentNode!==null&&n.parentNode.removeChild(n)},Ho=(D("width","height"),D("width","height"),D("rows","columns")),$c=D("row","column"),Fo=(D("x","y"),D("element","rowspan","colspan")),Jc=D("element","rowspan","colspan","isNew"),Qc=D("element","rowspan","colspan","row","column"),Ye=D("element","cells","section"),J=D("element","isNew"),Zc=D("element","cells","section","isNew"),re=D("cells","section"),ta=D("details","section"),na=D("startRow","startCol","finishRow","finishCol"),Uo=function(t,n){var e=[];return x(V(t),function(r){n(r)&&(e=e.concat([r])),e=e.concat(Uo(r,n))}),e};function qo(t,n,e,r,o){return t(e,r)?s.some(e):on(o)&&o(e)?s.none():n(e,r,o)}function Pn(t,n,e){for(var r=t.dom(),o=on(e)?e:h(!1);r.parentNode;){r=r.parentNode;var i=v.fromDom(r);if(n(i))return s.some(i);if(o(i))break}return s.none()}function Ut(t,n,e){return Pn(t,function(r){return at(r,n)},e)}function Vo(t,n){return function(e,r){return Ct(e.dom().childNodes,function(o){return r(v.fromDom(o))}).map(v.fromDom)}(t,function(e){return at(e,n)})}function qt(t,n){return function(e,r){var o=r===void 0?O.document:r.dom();return Co(o)?s.none():s.from(o.querySelector(e)).map(v.fromDom)}(n,t)}function F(t,n,e){return qo(at,Ut,t,n,e)}function Ke(t,n,e){return e===void 0&&(e=rt),e(n)?s.none():X(t,I(n))?s.some(n):Ut(n,t.join(","),function(r){return at(r,"table")||e(r)})}function Go(t,n){return lt(n).map(function(e){return Ac(e,t)})}function Xe(t,n){return parseInt(z(t,n),10)}function $e(t,n){return t+","+n}var Je=function(t,n,e){return gt(V(t),function(r){return at(r,n)?e(r)?[r]:[]:Je(r,n,e)})},Mn={firstLayer:function(t,n){return Je(t,n,h(!0))},filterFirstLayer:Je},ea=N(Go,"th,td"),ra=N(Go,"tr"),M={cell:function(t,n){return Ke(["td","th"],t,n)},firstCell:function(t){return qt(t,"th,td")},cells:function(t){return Mn.firstLayer(t,"th,td")},neighbourCells:ea,table:function(t,n){return F(t,"table",n)},row:function(t,n){return Ke(["tr"],t,n)},rows:function(t){return Mn.firstLayer(t,"tr")},notCell:function(t,n){return Ke(["caption","tr","tbody","tfoot","thead"],t,n)},neighbourRows:ra,attr:Xe,grid:function(t,n,e){var r=Xe(t,n),o=Xe(t,e);return Ho(r,o)}},Tt=function(t){var n=M.rows(t);return C(n,function(e){var r=e,o=lt(r).map(function(u){var c=I(u);return c==="tfoot"||c==="thead"||c==="tbody"?c:"tbody"}).getOr("tbody"),i=C(M.cells(e),function(u){var c=ct(u,"rowspan")?parseInt(z(u,"rowspan"),10):1,a=ct(u,"colspan")?parseInt(z(u,"colspan"),10):1;return Fo(u,c,a)});return Ye(r,i,o)})},oa=function(t,n){return C(t,function(e){var r=C(M.cells(e),function(o){var i=ct(o,"rowspan")?parseInt(z(o,"rowspan"),10):1,u=ct(o,"colspan")?parseInt(z(o,"colspan"),10):1;return Fo(o,i,u)});return Ye(e,r,n.section())})},Yo=function(t,n){var e=gt(t.all(),function(r){return r.cells()});return ot(e,n)},B={generate:function(t){var n={},e=[],r=t.length,o=0;x(t,function(u,c){var a=[];x(u.cells(),function(l){for(var f=0;n[$e(c,f)]!==void 0;)f++;for(var d=Qc(l.element(),l.rowspan(),l.colspan(),c,f),g=0;g<l.colspan();g++)for(var p=0;p<l.rowspan();p++){var m=f+g,b=$e(c+p,m);n[b]=d,o=Math.max(o,m+1)}a.push(d)}),e.push(Ye(u.element(),a,u.section()))});var i=Ho(r,o);return{grid:h(i),access:h(n),all:h(e)}},getAt:function(t,n,e){var r=t.access()[$e(n,e)];return r!==void 0?s.some(r):s.none()},findItem:function(t,n,e){var r=Yo(t,function(o){return e(n,o.element())});return 0<r.length?s.some(r[0]):s.none()},filterItems:Yo,justCells:function(t){var n=C(t.all(),function(e){return e.cells()});return We(n)}},ia=D("minRow","minCol","maxRow","maxCol"),ua=function(t,n){function e(a){return at(a.element(),n)}var r=Tt(t),o=B.generate(r),i=function(a,l){var f=a.grid().columns(),d=a.grid().rows(),g=f,p=0,m=0;return tn(a.access(),function(b){if(l(b)){var w=b.row(),R=w+b.rowspan()-1,E=b.column(),_=E+b.colspan()-1;w<d?d=w:p<R&&(p=R),E<g?g=E:m<_&&(m=_)}}),ia(d,g,p,m)}(o,e),u="th:not("+n+"),td:not("+n+")",c=Mn.filterFirstLayer(t,"th,td",function(a){return at(a,u)});return x(c,it),function(a,l,f,d){for(var g,p,m,b=l.grid().columns(),w=l.grid().rows(),R=0;R<w;R++)for(var E=!1,_=0;_<b;_++)R<f.minRow()||R>f.maxRow()||_<f.minCol()||_>f.maxCol()||(B.getAt(l,R,_).filter(d).isNone()?(g=E,p=a[R].element(),m=v.fromTag("td"),j(m,v.fromTag("br")),(g?j:Ro)(p,m)):E=!0)}(r,o,i,e),function(a,l){var f=ot(Mn.firstLayer(a,"tr"),function(d){return d.dom().childElementCount===0});x(f,it),l.minCol()!==l.maxCol()&&l.minRow()!==l.maxRow()||x(Mn.firstLayer(a,"th,td"),function(d){H(d,"rowspan"),H(d,"colspan")}),H(a,"width"),H(a,"height"),Ht(a,"width"),Ht(a,"height")}(t,i),t};function oe(t){return tr.get(t)}function Ko(t){return tr.getOption(t)}function ca(t,n){tr.set(t,n)}function Mt(t){return I(t)==="img"?1:Ko(t).fold(function(){return V(t).length},function(n){return n.length})}function Xo(t){return function(n){return Ko(n).filter(function(e){return e.trim().length!==0||-1<e.indexOf("\xA0")}).isSome()}(t)||X(da,I(t))}function ie(t){return function(n,e){var r=function(o){for(var i=0;i<o.childNodes.length;i++){var u=v.fromDom(o.childNodes[i]);if(e(u))return s.some(u);var c=r(o.childNodes[i]);if(c.isSome())return c}return s.none()};return r(n.dom())}(t,Xo)}function Qe(t){return ma(t,Xo)}function $o(t,n){return v.fromDom(t.dom().cloneNode(n))}function Jo(t){return $o(t,!1)}function ue(t){return $o(t,!0)}function aa(t,n){var e=function(o,i){var u=v.fromTag(i),c=ho(o);return An(u,c),u}(t,n),r=V(ue(t));return kn(e,r),e}function Ze(){var t=v.fromTag("td");return j(t,v.fromTag("br")),t}function la(t,n,e){var r=aa(t,n);return tn(e,function(o,i){o===null?H(r,i):tt(r,i,o)}),r}function fa(t){return t}function Qo(t){return function(){return v.fromTag("tr",t.dom())}}function sa(t,n){return n.column()>=t.startCol()&&n.column()+n.colspan()-1<=t.finishCol()&&n.row()>=t.startRow()&&n.row()+n.rowspan()-1<=t.finishRow()}function Zo(t,n,e){var r=B.findItem(t,n,A),o=B.findItem(t,e,A);return r.bind(function(i){return o.map(function(u){return function(c,a){return na(Math.min(c.row(),a.row()),Math.min(c.column(),a.column()),Math.max(c.row()+c.rowspan()-1,a.row()+a.rowspan()-1),Math.max(c.column()+c.colspan()-1,a.column()+a.colspan()-1))}(i,u)})})}var tr=function(n,e){var r=function(o){return n(o)?s.from(o.dom().nodeValue):s.none()};return{get:function(o){if(!n(o))throw new Error("Can only get "+e+" value of a "+e+" node");return r(o).getOr("")},getOption:r,set:function(o,i){if(!n(o))throw new Error("Can only set raw "+e+" value of a "+e+" node");o.dom().nodeValue=i}}}(Pt,"text"),da=["img","br"],ma=function(t,n){var e=function(r){for(var o=V(r),i=o.length-1;0<=i;i--){var u=o[i];if(n(u))return s.some(u);var c=e(u);if(c.isSome())return c}return s.none()};return e(t)},Wn={cellOperations:function(t,n,e){return{row:Qo(n),cell:function(r){var o=Le(r.element()),i=v.fromTag(I(r.element()),o.dom()),u=e.getOr(["strong","em","b","i","span","font","h1","h2","h3","h4","h5","h6","p","div"]),c=0<u.length?function(a,l,f){return ie(a).map(function(d){var g=f.join(","),p=In(d,g,function(m){return A(m,a)});return Tn(p,function(m,b){var w=Jo(b);return H(w,"contenteditable"),j(m,w),w},l)}).getOr(l)}(r.element(),i,u):i;return j(c,v.fromTag("br")),function(a,l){var f=a.dom(),d=l.dom();nn(f)&&nn(d)&&(d.style.cssText=f.style.cssText)}(r.element(),i),Ht(i,"height"),r.colspan()!==1&&Ht(r.element(),"width"),t(r.element(),i),i},replace:la,gap:Ze}},paste:function(t){return{row:Qo(t),cell:Ze,replace:fa,gap:Ze}}},ga=function(t,n){var e=n.column(),r=n.column()+n.colspan()-1,o=n.row(),i=n.row()+n.rowspan()-1;return e<=t.finishCol()&&r>=t.startCol()&&o<=t.finishRow()&&i>=t.startRow()},pa=function(t,n){for(var e=!0,r=N(sa,n),o=n.startRow();o<=n.finishRow();o++)for(var i=n.startCol();i<=n.finishCol();i++)e=e&&B.getAt(t,o,i).exists(r);return e?s.some(n):s.none()},ha=Zo,va=function(t,n,e){return Zo(t,n,e).bind(function(r){return pa(t,r)})},ba=function(t,n,e,r){return B.findItem(t,n,A).bind(function(o){var i=0<e?o.row()+o.rowspan()-1:o.row(),u=0<r?o.column()+o.colspan()-1:o.column();return B.getAt(t,i+e,u+r).map(function(c){return c.element()})})},ti=function(t,n,e){return ha(t,n,e).map(function(r){var o=B.filterItems(t,N(ga,r));return C(o,function(i){return i.element()})})},ni=function(t,n){return B.findItem(t,n,function(e,r){return Ge(r,e)}).map(function(e){return e.element()})},ce=function(t){var n=Tt(t);return B.generate(n)},wa=function(t,n,e){return M.table(t).bind(function(r){var o=ce(r);return ba(o,t,n,e)})},ya=function(t,n,e){var r=ce(t);return ti(r,n,e)},nr=function(t,n,e,r,o){var i=ce(t),u=A(t,e)?s.some(n):ni(i,n),c=A(t,o)?s.some(r):ni(i,r);return u.bind(function(a){return c.bind(function(l){return ti(i,a,l)})})},Ca=function(t,n,e){var r=ce(t);return va(r,n,e)},Sa=["body","p","div","article","aside","figcaption","figure","footer","header","nav","section","ol","ul","li","table","thead","tbody","tfoot","caption","tr","td","th","h1","h2","h3","h4","h5","h6","blockquote","pre","address"];function er(){return{up:h({selector:Ut,closest:F,predicate:Pn,all:So}),down:h({selector:nt,predicate:Uo}),styles:h({get:St,getRaw:xt,set:Y,remove:Ht}),attrs:h({get:z,set:tt,remove:H,copyTo:function(t,n){var e=ho(t);An(n,e)}}),insert:h({before:te,after:ze,afterAll:Oc,append:j,appendAll:kn,prepend:Ro,wrap:Tc}),remove:h({unwrap:Dc,remove:it}),create:h({nu:v.fromTag,clone:function(t){return v.fromDom(t.dom().cloneNode(!1))},text:v.fromText}),query:h({comparePosition:function(t,n){return t.dom().compareDocumentPosition(n.dom())},prevSibling:xo,nextSibling:Zn}),property:h({children:V,name:I,parent:lt,document:function(t){return t.dom().ownerDocument},isText:Pt,isComment:Sc,isElement:cn,getText:oe,setText:ca,isBoundary:function(t){return!!cn(t)&&(I(t)==="body"||X(Sa,I(t)))},isEmptyTag:function(t){return!!cn(t)&&X(["br","img","hr","input"],I(t))},isNonEditable:function(t){return cn(t)&&z(t,"contenteditable")==="false"}}),eq:A,is:Xc}}function ei(t,n,e){var r=t.property().children(n);return zt(r,N(t.eq,e)).map(function(o){return{before:h(r.slice(0,o)),after:h(r.slice(o+1))}})}function rr(t,n){return N(t.eq,n)}function ri(t,n,e,r){function o(f){return zt(f,r).fold(function(){return f},function(d){return f.slice(0,d+1)})}r===void 0&&(r=rt);var i=[n].concat(t.up().all(n)),u=[e].concat(t.up().all(e)),c=o(i),a=o(u),l=Ct(c,function(f){return Rn(a,rr(t,f))});return{firstpath:h(c),secondpath:h(a),shared:h(l)}}function or(t){return Ut(t,"table")}function oi(t,n,e){function r(o){return function(i){return e!==void 0&&e(i)||A(i,o)}}return A(t,n)?s.some(_n.create({boxes:s.some([t]),start:t,finish:n})):or(t).bind(function(o){return or(n).bind(function(i){if(A(o,i))return s.some(_n.create({boxes:ya(o,t,n),start:t,finish:n}));if(Ge(o,i)){var u=0<(c=In(n,"td,th",r(o))).length?c[c.length-1]:n;return s.some(_n.create({boxes:nr(o,t,o,n,i),start:t,finish:u}))}if(Ge(i,o)){var c,a=0<(c=In(t,"td,th",r(i))).length?c[c.length-1]:t;return s.some(_n.create({boxes:nr(i,t,o,n,i),start:t,finish:a}))}return ae.ancestors(t,n).shared().bind(function(l){return F(l,"table",e).bind(function(f){var d=In(n,"td,th",r(f)),g=0<d.length?d[d.length-1]:n,p=In(t,"td,th",r(f)),m=0<p.length?p[p.length-1]:t;return s.some(_n.create({boxes:nr(f,t,o,n,i),start:m,finish:g}))})})})})}function ii(t,n){return fn.cata(n.get(),h([]),dt,h([t]))}function ui(t){return{element:h(t),mergable:s.none,unmergable:s.none,selection:h([t])}}var ci=D("left","right"),ai=D("first","second","splits"),xa=function(t,n,e,r){var o=n(t,e);return Tn(r,function(i,u){var c=n(t,u);return Ra(t,i,c)},o)},Ra=function(t,n,e){return n.bind(function(r){return e.filter(N(t.eq,r))})},an={sharedOne:function(t,n,e){return 0<e.length?function(r,o,i,u){return u(r,o,i[0],i.slice(1))}(t,n,e,xa):s.none()},subset:function(t,n,e){var r=ri(t,n,e);return r.shared().bind(function(o){return function(i,u,c,a){var l=i.property().children(u);if(i.eq(u,c[0]))return s.some([c[0]]);if(i.eq(u,a[0]))return s.some([a[0]]);function f(p){var m=co(p),b=zt(m,rr(i,u)).getOr(-1),w=b<m.length-1?m[b+1]:m[b];return zt(l,rr(i,w))}var d=f(c),g=f(a);return d.bind(function(p){return g.map(function(m){var b=Math.min(p,m),w=Math.max(p,m);return l.slice(b,w+1)})})}(t,o,r.firstpath(),r.secondpath())})},ancestors:ri,breakToLeft:function(t,n,e){return ei(t,n,e).map(function(r){var o=t.create().clone(n);return t.insert().appendAll(o,r.before().concat([e])),t.insert().appendAll(n,r.after()),t.insert().before(n,o),ci(o,n)})},breakToRight:function(t,n,e){return ei(t,n,e).map(function(r){var o=t.create().clone(n);return t.insert().appendAll(o,r.after()),t.insert().after(n,o),ci(n,o)})},breakPath:function(t,n,e,r){var o=function(i,u,c){var a=ai(i,s.none(),c);return e(i)?ai(i,u,c):t.property().parent(i).bind(function(l){return r(t,l,i).map(function(f){var d=[{first:f.left,second:f.right}],g=e(l)?l:f.left();return o(g,s.some(f.right()),c.concat(d))})}).getOr(a)};return o(n,s.none(),[])}},ln=er(),ae={sharedOne:function(t,n){return an.sharedOne(ln,function(e,r){return t(r)},n)},subset:function(t,n){return an.subset(ln,t,n)},ancestors:function(t,n,e){return an.ancestors(ln,t,n,e)},breakToLeft:function(t,n){return an.breakToLeft(ln,t,n)},breakToRight:function(t,n){return an.breakToRight(ln,t,n)},breakPath:function(t,n,e){return an.breakPath(ln,t,n,function(r,o,i){return e(o,i)})}},_n={create:Ue(["boxes","start","finish"],[])},ir=oi,ur=function(t,n){var e=nt(t,n);return 0<e.length?s.some(e):s.none()},Ta=function(t,n,e,r,o){return function(i,u){return Ct(i,function(c){return at(c,u)})}(t,o).bind(function(i){return wa(i,n,e).bind(function(u){return function(c,a){return Ut(c,"table").bind(function(l){return qt(l,a).bind(function(f){return oi(f,c).bind(function(d){return d.boxes().map(function(g){return{boxes:h(g),start:h(d.start()),finish:h(d.finish())}})})})})}(u,r)})})},li=function(t,n,e){return qt(t,n).bind(function(r){return qt(t,e).bind(function(o){return ae.sharedOne(or,[r,o]).map(function(i){return{first:h(r),last:h(o),table:h(i)}})})})},Oa=function(t,n){return ur(t,n)},Da=function(t,n,e){return li(t,n,e).bind(function(r){function o(c){return A(t,c)}var i=Ut(r.first(),"thead,tfoot,tbody,table",o),u=Ut(r.last(),"thead,tfoot,tbody,table",o);return i.bind(function(c){return u.bind(function(a){return A(c,a)?Ca(r.table(),r.first(),r.last()):s.none()})})})},Aa="data-mce-selected",Ea="data-mce-first-selected",Na="data-mce-last-selected",Vt={selected:h(Aa),selectedSelector:h("td[data-mce-selected],th[data-mce-selected]"),attributeSelector:h("[data-mce-selected]"),firstSelected:h(Ea),firstSelectedSelector:h("td[data-mce-first-selected],th[data-mce-first-selected]"),lastSelected:h(Na),lastSelectedSelector:h("td[data-mce-last-selected],th[data-mce-last-selected]")},Wt=function(t){if(!ne(t))throw new Error("cases must be an array");if(t.length===0)throw new Error("there must be at least one case");var n=[],e={};return x(t,function(r,o){var i=un(r);if(i.length!==1)throw new Error("one and only one name per case");var u=i[0],c=r[u];if(e[u]!==void 0)throw new Error("duplicate key detected:"+u);if(u==="cata")throw new Error("cannot have a case named cata (sorry)");if(!ne(c))throw new Error("case arguments must be an array");n.push(u),e[u]=function(){var a=arguments.length;if(a!==c.length)throw new Error("Wrong number of arguments to case "+u+". Expected "+c.length+" ("+c+"), got "+a);for(var l=new Array(a),f=0;f<l.length;f++)l[f]=arguments[f];return{fold:function(){if(arguments.length!==t.length)throw new Error("Wrong number of arguments to fold. Expected "+t.length+", got "+arguments.length);return arguments[o].apply(null,l)},match:function(d){var g=un(d);if(n.length!==g.length)throw new Error("Wrong number of arguments to match. Expected: "+n.join(",")+`
Actual: `+g.join(","));if(!On(n,function(p){return X(g,p)}))throw new Error("Not all branches were specified when using match. Specified: "+g.join(", ")+`
Required: `+n.join(", "));return d[u].apply(null,l)},log:function(d){O.console.log(d,{constructors:n,constructor:u,params:l})}}}}),e},cr=Wt([{none:[]},{multiple:["elements"]},{single:["selection"]}]),fn={cata:function(t,n,e,r){return t.fold(n,e,r)},none:cr.none,multiple:cr.multiple,single:cr.single},ka=function(t,n){return fn.cata(n.get(),s.none,function(e,r){return e.length===0?s.none():Da(t,Vt.firstSelectedSelector(),Vt.lastSelectedSelector()).bind(function(o){return 1<e.length?s.some({bounds:h(o),cells:h(e)}):s.none()})},s.none)},Ia=function(t,n){var e=ii(t,n);return 0<e.length&&On(e,function(r){return ct(r,"rowspan")&&1<parseInt(z(r,"rowspan"),10)||ct(r,"colspan")&&1<parseInt(z(r,"colspan"),10)})?s.some(e):s.none()},fi=ii,Ba=D("element","clipboard","generators"),Gt={noMenu:ui,forMenu:function(t,n,e){return{element:h(e),mergable:h(ka(n,t)),unmergable:h(Ia(e,t)),selection:h(fi(e,t))}},notCell:function(t){return ui(t)},paste:Ba,pasteRows:function(t,n,e,r,o){return{element:h(e),mergable:s.none,unmergable:s.none,selection:h(fi(e,t)),clipboard:h(r),generators:h(o)}}},Pa={registerEvents:function(t,n,e,r){t.on("BeforeGetContent",function(o){o.selection===!0&&fn.cata(n.get(),y,function(i){o.preventDefault(),function(u){return M.table(u[0]).map(ue).map(function(c){return[ua(c,Vt.attributeSelector())]})}(i).each(function(u){o.content=o.format==="text"?function(c){return C(c,function(a){return a.dom().innerText}).join("")}(u):function(c,a){return C(a,function(l){return c.selection.serializer.serialize(l.dom(),{})}).join("")}(t,u)})},y)}),t.on("BeforeSetContent",function(o){o.selection===!0&&o.paste===!0&&s.from(t.dom.getParent(t.selection.getStart(),"th,td")).each(function(i){var u=v.fromDom(i);M.table(u).each(function(c){var a=ot(function(g,p){var m=(p||O.document).createElement("div");return m.innerHTML=g,V(v.fromDom(m))}(o.content),function(g){return I(g)!=="meta"});if(a.length===1&&I(a[0])==="table"){o.preventDefault();var l=v.fromDom(t.getDoc()),f=Wn.paste(l),d=Gt.paste(u,a[0],f);e.pasteCells(c,d).each(function(g){t.selection.setRng(g),t.focus(),r.clear(c)})}})})})}};function si(t,n){function e(o){var i=n(o);if(i<=0||i===null){var u=St(o,t);return parseFloat(u)||0}return i}function r(o,i){return yt(i,function(u,c){var a=St(o,c),l=a===void 0?0:parseInt(a,10);return isNaN(l)?u:u+l},0)}return{set:function(o,i){if(!To(i)&&!i.match(/^[0-9]+$/))throw new Error(t+".set accepts only positive integer values. Value was "+i);var u=o.dom();nn(u)&&(u.style[t]=i+"px")},get:e,getOuter:e,aggregate:r,max:function(o,i,u){var c=r(o,u);return c<i?i-c:0}}}function ar(t){return yi.get(t)}function di(t){return yi.getOuter(t)}function Yt(t){return Ci.get(t)}function mi(t){return Ci.getOuter(t)}function Ln(t,n,e){return function(r,o){var i=parseFloat(r);return isNaN(i)?o:i}(St(t,n),e)}function gi(t,n){Y(t,"height",n+"px")}function Ma(t,n,e,r){var o=parseInt(t,10);return function(i,u){return vo(i,u,i.length-u.length)}(t,"%")&&I(n)!=="table"?function(i,u,c,a){var l=M.table(i).map(function(f){var d=c(f);return Math.floor(u/100*d)}).getOr(u);return a(i,l),l}(n,o,e,r):o}function Wa(t){var n=function(e){return xt(e,"height").getOrThunk(function(){return ja(e)+"px"})}(t);return n?Ma(n,t,ar,gi):ar(t)}function le(t){return xt(t,"width").fold(function(){return s.from(z(t,"width"))},function(n){return s.some(n)})}function pi(t,n){return t/n.pixelWidth()*100}function fe(t,n){return t!==void 0?t:n!==void 0?n:0}function se(t){var n=t.dom().ownerDocument,e=n.body,r=n.defaultView,o=n.documentElement;if(e===t.dom())return Ot(e.offsetLeft,e.offsetTop);var i=fe(r.pageYOffset,o.scrollTop),u=fe(r.pageXOffset,o.scrollLeft),c=fe(o.clientTop,e.clientTop),a=fe(o.clientLeft,e.clientLeft);return Fa(t).translate(u-a,i-c)}function hi(t){return se(t).left()+mi(t)}function vi(t){return se(t).left()}function bi(t,n){return Di(t,vi(n))}function wi(t,n){return Di(t,hi(n))}function lr(t){return se(t).top()}function _a(t,n){return Oi(t,lr(n))}function La(t,n){return Oi(t,lr(n)+di(n))}function fr(t,n,e){if(e.length===0)return[];var r=C(e.slice(1),function(i,u){return i.map(function(c){return t(u,c)})}),o=e[e.length-1].map(function(i){return n(e.length-1,i)});return r.concat([o])}var yi=si("height",function(t){var n=t.dom();return Qn(t)?n.getBoundingClientRect().height:n.offsetHeight}),Ci=si("width",function(t){return t.dom().offsetWidth}),Si=Nn(),ja=function(t){return Si.browser.isIE()||Si.browser.isEdge()?function(n){var e=Ln(n,"padding-top",0),r=Ln(n,"padding-bottom",0),o=Ln(n,"border-top-width",0),i=Ln(n,"border-bottom-width",0),u=n.dom().getBoundingClientRect().height;return St(n,"box-sizing")==="border-box"?u:u-e-r-(o+i)}(t):Ln(t,"height",ar(t))},za=/(\d+(\.\d+)?)(\w|%)*/,sr=/(\d+(\.\d+)?)%/,xi=/(\d+(\.\d+)?)px|em/,Ha=function(t,n){return ct(t,n)?parseInt(z(t,n),10):1},U={percentageBasedSizeRegex:h(sr),pixelBasedSizeRegex:h(xi),setPixelWidth:function(t,n){Y(t,"width",n+"px")},setPercentageWidth:function(t,n){Y(t,"width",n+"%")},setHeight:gi,getPixelWidth:function(t,n){return le(t).fold(function(){return Yt(t)},function(e){return function(r,o,i){var u=xi.exec(o);if(u!==null)return parseInt(u[1],10);var c=sr.exec(o);return c===null?Yt(r):function(a,l){return a/100*l.pixelWidth()}(parseFloat(c[1]),i)}(t,e,n)})},getPercentageWidth:function(t,n){return le(t).fold(function(){var e=Yt(t);return pi(e,n)},function(e){return function(r,o,i){var u=sr.exec(o);if(u!==null)return parseFloat(u[1]);var c=Yt(r);return pi(c,i)}(t,e,n)})},getGenericWidth:function(t){return le(t).bind(function(n){var e=za.exec(n);return e!==null?s.some({width:h(parseFloat(e[1])),unit:h(e[3])}):s.none()})},setGenericWidth:function(t,n,e){Y(t,"width",n+e)},getHeight:function(t){return function(n,e,r){return r(n)/Ha(n,e)}(t,"rowspan",Wa)},getRawWidth:le},Ri=function(t,n){U.getGenericWidth(t).each(function(e){var r=e.width()/2;U.setGenericWidth(t,r,e.unit()),U.setGenericWidth(n,r,e.unit())})},Ti=function(t,n){return{left:h(t),top:h(n),translate:function(e,r){return Ti(t+e,n+r)}}},Ot=Ti,Fa=function(t){var n=t.dom(),e=n.ownerDocument.body;return e===n?Ot(e.offsetLeft,e.offsetTop):Qn(t)?function(r){var o=r.getBoundingClientRect();return Ot(o.left,o.top)}(n):Ot(0,0)},Oi=D("row","y"),Di=D("col","x"),de={height:{delta:dt,positions:function(t){return fr(_a,La,t)},edge:lr},rtl:{delta:function(t){return-t},edge:hi,positions:function(t){return fr(wi,bi,t)}},ltr:{delta:dt,edge:vi,positions:function(t){return fr(bi,wi,t)}}},Ai={ltr:de.ltr,rtl:de.rtl};function Ei(t){function n(e){return t(e).isRtl()?Ai.rtl:Ai.ltr}return{delta:function(e,r){return n(r).delta(e,r)},edge:function(e){return n(e).edge(e)},positions:function(e,r){return n(r).positions(e,r)}}}function Ni(t){for(var n=[],e=function(o){n.push(o)},r=0;r<t.length;r++)t[r].each(e);return n}function me(t,n,e,r){e===r?H(t,n):tt(t,n,e)}function dr(t,n){var e=z(t,n);return e===void 0||e===""?[]:e.split(" ")}function ge(t){return t.dom().classList!==void 0}function Ua(t,n){return function(e,r,o){var i=dr(e,r).concat([o]);return tt(e,r,i.join(" ")),!0}(t,"class",n)}function qa(t,n){return function(e,r,o){var i=ot(dr(e,r),function(u){return u!==o});return 0<i.length?tt(e,r,i.join(" ")):H(e,r),!1}(t,"class",n)}function Dt(t,n){ge(t)?t.dom().classList.add(n):Ua(t,n)}function Va(t){(ge(t)?t.dom().classList:function(n){return dr(n,"class")}(t)).length===0&&H(t,"class")}function mr(t,n){return ge(t)&&t.dom().classList.contains(n)}function jn(t,n){for(var e=[],r=t;r<n;r++)e.push(r);return e}function ki(t,n){if(n<0||n>=t.length-1)return s.none();var e=t[n].fold(function(){var o=co(t.slice(0,n));return Zt(o,function(i,u){return i.map(function(c){return{value:c,delta:u+1}})})},function(o){return s.some({value:o,delta:0})}),r=t[n+1].fold(function(){var o=t.slice(n+1);return Zt(o,function(i,u){return i.map(function(c){return{value:c,delta:u+1}})})},function(o){return s.some({value:o,delta:1})});return e.bind(function(o){return r.map(function(i){var u=i.delta+o.delta;return Math.abs(i.value-o.value)/u})})}function Ii(t){var n=t.replace(/\./g,"-");return{resolve:function(e){return n+"-"+e}}}function Bi(t){var n=nt(t.parent(),"."+Rr);x(n,it)}function Pi(t,n,e){var r=t.origin();x(n,function(o,i){o.each(function(u){var c=e(r,u);Dt(c,Rr),j(t.parent(),c)})})}function Ga(t,n,e,r,o,i){var u=se(n);(function(c,a,l,f){Pi(c,a,function(d,g){var p=pl(g.row(),l.left()-d.left(),g.y()-d.top(),f,7);return Dt(p,du),p})})(t,0<e.length?o.positions(e,n):[],u,mi(n)),function(c,a,l,f){Pi(c,a,function(d,g){var p=gl(g.col(),g.x()-d.left(),l.top()-d.top(),7,f);return Dt(p,mu),p})}(t,0<r.length?i.positions(r,n):[],u,di(n))}function Mi(t,n){var e=nt(t.parent(),"."+Rr);x(e,n)}function Wi(t,n){return t.cells()[n]}function _i(t,n){if(t.length===0)return 0;var e=t[0];return zt(t,function(r){return!n(e.element(),r.element())}).fold(function(){return t.length},function(r){return r})}function Ya(t,n){return C(t,function(e){var r=function(o){return Zt(o,function(i){return lt(i.element()).map(function(u){var c=lt(u).isNone();return J(u,c)})}).getOrThunk(function(){return J(n.row(),!0)})}(e.details());return Zc(r.element(),e.details(),e.section(),r.isNew())})}function pe(t,n){var e=Cl(t,A);return Ya(e,n)}function he(t,n){var e=We(C(t.all(),function(r){return r.cells()}));return Ct(e,function(r){return A(n,r.element())})}function W(t,n,e,r,o){return function(i,u,c,a,l){var f=Tt(u),d=B.generate(f);return n(d,c).map(function(g){var p=function(w,R){return Fn(w,R,!1)}(d,a),m=t(p,g,A,o(a)),b=pe(m.grid(),a);return{grid:h(b),cursor:m.cursor}}).fold(function(){return s.none()},function(g){var p=dl(u,g.grid());return e(u,g.grid(),l),r(u),ye(i,u,de.height,l),s.some({cursor:g.cursor,newRows:p.newRows,newCells:p.newCells})})}}function pt(t,n){return M.cell(n.element()).bind(function(e){return he(t,e)})}function Li(t,n){var e=C(n.selection(),function(o){return M.cell(o).bind(function(i){return he(t,i)})}),r=Ni(e);return 0<r.length?s.some({cells:r,generators:n.generators,clipboard:n.clipboard}):s.none()}function _t(t,n){var e=C(n.selection(),function(o){return M.cell(o).bind(function(i){return he(t,i)})}),r=Ni(e);return 0<r.length?s.some(r):s.none()}function ji(t,n){return C(t,function(){return J(n.cell(),!0)})}function Ka(t,n,e){return t.concat(function(r,o){for(var i=[],u=0;u<r;u++)i.push(o(u));return i}(n,function(r){return S.setCells(t[t.length-1],ji(t[t.length-1].cells(),e))}))}function Xa(t,n,e){return C(t,function(r){return S.setCells(r,r.cells().concat(ji(jn(0,n),e)))})}function zi(t,n,e,r){return C(t,function(o){return S.mapCells(o,function(i){return function(u){return Rn(n,function(c){return e(u.element(),c.element())})}(i)?J(r(i.element(),e),!0):i})})}function Hi(t,n,e,r){return S.getCellElement(t[n],e)!==void 0&&0<n&&r(S.getCellElement(t[n-1],e),S.getCellElement(t[n],e))}function Fi(t,n,e){return 0<n&&e(S.getCellElement(t,n-1),S.getCellElement(t,n))}function Ui(t,n){return ct(t,n)&&1<parseInt(z(t,n),10)}function qi(t,n,e){return xt(t,n).fold(function(){return e(t)+"px"},function(r){return r})}function $a(t,n){return qi(t,"width",function(e){return U.getPixelWidth(e,n)})}function Ja(t){return qi(t,"height",U.getHeight)}function gr(t,n,e,r,o){var i=fu(t),u=C(i,function(c){return c.map(n.edge)});return C(i,function(c,a){return c.filter(Be(vt.hasColspan)).fold(function(){var l=ki(u,a);return r(l)},function(l){return e(l,o)})})}function Vi(t){return t.map(function(n){return n+"px"}).getOr("")}function Gi(t,n,e,r){var o=su(t),i=C(o,function(u){return u.map(n.edge)});return C(o,function(u,c){return u.filter(Be(vt.hasRowspan)).fold(function(){var a=ki(i,c);return r(a)},function(a){return e(a)})})}function Yi(t,n,e){for(var r=0,o=t;o<n;o++)r+=e[o]!==void 0?e[o]:0;return r}function pr(t){var n=dt;return{width:h(t),pixelWidth:h(t),getWidths:Or.getPixelWidths,getCellDelta:n,singleColumnWidth:function(e,r){return[Math.max(vt.minWidth(),e+r)-e]},minCellWidth:vt.minWidth,setElementWidth:U.setPixelWidth,setTableWidth:function(e,r,o){var i=Tn(r,function(u,c){return u+c},0);U.setPixelWidth(e,i)}}}function Qa(t,n){var e=U.percentageBasedSizeRegex().exec(n);if(e!==null)return function(u,c){var a=parseFloat(u),l=Yt(c);return{width:h(a),pixelWidth:h(l),getWidths:Or.getPercentageWidths,getCellDelta:function(f){return f/l*100},singleColumnWidth:function(f,d){return[100-f]},minCellWidth:function(){return vt.minWidth()/l*100},setElementWidth:U.setPercentageWidth,setTableWidth:function(f,d,g){var p=g/100*a;U.setPercentageWidth(f,a+p)}}}(e[1],t);var r=U.pixelBasedSizeRegex().exec(n);if(r!==null){var o=parseInt(r[1],10);return pr(o)}var i=Yt(t);return pr(i)}function Ki(t){return B.generate(t)}function Xi(t){var n=Tt(t);return Ki(n)}function Za(t,n){var e=ot(n,function(r){return!X(t,r)});0<e.length&&fo(e)}function ve(t){return function(n,e){return _l(n,e,{validate:on,label:"function"})}(Za,t)}function tl(t){var n=ct(t,"colspan")?parseInt(z(t,"colspan"),10):1,e=ct(t,"rowspan")?parseInt(z(t,"rowspan"),10):1;return{element:h(t),colspan:h(n),rowspan:h(e)}}function nl(t,n){var e=t.property().name(n);return X(Ll,e)}function el(t,n){return X(["br","img","hr","input"],t.property().name(n))}function $i(t){M.cells(t).length===0&&it(t)}function zn(t,n,e){return Nr(t,n,e).orThunk(function(){return Nr(t,0,0)})}function Q(t,n,e){return At(t,Nr(t,n,e))}function hr(t){return yt(t,function(n,e){return Rn(n,function(r){return r.row()===e.row()})?n:n.concat([e])},[]).sort(function(n,e){return n.row()-e.row()})}function vr(t){return yt(t,function(n,e){return Rn(n,function(r){return r.column()===e.column()})?n:n.concat([e])},[]).sort(function(n,e){return n.column()-e.column()})}function Ji(t,n,e){var r=oa(t,e),o=B.generate(r);return Fn(o,n,!0)}function Kt(t){return t.getBoundingClientRect().width}function Qi(t){return t.getBoundingClientRect().height}function ht(t){return/^[0-9]+$/.test(t)&&(t+="px"),t}function br(t){var n=nt(t,"td[data-mce-style],th[data-mce-style]");H(t,"data-mce-style"),x(n,function(e){H(e,"data-mce-style")})}function wr(t){return t.getParam("table_default_attributes",Kl,"object")}function yr(t){return t.getParam("table_default_styles",Yl,"object")}function be(t){return t.getParam("table_cell_advtab",!0,"boolean")}function Cr(t){return t.getParam("table_row_advtab",!0,"boolean")}function Xt(t){return t.getParam("table_advtab",!0,"boolean")}function Hn(t){return t.getParam("table_style_by_css",!1,"boolean")}function Zi(t){return t.getParam("table_class_list",[],"array")}function Sr(t){return t.getParam("table_responsive_width")===!1}function tu(t,n){return t.fire("newrow",{node:n})}function nu(t,n){return t.fire("newcell",{node:n})}function eu(t,n,e,r){t.fire("ObjectResizeStart",{target:n,width:e,height:r})}function ru(t,n,e,r){t.fire("ObjectResized",{target:n,width:e,height:r})}function xr(t,n){function e(r){return bo(r,"rgb")?t.toHex(r):r}return{borderwidth:xt(v.fromDom(n),"border-width").getOr(""),borderstyle:xt(v.fromDom(n),"border-style").getOr(""),bordercolor:xt(v.fromDom(n),"border-color").map(e).getOr(""),backgroundcolor:xt(v.fromDom(n),"background-color").map(e).getOr("")}}function ou(t,n,e,r,o){var i={};return Z.each(t.split(" "),function(u){r.formatter.matchNode(o,n+u)&&(i[e]=u)}),i[e]||(i[e]=""),i}function iu(t,n){t.setAttrib("scope",n.scope),t.setAttrib("class",n.class),t.setStyle("width",ht(n.width)),t.setStyle("height",ht(n.height))}function uu(t,n){t.setStyle("background-color",n.backgroundcolor),t.setStyle("border-color",n.bordercolor),t.setStyle("border-style",n.borderstyle),t.setStyle("border-width",ht(n.borderwidth))}function rl(t,n,e){var r=t.dom,o=e.celltype&&n[0].nodeName.toLowerCase()!==e.celltype?r.rename(n[0],e.celltype):n[0],i=Te.normal(r,o);iu(i,e),be(t)&&uu(i,e),Ir(t,o),tf(t,o),e.halign&&Re(t,o,e.halign),e.valign&&Du(t,o,e.valign)}function ol(t,n,e){var r=t.dom;Z.each(n,function(o){e.celltype&&o.nodeName.toLowerCase()!==e.celltype&&(o=r.rename(o,e.celltype));var i=Te.ifTruthy(r,o);iu(i,e),be(t)&&uu(i,e),e.halign&&Re(t,o,e.halign),e.valign&&Du(t,o,e.valign)})}function il(t,n,e){var r=e.getData();e.close(),t.undoManager.transact(function(){(n.length===1?rl:ol)(t,n,r),t.focus()})}function ul(t,n,e,r){var o=t.dom,i=r.getData();r.close();var u=n.length===1?Te.normal:Te.ifTruthy;t.undoManager.transact(function(){Z.each(n,function(c){i.type!==c.parentNode.nodeName.toLowerCase()&&function(l,f,d){var g=l.getParent(f,"table"),p=f.parentNode,m=l.select(d,g)[0];m||(m=l.create(d),g.firstChild?g.firstChild.nodeName==="CAPTION"?l.insertAfter(m,g.firstChild):g.insertBefore(m,g.firstChild):g.appendChild(m)),d==="tbody"&&p.nodeName==="THEAD"&&m.firstChild?m.insertBefore(f,m.firstChild):m.appendChild(f),p.hasChildNodes()||l.remove(p)}(t.dom,c,i.type);var a=u(o,c);a.setAttrib("scope",i.scope),a.setAttrib("class",i.class),a.setStyle("height",ht(i.height)),Cr(t)&&function(l,f){l.setStyle("background-color",f.backgroundcolor),l.setStyle("border-color",f.bordercolor),l.setStyle("border-style",f.borderstyle)}(a,i),i.align!==e.align&&(Ir(t,c),Re(t,c,i.align))}),t.focus()})}function cl(t,n,e,r,o){o===void 0&&(o=ff);var i=v.fromTag("table");En(i,o.styles),An(i,o.attributes);var u=v.fromTag("tbody");j(i,u);for(var c=[],a=0;a<t;a++){for(var l=v.fromTag("tr"),f=0;f<n;f++){var d=a<e||f<r?v.fromTag("th"):v.fromTag("td");f<r&&tt(d,"scope","row"),a<e&&tt(d,"scope","col"),j(d,v.fromTag("br")),o.percentages&&Y(d,"width",100/n+"%"),j(l,d)}c.push(l)}return kn(u,c),i}function al(t,n){t.selection.select(n.dom(),!0),t.selection.collapse(!0)}function ll(t,n,e){var r,o=t.dom,i=e.getData();e.close(),i.class===""&&delete i.class,t.undoManager.transact(function(){if(!n){var u=parseInt(i.cols,10)||1,c=parseInt(i.rows,10)||1;n=_r(t,u,c)}(function(a,l,f){var d=a.dom,g={},p={};if(g.class=f.class,p.height=ht(f.height),d.getAttrib(l,"width")&&!Hn(a)?g.width=function(b){return b?b.replace(/px$/,""):""}(f.width):p.width=ht(f.width),Hn(a)?(p["border-width"]=ht(f.border),p["border-spacing"]=ht(f.cellspacing)):(g.border=f.border,g.cellpadding=f.cellpadding,g.cellspacing=f.cellspacing),Hn(a)&&l.children)for(var m=0;m<l.children.length;m++)Lr(d,l.children[m],{"border-width":ht(f.border),padding:ht(f.cellpadding)}),Xt(a)&&Lr(d,l.children[m],{"border-color":f.bordercolor});Xt(a)&&(p["background-color"]=f.backgroundcolor,p["border-color"]=f.bordercolor,p["border-style"]=f.borderstyle),g.style=d.serializeStyle(k(k({},yr(a)),p)),d.setAttribs(l,k(k({},wr(a)),g))})(t,n,i),(r=o.select("caption",n)[0])&&!i.caption&&o.remove(r),!r&&i.caption&&((r=o.create("caption")).innerHTML=lf.ie?"\xA0":'<br data-mce-bogus="1"/>',n.insertBefore(r,n.firstChild)),i.align===""?Ir(t,n):Re(t,n,i.align),t.focus(),t.addVisual()})}function cu(t){return function(n){return s.from(n.dom.getParent(n.selection.getStart(),t)).map(v.fromDom)}}function fl(t){function n(){t.stopPropagation()}function e(){t.preventDefault()}var r=v.fromDom(t.target),o=ro(e,n);return function(i,u,c,a,l,f,d){return{target:h(i),x:h(u),y:h(c),stop:a,prevent:l,kill:f,raw:h(d)}}(r,t.clientX,t.clientY,n,e,o,t)}function sl(t,n,e,r,o){var i=function(u,c){return function(a){u(a)&&c(fl(a))}}(e,r);return t.dom().addEventListener(n,i,o),{unbind:N(gf,t,n,i,o)}}function sn(t,n,e){return function(r,o,i,u){return sl(r,o,i,u,!1)}(t,n,pf,e)}var au=function(t){var n=Tt(t);return B.generate(n).grid()},dl=function(t,n){function e(a,l){0<a.length?function(f,d){var g=Vo(t,d).getOrThunk(function(){var m=v.fromTag(d,Le(t).dom());return j(t,m),m});He(g);var p=C(f,function(m){m.isNew()&&r.push(m.element());var b=m.element();return He(b),x(m.cells(),function(w){w.isNew()&&o.push(w.element()),me(w.element(),"colspan",w.colspan(),1),me(w.element(),"rowspan",w.rowspan(),1),j(b,w.element())}),b});kn(g,p)}(a,l):function(f){Vo(t,f).each(it)}(l)}var r=[],o=[],i=[],u=[],c=[];return x(n,function(a){switch(a.section()){case"thead":i.push(a);break;case"tbody":u.push(a);break;case"tfoot":c.push(a)}}),e(i,"thead"),e(u,"tbody"),e(c,"tfoot"),{newRows:h(r),newCells:h(o)}},ml=function(t){return C(t,function(n){var e=Jo(n.element());return x(n.cells(),function(r){var o=ue(r.element());me(o,"colspan",r.colspan(),1),me(o,"rowspan",r.rowspan(),1),j(e,o)}),e})},lu=function(t,n,e){var r=t();return Ct(r,n).orThunk(function(){return s.from(r[0]).orThunk(e)}).map(function(o){return o.element()})},fu=function(t){var n=t.grid(),e=jn(0,n.columns()),r=jn(0,n.rows());return C(e,function(o){return lu(function(){return gt(r,function(i){return B.getAt(t,i,o).filter(function(u){return u.column()===o}).fold(h([]),function(u){return[u]})})},function(i){return i.colspan()===1},function(){return B.getAt(t,0,o)})})},su=function(t){var n=t.grid(),e=jn(0,n.rows()),r=jn(0,n.columns());return C(e,function(o){return lu(function(){return gt(r,function(i){return B.getAt(t,o,i).filter(function(u){return u.row()===o}).fold(h([]),function(u){return[u]})})},function(i){return i.rowspan()===1},function(){return B.getAt(t,o,0)})})},we={resolve:Ii("ephox-snooker").resolve},gl=function(t,n,e,r,o){var i=v.fromTag("div");return En(i,{position:"absolute",left:n-r/2+"px",top:e+"px",height:o+"px",width:r+"px"}),An(i,{"data-column":t,role:"presentation"}),i},pl=function(t,n,e,r,o){var i=v.fromTag("div");return En(i,{position:"absolute",left:n+"px",top:e-o/2+"px",height:o+"px",width:r+"px"}),An(i,{"data-row":t,role:"presentation"}),i},Rr=we.resolve("resizer-bar"),du=we.resolve("resizer-rows"),mu=we.resolve("resizer-cols"),ye=function(t,n,e,r){Bi(t);var o=Tt(n),i=B.generate(o),u=su(i),c=fu(i);Ga(t,n,u,c,e,r)},hl=function(t){Mi(t,function(n){Y(n,"display","none")})},vl=function(t){Mi(t,function(n){Y(n,"display","block")})},gu=Bi,bl=function(t){return mr(t,du)},wl=function(t){return mr(t,mu)},pu=function(t,n){return re(n,t.section())},S={addCell:function(t,n,e){var r=t.cells(),o=r.slice(0,n),i=r.slice(n),u=o.concat([e]).concat(i);return pu(t,u)},setCells:pu,mutateCell:function(t,n,e){t.cells()[n]=e},getCell:Wi,getCellElement:function(t,n){return Wi(t,n).element()},mapCells:function(t,n){var e=t.cells(),r=C(e,n);return re(r,t.section())},cellLength:function(t){return t.cells().length}},yl=function(t,n,e,r){var o=function(a,l){return a[l]}(t,n).cells().slice(e),i=_i(o,r),u=function(a,l){return C(a,function(f){return S.getCell(f,l)})}(t,e).slice(n),c=_i(u,r);return{colspan:h(i),rowspan:h(c)}},Cl=function(t,n){var e=C(t,function(r,o){return C(r.cells(),function(i,u){return!1})});return C(t,function(r,o){var i=gt(r.cells(),function(u,c){if(e[o][c]!==!1)return[];var a=yl(t,o,c,n);return function(l,f,d,g){for(var p=l;p<l+d;p++)for(var m=f;m<f+g;m++)e[p][m]=!0}(o,c,a.rowspan(),a.colspan()),[Jc(u.element(),a.rowspan(),a.colspan(),u.isNew())]});return ta(i,r.section())})},Fn=function(t,n,e){for(var r=[],o=0;o<t.grid().rows();o++){for(var i=[],u=0;u<t.grid().columns();u++){var c=B.getAt(t,o,u).map(function(l){return J(l.element(),e)}).getOrThunk(function(){return J(n.gap(),!0)});i.push(c)}var a=re(i,t.all()[o].section());r.push(a)}return r},dn=function(t){return{is:function(n){return t===n},isValue:G,isError:rt,getOr:h(t),getOrThunk:h(t),getOrDie:h(t),or:function(n){return dn(t)},orThunk:function(n){return dn(t)},fold:function(n,e){return e(t)},map:function(n){return dn(n(t))},mapError:function(n){return dn(t)},each:function(n){n(t)},bind:function(n){return n(t)},exists:function(n){return n(t)},forall:function(n){return n(t)},toOption:function(){return s.some(t)}}},Un=function(t){return{is:rt,isValue:rt,isError:G,getOr:dt,getOrThunk:function(n){return n()},getOrDie:function(){return function(n){return function(){throw new Error(n)}}(String(t))()},or:function(n){return n},orThunk:function(n){return n()},fold:function(n,e){return n(t)},map:function(n){return Un(t)},mapError:function(n){return Un(n(t))},each:y,bind:function(n){return Un(t)},exists:rt,forall:G,toOption:s.none}},hu={value:dn,error:Un,fromOption:function(t,n){return t.fold(function(){return Un(n)},dn)}},Sl=function(t,n,e){if(t.row()>=n.length||t.column()>S.cellLength(n[0]))return hu.error("invalid start address out of table bounds, row: "+t.row()+", column: "+t.column());var r=n.slice(t.row()),o=r[0].cells().slice(t.column()),i=S.cellLength(e[0]),u=e.length;return hu.value({rowDelta:h(r.length-u),colDelta:h(o.length-i)})},vu=function(t,n){var e=S.cellLength(t[0]),r=S.cellLength(n[0]);return{rowDelta:h(0),colDelta:h(e-r)}},Tr=function(t,n,e){var r=n.colDelta()<0?Xa:dt;return(n.rowDelta()<0?Ka:dt)(r(t,Math.abs(n.colDelta()),e),Math.abs(n.rowDelta()),e)},xl=function(t,n,e,r){if(t.length===0)return t;for(var o=n.startRow();o<=n.finishRow();o++)for(var i=n.startCol();i<=n.finishCol();i++)S.mutateCell(t[o],i,J(r(),!1));return t},bu=function(t,n,e,r){for(var o=!0,i=0;i<t.length;i++)for(var u=0;u<S.cellLength(t[0]);u++){var c=e(S.getCellElement(t[i],u),n);c===!0&&o===!1?S.mutateCell(t[i],u,J(r(),!0)):c===!0&&(o=!1)}return t},Rl=function(t,n,e,r){if(0<n&&n<t.length){var o=function(i,u){return yt(i,function(c,a){return Rn(c,function(l){return u(l.element(),a.element())})?c:c.concat([a])},[])}(t[n-1].cells(),e);x(o,function(i){for(var u=s.none(),c=function(l){for(var f=function(g){var p=t[l].cells()[g];e(p.element(),i.element())&&(u.isNone()&&(u=s.some(r())),u.each(function(m){S.mutateCell(t[l],g,J(m,!0))}))},d=0;d<S.cellLength(t[0]);d++)f(d)},a=n;a<t.length;a++)c(a)})}return t},Tl=function(t,n,e,r,o){return Sl(t,n,e).map(function(i){var u=Tr(n,i,r);return function(c,a,l,f,d){for(var g,p,m,b,w,R=c.row(),E=c.column(),_=R+l.length,Et=E+S.cellLength(l[0]),Nt=R;Nt<_;Nt++)for(var wt=E;wt<Et;wt++){g=a,p=Nt,m=wt,w=b=void 0,b=N(d,S.getCell(g[p],m).element()),w=g[p],1<g.length&&1<S.cellLength(w)&&(0<m&&b(S.getCellElement(w,m-1))||m<w.cells().length-1&&b(S.getCellElement(w,m+1))||0<p&&b(S.getCellElement(g[p-1],m))||p<g.length-1&&b(S.getCellElement(g[p+1],m)))&&bu(a,S.getCellElement(a[Nt],wt),d,f.cell);var Xn=S.getCellElement(l[Nt-R],wt-E),Jt=f.replace(Xn);S.mutateCell(a[Nt],wt,J(Jt,!0))}return a}(t,u,e,r,o)})},wu=function(t,n,e,r,o){Rl(n,t,o,r.cell);var i=vu(e,n),u=Tr(e,i,r),c=vu(n,u),a=Tr(n,c,r);return a.slice(0,t).concat(u).concat(a.slice(t,a.length))},Ce=function(t,n,e,r,o){var i=t.slice(0,n),u=t.slice(n),c=S.mapCells(t[e],function(a,l){return 0<n&&n<t.length&&r(S.getCellElement(t[n-1],l),S.getCellElement(t[n],l))?S.getCell(t[n],l):J(o(a.element(),r),!0)});return i.concat([c]).concat(u)},Se=function(t,n,e,r,o){return C(t,function(i){var u=0<n&&n<S.cellLength(i)&&r(S.getCellElement(i,n-1),S.getCellElement(i,n))?S.getCell(i,n):J(o(S.getCellElement(i,e),r),!0);return S.addCell(i,n,u)})},Ol=function(t,n,e,r,o){var i=e+1;return C(t,function(u,c){var a=c===n?J(o(S.getCellElement(u,e),r),!0):S.getCell(u,e);return S.addCell(u,i,a)})},Dl=function(t,n,e,r,o){var i=n+1,u=t.slice(0,i),c=t.slice(i),a=S.mapCells(t[n],function(l,f){return f===e?J(o(l.element(),r),!0):l});return u.concat([a]).concat(c)},Al=function(t,n,e){return t.slice(0,n).concat(t.slice(e+1))},El=function(t,n,e){var r=C(t,function(o){var i=o.cells().slice(0,n).concat(o.cells().slice(e+1));return re(i,o.section())});return ot(r,function(o){return 0<o.cells().length})},yu=function(t,n,e,r){var o=gt(t,function(i,u){return Hi(t,u,n,e)||Fi(i,n,e)?[]:[S.getCell(i,n)]});return zi(t,o,e,r)},Cu=function(t,n,e,r){var o=t[n],i=gt(o.cells(),function(u,c){return Hi(t,n,c,e)||Fi(o,c,e)?[]:[u]});return zi(t,i,e,r)},Nl=Wt([{none:[]},{only:["index"]},{left:["index","next"]},{middle:["prev","index","next"]},{right:["prev","index"]}]),mn=k({},Nl),kl=function(t,n,e,r){function o(f){return C(f,h(0))}function i(f,d){if(0<=e){var g=Math.max(r.minCellWidth(),u[d]-e);return o(u.slice(0,f)).concat([e,g-u[d]]).concat(o(u.slice(d+1)))}var p=Math.max(r.minCellWidth(),u[f]+e),m=u[f]-p;return o(u.slice(0,f)).concat([p-u[f],m]).concat(o(u.slice(d+1)))}var u=t.slice(0),c=function(f,d){return f.length===0?mn.none():f.length===1?mn.only(0):d===0?mn.left(0,1):d===f.length-1?mn.right(d-1,d):0<d&&d<f.length-1?mn.middle(d-1,d,d+1):mn.none()}(t,n),a=h(o(u)),l=i;return c.fold(a,function(f){return r.singleColumnWidth(u[f],e)},l,function(f,d,g){return i(d,g)},function(f,d){if(0<=e)return o(u.slice(0,d)).concat([e]);var g=Math.max(r.minCellWidth(),u[d]+e);return o(u.slice(0,d)).concat([g-u[d]])})},vt={hasColspan:function(t){return Ui(t,"colspan")},hasRowspan:function(t){return Ui(t,"rowspan")},minWidth:h(10),minHeight:h(10),getInt:function(t,n){return parseInt(St(t,n),10)}},Or={getRawWidths:function(t,n,e){return gr(t,n,$a,Vi,e)},getPixelWidths:function(t,n,e){return gr(t,n,U.getPixelWidth,function(r){return r.getOrThunk(e.minCellWidth)},e)},getPercentageWidths:function(t,n,e){return gr(t,n,U.getPercentageWidth,function(r){return r.fold(function(){return e.minCellWidth()},function(o){return o/e.pixelWidth()*100})},e)},getPixelHeights:function(t,n){return Gi(t,n,U.getHeight,function(e){return e.getOrThunk(vt.minHeight)})},getRawHeights:function(t,n){return Gi(t,n,Ja,Vi)}},Su=function(t,n){var e=B.justCells(t);return C(e,function(r){var o=Yi(r.column(),r.column()+r.colspan(),n);return{element:r.element,width:h(o),colspan:r.colspan}})},Il=function(t,n){var e=B.justCells(t);return C(e,function(r){var o=Yi(r.row(),r.row()+r.rowspan(),n);return{element:r.element,height:h(o),rowspan:r.rowspan}})},Bl=function(t,n){return C(t.all(),function(e,r){return{element:e.element,height:h(n[r])}})},xu=function(t){return U.getRawWidth(t).fold(function(){var n=Yt(t);return pr(n)},function(n){return Qa(t,n)})},Pl=function(t,n,e,r){var o=xu(t),i=o.getCellDelta(n),u=Xi(t),c=o.getWidths(u,r,o),a=kl(c,e,i,o),l=C(a,function(d,g){return d+c[g]}),f=Su(u,l);x(f,function(d){o.setElementWidth(d.element(),d.width())}),e===u.grid().columns()-1&&o.setTableWidth(t,l,i)},Ml=function(t,n,e,r){var o=Xi(t),i=Or.getPixelHeights(o,r),u=C(i,function(f,d){return e===d?Math.max(n+f,vt.minHeight()):f}),c=Il(o,u),a=Bl(o,u);x(a,function(f){U.setHeight(f.element(),f.height())}),x(c,function(f){U.setHeight(f.element(),f.height())});var l=function(f){return Tn(f,function(d,g){return d+g},0)}(u);U.setHeight(t,l)},Wl=function(t,n,e){var r=xu(t),o=Ki(n),i=r.getWidths(o,e,r),u=Su(o,i);x(u,function(c){r.setElementWidth(c.element(),c.width())}),0<u.length&&r.setTableWidth(t,i,r.getCellDelta(0))},_l=function(t,n,e){if(n.length===0)throw new Error("You must specify at least one required field.");return _e("required",n),so(n),function(r){var o=un(r);On(n,function(u){return X(o,u)})||lo(n,o),t(n,o);var i=ot(n,function(u){return!e.validate(r[u],u)});return 0<i.length&&function(u,c){throw new Error("All values need to be of type: "+c+". Keys ("+Dn(u).join(", ")+") were not.")}(i,e.label),r}},Dr=ve(["cell","row","replace","gap"]),K=function(t,n){n===void 0&&(n=tl),Dr(t);function e(u){return function(c){return t.cell(c)}(n(u))}function r(u){var c=e(u);return o.get().isNone()&&o.set(s.some(c)),i=s.some({item:u,replacement:c}),c}var o=mt(s.none()),i=s.none();return{getOrInit:function(u,c){return i.fold(function(){return r(u)},function(a){return c(u,a.item)?a.replacement:r(u)})},cursor:o.get}},xe=function(t,n){return function(e){var r=mt(s.none());Dr(e);function o(u){var c={scope:t},a=e.replace(u,n,c);return i.push({item:u,sub:a}),r.get().isNone()&&r.set(s.some(a)),a}var i=[];return{replaceOrInit:function(u,c){return function(a,l){return Ct(i,function(f){return l(f.item,a)})}(u,c).fold(function(){return o(u)},function(a){return c(u,a.item)?a.sub:o(u)})},cursor:r.get}}},Ru=function(t){Dr(t);var n=mt(s.none());return{combine:function(e){return n.get().isNone()&&n.set(s.some(e)),function(){var r=t.cell({element:h(e),colspan:h(1),rowspan:h(1)});return Ht(r,"width"),Ht(e,"width"),r}},cursor:n.get}},Ll=["body","p","div","article","aside","figcaption","figure","footer","header","nav","section","ol","ul","table","thead","tfoot","tbody","caption","tr","td","th","h1","h2","h3","h4","h5","h6","blockquote","pre","address"],jl=nl,zl=function(t,n){var e=t.property().name(n);return X(["ol","ul"],e)},Hl=el,Ar=er(),Er=function(t){return jl(Ar,t)},Fl=function(t){return zl(Ar,t)},Ul=function(t){return Hl(Ar,t)},ql=function(t){function n(i){return I(i)==="br"}function e(i){return Qe(i).bind(function(u){var c=function(a){return Zn(a).map(function(l){return!!Er(l)||!!Ul(l)&&I(l)!=="img"}).getOr(!1)}(u);return lt(u).map(function(a){return c===!0||function(l){return I(l)==="li"||Pn(l,Fl).isSome()}(a)||n(u)||Er(a)&&!A(i,a)?[]:[v.fromTag("br")]})}).getOr([])}var r,o=(r=gt(t,function(i){var u=V(i);return function(c){return On(c,function(a){return n(a)||Pt(a)&&oe(a).trim().length===0})}(u)?[]:u.concat(e(i))})).length===0?[v.fromTag("br")]:r;He(t[0]),kn(t[0],o)},At=D("grid","cursor"),Nr=function(t,n,e){return s.from(t[n]).bind(function(r){return s.from(r.cells()[e]).bind(function(o){return s.from(o.element())})})},Lt=Wl,ft={insertRowBefore:W(function(t,n,e,r){var o=n.row(),i=n.row(),u=Ce(t,i,o,e,r.getOrInit);return Q(u,i,n.column())},pt,y,y,K),insertRowsBefore:W(function(t,n,e,r){var o=n[0].row(),i=n[0].row(),u=hr(n),c=yt(u,function(a,l){return Ce(a,i,o,e,r.getOrInit)},t);return Q(c,i,n[0].column())},_t,y,y,K),insertRowAfter:W(function(t,n,e,r){var o=n.row(),i=n.row()+n.rowspan(),u=Ce(t,i,o,e,r.getOrInit);return Q(u,i,n.column())},pt,y,y,K),insertRowsAfter:W(function(t,n,e,r){var o=hr(n),i=o[o.length-1].row(),u=o[o.length-1].row()+o[o.length-1].rowspan(),c=yt(o,function(a,l){return Ce(a,u,i,e,r.getOrInit)},t);return Q(c,u,n[0].column())},_t,y,y,K),insertColumnBefore:W(function(t,n,e,r){var o=n.column(),i=n.column(),u=Se(t,i,o,e,r.getOrInit);return Q(u,n.row(),i)},pt,Lt,y,K),insertColumnsBefore:W(function(t,n,e,r){var o=vr(n),i=o[0].column(),u=o[0].column(),c=yt(o,function(a,l){return Se(a,u,i,e,r.getOrInit)},t);return Q(c,n[0].row(),u)},_t,Lt,y,K),insertColumnAfter:W(function(t,n,e,r){var o=n.column(),i=n.column()+n.colspan(),u=Se(t,i,o,e,r.getOrInit);return Q(u,n.row(),i)},pt,Lt,y,K),insertColumnsAfter:W(function(t,n,e,r){var o=n[n.length-1].column(),i=n[n.length-1].column()+n[n.length-1].colspan(),u=vr(n),c=yt(u,function(a,l){return Se(a,i,o,e,r.getOrInit)},t);return Q(c,n[0].row(),i)},_t,Lt,y,K),splitCellIntoColumns:W(function(t,n,e,r){var o=Ol(t,n.row(),n.column(),e,r.getOrInit);return Q(o,n.row(),n.column())},pt,Lt,y,K),splitCellIntoRows:W(function(t,n,e,r){var o=Dl(t,n.row(),n.column(),e,r.getOrInit);return Q(o,n.row(),n.column())},pt,y,y,K),eraseColumns:W(function(t,n,e,r){var o=vr(n),i=El(t,o[0].column(),o[o.length-1].column()),u=zn(i,n[0].row(),n[0].column());return At(i,u)},_t,Lt,$i,K),eraseRows:W(function(t,n,e,r){var o=hr(n),i=Al(t,o[0].row(),o[o.length-1].row()),u=zn(i,n[0].row(),n[0].column());return At(i,u)},_t,y,$i,K),makeColumnHeader:W(function(t,n,e,r){var o=yu(t,n.column(),e,r.replaceOrInit);return Q(o,n.row(),n.column())},pt,y,y,xe("row","th")),unmakeColumnHeader:W(function(t,n,e,r){var o=yu(t,n.column(),e,r.replaceOrInit);return Q(o,n.row(),n.column())},pt,y,y,xe(null,"td")),makeRowHeader:W(function(t,n,e,r){var o=Cu(t,n.row(),e,r.replaceOrInit);return Q(o,n.row(),n.column())},pt,y,y,xe("col","th")),unmakeRowHeader:W(function(t,n,e,r){var o=Cu(t,n.row(),e,r.replaceOrInit);return Q(o,n.row(),n.column())},pt,y,y,xe(null,"td")),mergeCells:W(function(t,n,e,r){var o=n.cells();ql(o);var i=xl(t,n.bounds(),e,h(o[0]));return At(i,s.from(o[0]))},function(t,n){return n.mergable()},y,y,Ru),unmergeCells:W(function(t,n,e,r){var o=Tn(n,function(i,u){return bu(i,u,e,r.combine(u))},t);return At(o,s.from(n[0]))},function(t,n){return n.unmergable()},Lt,y,Ru),pasteCells:W(function(t,n,e,r){var o,i,u,c,a=(o=n.clipboard(),i=n.generators(),u=Tt(o),c=B.generate(u),Fn(c,i,!0)),l=$c(n.row(),n.column());return Tl(l,t,a,n.generators(),e).fold(function(){return At(t,s.some(n.element()))},function(f){var d=zn(f,n.row(),n.column());return At(f,d)})},function(t,n){return M.cell(n.element()).bind(function(e){return he(t,e).map(function(r){return k(k({},r),{generators:n.generators,clipboard:n.clipboard})})})},Lt,y,K),pasteRowsBefore:W(function(t,n,e,r){var o=t[n.cells[0].row()],i=n.cells[0].row(),u=Ji(n.clipboard(),n.generators(),o),c=wu(i,t,u,n.generators(),e),a=zn(c,n.cells[0].row(),n.cells[0].column());return At(c,a)},Li,y,y,K),pasteRowsAfter:W(function(t,n,e,r){var o=t[n.cells[0].row()],i=n.cells[n.cells.length-1].row()+n.cells[n.cells.length-1].rowspan(),u=Ji(n.clipboard(),n.generators(),o),c=wu(i,t,u,n.generators(),e),a=zn(c,n.cells[0].row(),n.cells[0].column());return At(c,a)},Li,y,y,K)},$t=function(t){return v.fromDom(t.getBody())},Tu=function(t){return function(n){return A(n,$t(t))}},Vl={isRtl:h(!1)},Gl={isRtl:h(!0)},kr={directionAt:function(t){return function(n){return St(n,"direction")==="rtl"?"rtl":"ltr"}(t)==="rtl"?Gl:Vl}},Yl={"border-collapse":"collapse",width:"100%"},Kl={border:"1"},Xl=function(t){return t.getParam("table_tab_navigation",!0,"boolean")},Ou=function(t){var n=t.getParam("table_clone_elements");return Ft(n)?s.some(n.split(/[ ,]/)):Array.isArray(n)?s.some(n):s.none()},$l=function(t,n,e,r,o){t.fire("TableSelectionChange",{cells:n,start:e,finish:r,otherCells:o})},Jl=function(t){t.fire("TableSelectionClear")},Ql=function(t,n){function e(i){return I($t(i))==="table"}function r(i,u,c,a){return function(l,f){br(l);var d=a(),g=v.fromDom(t.getDoc()),p=Ei(kr.directionAt),m=Wn.cellOperations(c,g,o);return u(l)?i(d,l,f,m,p).bind(function(b){return x(b.newRows(),function(w){tu(t,w.dom())}),x(b.newCells(),function(w){nu(t,w.dom())}),b.cursor().map(function(w){var R=t.dom.createRng();return R.setStart(w.dom(),0),R.setEnd(w.dom(),0),R})}):s.none()}}var o=Ou(t);return{deleteRow:r(ft.eraseRows,function(i){var u=au(i);return e(t)===!1||1<u.rows()},y,n),deleteColumn:r(ft.eraseColumns,function(i){var u=au(i);return e(t)===!1||1<u.columns()},y,n),insertRowsBefore:r(ft.insertRowsBefore,G,y,n),insertRowsAfter:r(ft.insertRowsAfter,G,y,n),insertColumnsBefore:r(ft.insertColumnsBefore,G,Ri,n),insertColumnsAfter:r(ft.insertColumnsAfter,G,Ri,n),mergeCells:r(ft.mergeCells,G,y,n),unmergeCells:r(ft.unmergeCells,G,y,n),pasteRowsBefore:r(ft.pasteRowsBefore,G,y,n),pasteRowsAfter:r(ft.pasteRowsAfter,G,y,n),pasteCells:r(ft.pasteCells,G,y,n)}},Zl=function(t,n,e){var r=Tt(t),o=B.generate(r);return _t(o,n).map(function(i){var u=Fn(o,e,!1).slice(i[0].row(),i[i.length-1].row()+i[i.length-1].rowspan()),c=pe(u,e);return ml(c)})},Z=tinymce.util.Tools.resolve("tinymce.util.Tools"),Re=function(t,n,e){e&&t.formatter.apply("align"+e,{},n)},Du=function(t,n,e){e&&t.formatter.apply("valign"+e,{},n)},Ir=function(t,n){Z.each("left center right".split(" "),function(e){t.formatter.remove("align"+e,{},n)})},tf=function(t,n){Z.each("top middle bottom".split(" "),function(e){t.formatter.remove("valign"+e,{},n)})},Br=function(t,n,e){var r;return r=function(o,i){for(var u=0;u<i.length;u++){var c=t.getStyle(i[u],e);if(o===void 0&&(o=c),o!==c)return""}return o}(r,t.select("td,th",n))},Pr=N(ou,"left center right"),nf=N(ou,"top middle bottom"),Mr=function(t,n,e){var r=function(o,i){return i=i||[],Z.each(o,function(u){var c={text:u.text||u.title};u.menu?c.menu=r(u.menu):(c.value=u.value,n&&n(c)),i.push(c)}),i};return r(t,e||[])},Au=function(t){var n=t[0],e=t.slice(1),r=un(n);return x(e,function(o){x(r,function(i){tn(o,function(u,c){var a=n[i];a!==""&&i===c&&a!==u&&(n[i]="")})})}),n},Wr=function(t){var n=[{name:"borderstyle",type:"selectbox",label:"Border style",items:[{text:"Select...",value:""},{text:"Solid",value:"solid"},{text:"Dotted",value:"dotted"},{text:"Dashed",value:"dashed"},{text:"Double",value:"double"},{text:"Groove",value:"groove"},{text:"Ridge",value:"ridge"},{text:"Inset",value:"inset"},{text:"Outset",value:"outset"},{text:"None",value:"none"},{text:"Hidden",value:"hidden"}]},{name:"bordercolor",type:"colorinput",label:"Border color"},{name:"backgroundcolor",type:"colorinput",label:"Background color"}];return{title:"Advanced",name:"advanced",items:t==="cell"?[{name:"borderwidth",type:"input",label:"Border width"}].concat(n):n}},ef=function(t,n,e){var r,o,i,u=t.dom;return k(k({width:u.getStyle(n,"width")||u.getAttrib(n,"width"),height:u.getStyle(n,"height")||u.getAttrib(n,"height"),cellspacing:u.getStyle(n,"border-spacing")||u.getAttrib(n,"cellspacing"),cellpadding:u.getAttrib(n,"cellpadding")||Br(t.dom,n,"padding"),border:(r=u,o=n,i=xt(v.fromDom(o),"border-width"),Hn(t)&&i.isSome()?i.getOr(""):r.getAttrib(o,"border")||Br(t.dom,o,"border-width")||Br(t.dom,o,"border")),caption:!!u.select("caption",n)[0],class:u.getAttrib(n,"class","")},Pr("align","align",t,n)),e?xr(u,n):{})},rf=function(t,n,e){var r=t.dom;return k(k({height:r.getStyle(n,"height")||r.getAttrib(n,"height"),scope:r.getAttrib(n,"scope"),class:r.getAttrib(n,"class",""),align:"",type:n.parentNode.nodeName.toLowerCase()},Pr("align","align",t,n)),e?xr(r,n):{})},of=function(t,n,e){var r=t.dom;return k(k(k({width:r.getStyle(n,"width")||r.getAttrib(n,"width"),height:r.getStyle(n,"height")||r.getAttrib(n,"height"),scope:r.getAttrib(n,"scope"),celltype:n.nodeName.toLowerCase(),class:r.getAttrib(n,"class","")},Pr("align","halign",t,n)),nf("valign","valign",t,n)),e?xr(r,n):{})},uf=function(t,n){var e,r,o,i,u=yr(t),c=wr(t),a=t.dom,l=n?(e=a,r=It(u,"border-style").getOr(""),o=It(u,"border-color").getOr(""),i=It(u,"background-color").getOr(""),{borderstyle:r,bordercolor:f(o),backgroundcolor:f(i)}):{};function f(m){return bo(m,"rgb")?e.toHex(m):m}var d,g,p;return k(k(k(k(k(k({},{height:"",width:"100%",cellspacing:"",cellpadding:"",caption:!1,class:"",align:"",border:""}),u),c),l),(p=u["border-width"],Hn(t)&&p?{border:p}:It(c,"border").fold(function(){return{}},function(m){return{border:m}}))),(d=It(u,"border-spacing").or(It(c,"cellspacing")).fold(function(){return{}},function(m){return{cellspacing:m}}),g=It(u,"border-padding").or(It(c,"cellpadding")).fold(function(){return{}},function(m){return{cellpadding:m}}),k(k({},d),g)))},Eu=[{name:"width",type:"input",label:"Width"},{name:"height",type:"input",label:"Height"},{name:"celltype",type:"selectbox",label:"Cell type",items:[{text:"Cell",value:"td"},{text:"Header cell",value:"th"}]},{name:"scope",type:"selectbox",label:"Scope",items:[{text:"None",value:""},{text:"Row",value:"row"},{text:"Column",value:"col"},{text:"Row group",value:"rowgroup"},{text:"Column group",value:"colgroup"}]},{name:"halign",type:"selectbox",label:"H Align",items:[{text:"None",value:""},{text:"Left",value:"left"},{text:"Center",value:"center"},{text:"Right",value:"right"}]},{name:"valign",type:"selectbox",label:"V Align",items:[{text:"None",value:""},{text:"Top",value:"top"},{text:"Middle",value:"middle"},{text:"Bottom",value:"bottom"}]}],Nu=function(t){return function(n){var e=function(o){return o.getParam("table_cell_class_list",[],"array")}(n),r=Mr(e,function(o){o.value&&(o.textStyle=function(){return n.formatter.getCssText({block:"tr",classes:[o.value]})})});return 0<e.length?s.some({name:"class",type:"selectbox",label:"Class",items:r}):s.none()}(t).fold(function(){return Eu},function(n){return Eu.concat(n)})},Te={normal:function(t,n){return{setAttrib:function(e,r){t.setAttrib(n,e,r)},setStyle:function(e,r){t.setStyle(n,e,r)}}},ifTruthy:function(t,n){return{setAttrib:function(e,r){r&&t.setAttrib(n,e,r)},setStyle:function(e,r){r&&t.setStyle(n,e,r)}}}},cf=function(t){var n,e=[];if(e=t.dom.select("td[data-mce-selected],th[data-mce-selected]"),n=t.dom.getParent(t.selection.getStart(),"td,th"),!e.length&&n&&e.push(n),n=n||e[0]){var r=Z.map(e,function(c){return of(t,c,be(t))}),o=Au(r),i={type:"tabpanel",tabs:[{title:"General",name:"general",items:Nu(t)},Wr("cell")]},u={type:"panel",items:[{type:"grid",columns:2,items:Nu(t)}]};t.windowManager.open({title:"Cell Properties",size:"normal",body:be(t)?i:u,buttons:[{type:"cancel",name:"cancel",text:"Cancel"},{type:"submit",name:"save",text:"Save",primary:!0}],initialData:o,onSubmit:N(il,t,e)})}},ku=[{type:"selectbox",name:"type",label:"Row type",items:[{text:"Header",value:"thead"},{text:"Body",value:"tbody"},{text:"Footer",value:"tfoot"}]},{type:"selectbox",name:"align",label:"Alignment",items:[{text:"None",value:""},{text:"Left",value:"left"},{text:"Center",value:"center"},{text:"Right",value:"right"}]},{label:"Height",name:"height",type:"input"}],Iu=function(t){return function(n){var e=function(o){return o.getParam("table_row_class_list",[],"array")}(n),r=Mr(e,function(o){o.value&&(o.textStyle=function(){return n.formatter.getCssText({block:"tr",classes:[o.value]})})});return 0<e.length?s.some({name:"class",type:"selectbox",label:"Class",items:r}):s.none()}(t).fold(function(){return ku},function(n){return ku.concat(n)})},af=function(t){var n,e,r=t.dom,o=[];if((n=r.getParent(t.selection.getStart(),"table"))&&(e=r.getParent(t.selection.getStart(),"td,th"),Z.each(n.rows,function(l){Z.each(l.cells,function(f){if((r.getAttrib(f,"data-mce-selected")||f===e)&&o.indexOf(l)<0)return o.push(l),!1})}),o[0])){var i=Z.map(o,function(l){return rf(t,l,Cr(t))}),u=Au(i),c={type:"tabpanel",tabs:[{title:"General",name:"general",items:Iu(t)},Wr("row")]},a={type:"panel",items:[{type:"grid",columns:2,items:Iu(t)}]};t.windowManager.open({title:"Row Properties",size:"normal",body:Cr(t)?c:a,buttons:[{type:"cancel",name:"cancel",text:"Cancel"},{type:"submit",name:"save",text:"Save",primary:!0}],initialData:u,onSubmit:N(ul,t,o,u)})}},lf=tinymce.util.Tools.resolve("tinymce.Env"),ff={styles:{"border-collapse":"collapse",width:"100%"},attributes:{border:"1"},percentages:!0},_r=function(t,n,e){var r=yr(t),o={styles:r,attributes:wr(t),percentages:function(c){return Ft(c)&&c.indexOf("%")!==-1}(r.width)&&!Sr(t)},i=cl(e,n,0,0,o);tt(i,"data-mce-id","__mce");var u=function(c){var a=v.fromTag("div"),l=v.fromDom(c.dom().cloneNode(!0));return j(a,l),function(f){return f.dom().innerHTML}(a)}(i);return t.insertContent(u),qt($t(t),'table[data-mce-id="__mce"]').map(function(c){return Sr(t)&&Y(c,"width",St(c,"width")),H(c,"data-mce-id"),function(a,l){x(nt(l,"tr"),function(f){tu(a,f.dom()),x(nt(f,"th,td"),function(d){nu(a,d.dom())})})}(t,c),function(a,l){qt(l,"td,th").each(N(al,a))}(t,c),c.dom()}).getOr(null)},sf=function(t,n,e){var r=e?[{type:"input",name:"cols",label:"Cols",inputMode:"numeric"},{type:"input",name:"rows",label:"Rows",inputMode:"numeric"}]:[],o=function(u){return u.getParam("table_appearance_options",!0,"boolean")}(t)?[{type:"input",name:"cellspacing",label:"Cell spacing",inputMode:"numeric"},{type:"input",name:"cellpadding",label:"Cell padding",inputMode:"numeric"},{type:"input",name:"border",label:"Border width"},{type:"label",label:"Caption",items:[{type:"checkbox",name:"caption",label:"Show caption"}]}]:[],i=n?[{type:"selectbox",name:"class",label:"Class",items:Mr(Zi(t),function(u){u.value&&(u.textStyle=function(){return t.formatter.getCssText({block:"table",classes:[u.value]})})})}]:[];return r.concat([{type:"input",name:"width",label:"Width"},{type:"input",name:"height",label:"Height"}]).concat(o).concat([{type:"selectbox",name:"align",label:"Alignment",items:[{text:"None",value:""},{text:"Left",value:"left"},{text:"Center",value:"center"},{text:"Right",value:"right"}]}]).concat(i)},Lr=function(t,n,e,r){if(n.tagName==="TD"||n.tagName==="TH")Ft(e)?t.setStyle(n,e,r):t.setStyle(n,e);else if(n.children)for(var o=0;o<n.children.length;o++)Lr(t,n.children[o],e,r)},Bu=function(t,n){var e,r=t.dom,o=uf(t,Xt(t));n===!1?(e=r.getParent(t.selection.getStart(),"table"))?o=ef(t,e,Xt(t)):Xt(t)&&(o.borderstyle="",o.bordercolor="",o.backgroundcolor=""):(o.cols="1",o.rows="1",Xt(t)&&(o.borderstyle="",o.bordercolor="",o.backgroundcolor=""));var i=0<Zi(t).length;i&&o.class&&(o.class=o.class.replace(/\s*mce\-item\-table\s*/g,""));var u={type:"grid",columns:2,items:sf(t,i,n)},c=Xt(t)?{type:"tabpanel",tabs:[{title:"General",name:"general",items:[u]},Wr("table")]}:{type:"panel",items:[u]};t.windowManager.open({title:"Table Properties",size:"normal",body:c,onSubmit:N(ll,t,e),buttons:[{type:"cancel",name:"cancel",text:"Cancel"},{type:"submit",name:"save",text:"Save",primary:!0}],initialData:o})},jr=cu("th,td"),Pu=cu("th,td,caption"),Mu=Z.each,df={registerCommands:function(t,n,e,r,o){function i(d){return M.table(d,f)}function u(d){return{width:Kt(d.dom()),height:Kt(d.dom())}}function c(d){jr(t).each(function(g){i(g).each(function(p){var m=Gt.forMenu(r,p,g),b=u(p);d(p,m).each(function(w){(function(R,E,_){var Et=u(_);E.width===Et.width&&E.height===Et.height||(eu(R,_.dom(),E.width,E.height),ru(R,_.dom(),Et.width,Et.height))})(t,b,p),t.selection.setRng(w),t.focus(),e.clear(p),br(p)})})})}function a(d){return jr(t).map(function(g){return i(g).bind(function(p){var m=v.fromDom(t.getDoc()),b=Gt.forMenu(r,p,g),w=Wn.cellOperations(y,m,s.none());return Zl(p,b,w)})})}function l(d){o.get().each(function(g){var p=C(g,function(m){return ue(m)});jr(t).each(function(m){i(m).each(function(b){var w=v.fromDom(t.getDoc()),R=Wn.paste(w),E=Gt.pasteRows(r,b,m,p,R);d(b,E).each(function(_){t.selection.setRng(_),t.focus(),e.clear(b)})})})})}var f=Tu(t);Mu({mceTableSplitCells:function(){c(n.unmergeCells)},mceTableMergeCells:function(){c(n.mergeCells)},mceTableInsertRowBefore:function(){c(n.insertRowsBefore)},mceTableInsertRowAfter:function(){c(n.insertRowsAfter)},mceTableInsertColBefore:function(){c(n.insertColumnsBefore)},mceTableInsertColAfter:function(){c(n.insertColumnsAfter)},mceTableDeleteCol:function(){c(n.deleteColumn)},mceTableDeleteRow:function(){c(n.deleteRow)},mceTableCutRow:function(d){a().each(function(g){o.set(g),c(n.deleteRow)})},mceTableCopyRow:function(d){a().each(function(g){o.set(g)})},mceTablePasteRowBefore:function(d){l(n.pasteRowsBefore)},mceTablePasteRowAfter:function(d){l(n.pasteRowsAfter)},mceTableDelete:function(){Pu(t).each(function(d){M.table(d,f).filter(Be(f)).each(function(g){var p=v.fromText("");if(ze(g,p),it(g),t.dom.isEmpty(t.getBody()))t.setContent(""),t.selection.setCursorLocation();else{var m=t.dom.createRng();m.setStart(p.dom(),0),m.setEnd(p.dom(),0),t.selection.setRng(m),t.nodeChanged()}})})}},function(d,g){t.addCommand(g,d)}),Mu({mceInsertTable:N(Bu,t,!0),mceTableProps:N(Bu,t,!1),mceTableRowProps:N(af,t),mceTableCellProps:N(cf,t)},function(d,g){t.addCommand(g,function(){d()})})}},Wu=function(t){var n=s.from(t.dom().documentElement).map(v.fromDom).getOr(t);return{parent:h(n),view:h(t),origin:h(Ot(0,0))}},mf=function(t,n){return{parent:h(n),view:h(t),origin:h(Ot(0,0))}},st=function(t){var n=D.apply(null,t),e=[];return{bind:function(r){if(r===void 0)throw new Error("Event bind error: undefined handler");e.push(r)},unbind:function(r){e=ot(e,function(o){return o!==r})},trigger:function(){for(var r=[],o=0;o<arguments.length;o++)r[o]=arguments[o];var i=n.apply(null,r);x(e,function(u){u(i)})}}},gn={create:function(t){return{registry:ao(t,function(n){return{bind:n.bind,unbind:n.unbind}}),trigger:ao(t,function(n){return n.trigger})}}},gf=function(t,n,e,r){t.dom().removeEventListener(n,e,r)},pf=h(!0),_u={resolve:Ii("ephox-dragster").resolve},hf=ve(["compare","extract","mutate","sink"]),vf=ve(["element","start","stop","destroy"]),bf=ve(["forceDrop","drop","move","delayDrop"]),wf=hf({compare:function(t,n){return Ot(n.left()-t.left(),n.top()-t.top())},extract:function(t){return s.some(Ot(t.x(),t.y()))},sink:function(t,n){var e=function(c){var a=k({layerClass:_u.resolve("blocker")},c),l=v.fromTag("div");return tt(l,"role","presentation"),En(l,{position:"fixed",left:"0px",top:"0px",width:"100%",height:"100%"}),Dt(l,_u.resolve("blocker")),Dt(l,a.layerClass),{element:function(){return l},destroy:function(){it(l)}}}(n),r=sn(e.element(),"mousedown",t.forceDrop),o=sn(e.element(),"mouseup",t.drop),i=sn(e.element(),"mousemove",t.move),u=sn(e.element(),"mouseout",t.delayDrop);return vf({element:e.element,start:function(c){j(c,e.element())},stop:function(){it(e.element())},destroy:function(){e.destroy(),o.unbind(),i.unbind(),u.unbind(),r.unbind()}})},mutate:function(t,n){t.mutate(n.left(),n.top())}});function yf(){var t=s.none(),n=gn.create({move:st(["info"])});return{onEvent:function(e,r){r.extract(e).each(function(o){(function(i,u){var c=t.map(function(a){return i.compare(a,u)});return t=s.some(u),c})(r,o).each(function(i){n.trigger.move(i)})})},reset:function(){t=s.none()},events:n.registry}}function Cf(){var t=function(){return{onEvent:y,reset:y}}(),n=yf(),e=t;return{on:function(){e.reset(),e=n},off:function(){e.reset(),e=t},isOn:function(){return e===n},onEvent:function(r,o){e.onEvent(r,o)},events:n.events}}function Sf(){var t=gn.create({drag:st(["xDelta","yDelta","target"])}),n=s.none(),e=function(){var r=gn.create({drag:st(["xDelta","yDelta"])});return{mutate:function(o,i){r.trigger.drag(o,i)},events:r.registry}}();return e.events.drag.bind(function(r){n.each(function(o){t.trigger.drag(r.xDelta(),r.yDelta(),o)})}),{assign:function(r){n=s.some(r)},get:function(){return n},mutate:e.mutate,events:t.registry}}function xf(t){return z(t,"contenteditable")==="true"}function Rf(t,n,e){function r(m,b){return s.from(z(m,b))}var o=Sf(),i=Uf(o,{}),u=s.none();function c(m,b){return vt.getInt(m,b)-parseInt(z(m,"data-initial-"+b),10)}function a(m,b){p.trigger.startAdjust(),o.assign(m),tt(m,"data-initial-"+b,parseInt(St(m,b),10)),Dt(m,qf),Y(m,"opacity","0.2"),i.go(t.parent())}function l(m){return A(m,t.view())}function f(m){return F(m,"table",l).filter(function(b){return function(w,R){return F(w,"[contenteditable]",R)}(b,l).exists(xf)})}o.events.drag.bind(function(m){r(m.target(),"data-row").each(function(b){var w=vt.getInt(m.target(),"top");Y(m.target(),"top",w+m.yDelta()+"px")}),r(m.target(),"data-column").each(function(b){var w=vt.getInt(m.target(),"left");Y(m.target(),"left",w+m.xDelta()+"px")})}),i.events.stop.bind(function(){o.get().each(function(m){u.each(function(b){r(m,"data-row").each(function(w){var R=c(m,"top");H(m,"data-initial-top"),p.trigger.adjustHeight(b,R,parseInt(w,10))}),r(m,"data-column").each(function(w){var R=c(m,"left");H(m,"data-initial-left"),p.trigger.adjustWidth(b,R,parseInt(w,10))}),ye(t,b,e,n)})})});var d=sn(t.parent(),"mousedown",function(m){bl(m.target())&&a(m.target(),"top"),wl(m.target())&&a(m.target(),"left")}),g=sn(t.view(),"mouseover",function(m){f(m.target()).fold(function(){Qn(m.target())&&gu(t)},function(b){u=s.some(b),ye(t,b,e,n)})}),p=gn.create({adjustHeight:st(["table","delta","row"]),adjustWidth:st(["table","delta","column"]),startAdjust:st([])});return{destroy:function(){d.unbind(),g.unbind(),i.destroy(),gu(t)},refresh:function(m){ye(t,m,e,n)},on:i.on,off:i.off,hideBars:N(hl,t),showBars:N(vl,t),events:p.registry}}function Lu(t,n){return Kt(t.dom())/Kt(n.dom())*100+"%"}function ju(t,n){return M.table(t,n).bind(function(e){var r=M.cells(e);return zt(r,function(o){return A(t,o)}).map(function(o){return{index:h(o),all:h(r)}})})}function zu(t,n,e){var r=t.document.createRange();return function(o,i){i.fold(function(u){o.setStartBefore(u.dom())},function(u,c){o.setStart(u.dom(),c)},function(u){o.setStartAfter(u.dom())})}(r,n),function(o,i){i.fold(function(u){o.setEndBefore(u.dom())},function(u,c){o.setEnd(u.dom(),c)},function(u){o.setEndAfter(u.dom())})}(r,e),r}function Oe(t,n,e,r,o){var i=t.document.createRange();return i.setStart(n.dom(),e),i.setEnd(r.dom(),o),i}function Tf(t){return{left:h(t.left),top:h(t.top),right:h(t.right),bottom:h(t.bottom),width:h(t.width),height:h(t.height)}}function Hu(t,n,e){return n(v.fromDom(e.startContainer),e.startOffset,v.fromDom(e.endContainer),e.endOffset)}function zr(t,n){return function(e,r){var o=r.ltr();return o.collapsed?r.rtl().filter(function(i){return i.collapsed===!1}).map(function(i){return Vn.rtl(v.fromDom(i.endContainer),i.endOffset,v.fromDom(i.startContainer),i.startOffset)}).getOrThunk(function(){return Hu(0,Vn.ltr,o)}):Hu(0,Vn.ltr,o)}(0,function(e,r){return r.match({domRange:function(o){return{ltr:h(o),rtl:s.none}},relative:function(o,i){return{ltr:en(function(){return zu(e,o,i)}),rtl:en(function(){return s.some(zu(e,i,o))})}},exact:function(o,i,u,c){return{ltr:en(function(){return Oe(e,o,i,u,c)}),rtl:en(function(){return s.some(Oe(e,u,c,o,i))})}}})}(t,n))}function Fu(t,n,e){return n>=t.left&&n<=t.right&&e>=t.top&&e<=t.bottom}function Of(t,n,e,r,o){function i(a){var l=t.dom().createRange();return l.setStart(n.dom(),a),l.collapse(!0),l}var u=oe(n).length,c=function(a,l,f,d,g){if(g===0)return 0;if(l===d)return g-1;for(var p=d,m=1;m<g;m++){var b=a(m),w=Math.abs(l-b.left);if(f<=b.bottom){if(f<b.top||p<w)return m-1;p=w}}return 0}(function(a){return i(a).getBoundingClientRect()},e,r,o.right,u);return i(c)}function Uu(t,n){return n-t.left<t.right-n}function qu(t,n,e){var r=t.dom().createRange();return r.selectNode(n.dom()),r.collapse(e),r}function Df(t,n,e){var r=t.dom().createRange();r.selectNode(n.dom());var o=r.getBoundingClientRect(),i=Uu(o,e);return(i===!0?ie:Qe)(n).map(function(u){return qu(t,u,i)})}function Af(t,n,e){var r=n.dom().getBoundingClientRect(),o=Uu(r,e);return s.some(qu(t,n,o))}function Ef(t,n,e,r){var o=t.dom().createRange();o.selectNode(n.dom());var i=o.getBoundingClientRect();return function(u,c,a,l){var f=u.dom().createRange();f.selectNode(c.dom());var d=f.getBoundingClientRect(),g=Math.max(d.left,Math.min(d.right,a)),p=Math.max(d.top,Math.min(d.bottom,l));return ac(u,c,g,p)}(t,n,Math.max(i.left,Math.min(i.right,e)),Math.max(i.top,Math.min(i.bottom,r)))}function De(t,n){var e=I(t);return e==="input"?q.after(t):X(["br","img"],e)?n===0?q.before(t):q.after(t):q.on(t,n)}function Vu(t,n){var e=t.fold(q.before,De,q.after),r=n.fold(q.before,De,q.after);return jt.relative(e,r)}function Hr(t,n,e,r){var o=De(t,n),i=De(e,r);return jt.relative(o,i)}function Nf(t,n,e,r){var o=function(u,c,a,l){var f=Le(u).dom().createRange();return f.setStart(u.dom(),c),f.setEnd(a.dom(),l),f}(t,n,e,r),i=A(t,e)&&n===r;return o.collapsed&&!i}function Gu(t,n){s.from(t.getSelection()).each(function(e){e.removeAllRanges(),e.addRange(n)})}function Fr(t,n,e,r,o){var i=Oe(t,n,e,r,o);Gu(t,i)}function Yu(t,n){return zr(t,n).match({ltr:function(e,r,o,i){Fr(t,e,r,o,i)},rtl:function(e,r,o,i){var u=t.getSelection();if(u.setBaseAndExtent)u.setBaseAndExtent(e.dom(),r,o.dom(),i);else if(u.extend)try{(function(c,a,l,f,d,g){a.collapse(l.dom(),f),a.extend(d.dom(),g)})(0,u,e,r,o,i)}catch(c){Fr(t,o,i,e,r)}else Fr(t,o,i,e,r)}})}function Ku(t,n,e,r,o){var i=Hr(n,e,r,o);Yu(t,i)}function Xu(t,n,e){var r=Vu(n,e);Yu(t,r)}function kf(t){function n(o,i,u,c){return Oe(e,o,i,u,c)}var e=jt.getWin(t).dom(),r=function(o){return o.match({domRange:function(i){var u=v.fromDom(i.startContainer),c=v.fromDom(i.endContainer);return Hr(u,i.startOffset,c,i.endOffset)},relative:Vu,exact:Hr})}(t);return zr(e,r).match({ltr:n,rtl:n})}function If(t){var n=v.fromDom(t.anchorNode),e=v.fromDom(t.focusNode);return Nf(n,t.anchorOffset,e,t.focusOffset)?s.some(qn.create(n,t.anchorOffset,e,t.focusOffset)):function(r){if(0<r.rangeCount){var o=r.getRangeAt(0),i=r.getRangeAt(r.rangeCount-1);return s.some(qn.create(v.fromDom(o.startContainer),o.startOffset,v.fromDom(i.endContainer),i.endOffset))}return s.none()}(t)}function Bf(t,n){var e=function(r,o){var i=r.document.createRange();return Jf(i,o),i}(t,n);Gu(t,e)}function $u(t){return function(n){return s.from(n.getSelection()).filter(function(e){return 0<e.rangeCount}).bind(If)}(t).map(function(n){return jt.exact(n.start(),n.soffset(),n.finish(),n.foffset())})}function Pf(t,n){return function(e){var r=e.getClientRects(),o=0<r.length?r[0]:e.getBoundingClientRect();return 0<o.width||0<o.height?s.some(o).map(Tf):s.none()}(Vr(t,n))}function Mf(t,n,e){return function(r,o,i){var u=v.fromDom(r.document);return Qf(u,o,i).map(function(c){return qn.create(v.fromDom(c.startContainer),c.startOffset,v.fromDom(c.endContainer),c.endOffset)})}(t,n,e)}function Wf(t,n,e,r){return lc(t,n,Xf(e),r)}function _f(t,n,e,r){return lc(t,n,$f(e),r)}function Ju(t,n){var e=jt.exact(n,0,n,0);return kf(e)}function Lf(t,n){return function(e){return e.length===0?s.none():s.some(e[e.length-1])}(nt(n,"tr")).bind(function(e){return qt(e,"td,th").map(function(r){return Ju(0,r)})})}function Qu(t,n,e,r){return r===void 0&&(r=bn),t.property().parent(n).map(function(o){return Yr(o,r)})}function Zu(t){return function(n){return t.property().children(n).length===0}}function tc(t,n){return function(e,r,o){return mc(e,r,Zu(e),o)}(Ne,t,n)}function nc(t,n){return function(e,r,o){return gc(e,r,Zu(e),o)}(Ne,t,n)}function jf(t){return F(t,"tr")}function Ur(t){return I(t)==="br"}function zf(t,n,e,r){return function(o,i){return je(o,i).filter(Ur).orThunk(function(){return je(o,i-1).filter(Ur)})}(n,e).bind(function(o){return r.traverse(o).fold(function(){return $r(o,r.gather,t).map(r.relative)},function(i){return function(u){return lt(u).bind(function(c){var a=V(c);return us(a,u).map(function(l){return is(c,a,u,l)})})}(i).map(function(u){return q.on(u.parent(),u.index())})})})}function Ae(t){return et.nu({left:t.left,top:t.top,right:t.right,bottom:t.bottom})}function ec(t,n){return s.some(t.getRect(n))}function rc(t,n,e){return function(r,o,i){return qo(function(u,c){return c(u)},Pn,r,o,i)}(n,Er).fold(h(!1),function(r){return hc(t,r).exists(function(o){return function(i,u){return i.left()<u.left()||Math.abs(u.right()-i.left())<1||i.left()>u.right()}(e,o)})})}function oc(t,n,e){var r=t.move(e,5),o=Jr(n,t,e,r,100).getOr(r);return function(i,u,c){return i.point(u)>c.getInnerHeight()?s.some(i.point(u)-c.getInnerHeight()):i.point(u)<0?s.some(-i.point(u)):s.none()}(t,o,n).fold(function(){return n.situsFromPoint(o.left(),t.point(o))},function(i){return n.scrollBy(0,i),n.situsFromPoint(o.left(),t.point(o)-i)})}function Hf(t,n){return function(e,r,o){return Pn(e,r,o).isSome()}(t,function(e){return lt(e).exists(function(r){return A(r,n)})})}function ic(t,n,e,r,o){return F(r,"td,th",n).bind(function(i){return F(i,"table",n).bind(function(u){return Hf(o,u)?ds(t,n,e).bind(function(c){return F(c.finish(),"td,th",n).map(function(a){return{start:h(i),finish:h(a),range:h(c)}})}):s.none()})})}function uc(t,n){return F(t,"td,th",n)}var Ff=function(t,n,e){function r(){l.stop(),u.isOn()&&(u.off(),i.trigger.stop())}var o=!1,i=gn.create({start:st([]),stop:st([])}),u=Cf(),c=function(f,d){var g=null;return{cancel:function(){g!==null&&(O.clearTimeout(g),g=null)},throttle:function(){for(var p=[],m=0;m<arguments.length;m++)p[m]=arguments[m];g!==null&&O.clearTimeout(g),g=O.setTimeout(function(){f.apply(null,p),g=null},d)}}}(r,200);u.events.move.bind(function(f){n.mutate(t,f.info())});function a(f){return function(){for(var d=[],g=0;g<arguments.length;g++)d[g]=arguments[g];o&&f.apply(null,d)}}var l=n.sink(bf({forceDrop:r,drop:a(r),move:a(function(f){c.cancel(),u.onEvent(f,n)}),delayDrop:a(c.throttle)}),e);return{element:l.element,go:function(f){l.start(f),u.on(),i.trigger.start()},on:function(){o=!0},off:function(){o=!1},destroy:function(){l.destroy()},events:i.registry}},Uf=function(t,n){n===void 0&&(n={});var e=n.mode!==void 0?n.mode:wf;return Ff(t,e,n)},qf=we.resolve("resizer-bar-dragging"),Vf=function(t,n){var e=de.height,r=Rf(t,n,e),o=gn.create({beforeResize:st(["table"]),afterResize:st(["table"]),startDrag:st([])});return r.events.adjustHeight.bind(function(i){o.trigger.beforeResize(i.table());var u=e.delta(i.delta(),i.table());Ml(i.table(),u,i.row(),e),o.trigger.afterResize(i.table())}),r.events.startAdjust.bind(function(i){o.trigger.startDrag()}),r.events.adjustWidth.bind(function(i){o.trigger.beforeResize(i.table());var u=n.delta(i.delta(),i.table());Pl(i.table(),u,i.column(),n),o.trigger.afterResize(i.table())}),{on:r.on,off:r.off,hideBars:r.hideBars,showBars:r.showBars,destroy:r.destroy,events:o.registry}},Gf=function(t,n){return t.inline?mf($t(t),function(){var e=v.fromTag("div");return En(e,{position:"static",height:"0",width:"0",padding:"0",margin:"0",border:"0"}),j(zc(),e),e}()):Wu(v.fromDom(t.getDoc()))},Yf=function(t,n){t.inline&&it(n.parent())},Kf=function(t){function n(f){return f.nodeName==="TABLE"}function e(f){var d=t.dom.getStyle(f,"width")||t.dom.getAttrib(f,"width");return s.from(d).filter(function(g){return 0<g.length})}function r(){return c}var o,i,u=s.none(),c=s.none(),a=s.none(),l=/(\d+(\.\d+)?)%/;return t.on("init",function(){var f=Ei(kr.directionAt),d=Gf(t);if(a=s.some(d),function(p){var m=p.getParam("object_resizing",!0);return Ft(m)?m==="table":m}(t)&&function(p){return p.getParam("table_resize_bars",!0,"boolean")}(t)){var g=Vf(d,f);g.on(),g.events.startDrag.bind(function(p){u=s.some(t.selection.getRng())}),g.events.beforeResize.bind(function(p){var m=p.table().dom();eu(t,m,Kt(m),Qi(m))}),g.events.afterResize.bind(function(p){var m=p.table(),b=m.dom();br(m),u.each(function(w){t.selection.setRng(w),t.focus()}),ru(t,b,Kt(b),Qi(b)),t.undoManager.add()}),c=s.some(g)}}),t.on("ObjectResizeStart",function(f){var d=f.target;if(n(d)){var g=e(d).map(function(p){return l.test(p)}).getOr(!1);g&&Sr(t)?function(p){Y(v.fromDom(p),"width",Kt(p).toString()+"px")}(d):!g&&function(p){return p.getParam("table_responsive_width")===!0}(t)&&function(p){var m=v.fromDom(p);lt(m).map(function(b){return Lu(m,b)}).each(function(b){Y(m,"width",b),x(nt(m,"tr"),function(w){x(V(w),function(R){Y(R,"width",Lu(R,w))})})})}(d),o=f.width,i=e(d).getOr("")}}),t.on("ObjectResized",function(f){var d=f.target;if(n(d)){var g=d;if(l.test(i)){var p=parseFloat(l.exec(i)[1]),m=f.width*p/o;t.dom.setStyle(g,"width",m+"%")}else{var b=[];Z.each(g.rows,function(w){Z.each(w.cells,function(R){var E=t.dom.getStyle(R,"width",!0);b.push({cell:R,width:E})})}),Z.each(b,function(w){t.dom.setStyle(w.cell,"width",w.width),t.dom.setAttrib(w.cell,"width",null)})}}}),t.on("SwitchMode",function(){r().each(function(f){t.readonly?f.hideBars():f.showBars()})}),{lazyResize:r,lazyWire:function(){return a.getOr(Wu(v.fromDom(t.getBody())))},destroy:function(){c.each(function(f){f.destroy()}),a.each(function(f){Yf(t,f)})}}},cc=Wt([{none:["current"]},{first:["current"]},{middle:["current","target"]},{last:["current"]}]),pn=k(k({},cc),{none:function(t){return t===void 0&&(t=void 0),cc.none(t)}}),Xf=function(t,n){return ju(t,n).fold(function(){return pn.none(t)},function(e){return e.index()+1<e.all().length?pn.middle(t,e.all()[e.index()+1]):pn.last(t)})},$f=function(t,n){return ju(t,n).fold(function(){return pn.none()},function(e){return 0<=e.index()-1?pn.middle(t,e.all()[e.index()-1]):pn.first(t)})},qn={create:D("start","soffset","finish","foffset")},qr=Wt([{before:["element"]},{on:["element","offset"]},{after:["element"]}]),q={before:qr.before,on:qr.on,after:qr.after,cata:function(t,n,e,r){return t.fold(n,e,r)},getStart:function(t){return t.fold(dt,dt,dt)}},Ee=Wt([{domRange:["rng"]},{relative:["startSitu","finishSitu"]},{exact:["start","soffset","finish","foffset"]}]),jt={domRange:Ee.domRange,relative:Ee.relative,exact:Ee.exact,exactFromRange:function(t){return Ee.exact(t.start(),t.soffset(),t.finish(),t.foffset())},getWin:function(t){return function(n){return v.fromDom(n.dom().ownerDocument.defaultView)}(function(n){return n.match({domRange:function(e){return v.fromDom(e.startContainer)},relative:function(e,r){return q.getStart(e)},exact:function(e,r,o,i){return e}})}(t))},range:qn.create},Jf=function(t,n){t.selectNodeContents(n.dom())},Vn=Wt([{ltr:["start","soffset","finish","foffset"]},{rtl:["start","soffset","finish","foffset"]}]),Vr=function(t,n){return zr(t,n).match({ltr:function(e,r,o,i){var u=t.document.createRange();return u.setStart(e.dom(),r),u.setEnd(o.dom(),i),u},rtl:function(e,r,o,i){var u=t.document.createRange();return u.setStart(o.dom(),i),u.setEnd(e.dom(),r),u}})},ac=(Vn.ltr,Vn.rtl,function(t,n,e,r){return Pt(n)?function(o,i,u,c){var a=o.dom().createRange();a.selectNode(i.dom());var l=a.getClientRects();return Zt(l,function(f){return Fu(f,u,c)?s.some(f):s.none()}).map(function(f){return Of(o,i,u,c,f)})}(t,n,e,r):function(o,i,u,c){var a=o.dom().createRange(),l=V(i);return Zt(l,function(f){return a.selectNode(f.dom()),Fu(a.getBoundingClientRect(),u,c)?ac(o,f,u,c):s.none()})}(t,n,e,r)}),Qf=document.caretPositionFromPoint?function(t,n,e){return s.from(t.dom().caretPositionFromPoint(n,e)).bind(function(r){if(r.offsetNode===null)return s.none();var o=t.dom().createRange();return o.setStart(r.offsetNode,r.offset),o.collapse(),s.some(o)})}:document.caretRangeFromPoint?function(t,n,e){return s.from(t.dom().caretRangeFromPoint(n,e))}:function(t,n,e){return v.fromPoint(t,n,e).bind(function(r){function o(){return function(i,u,c){return(V(u).length===0?Af:Df)(i,u,c)}(t,r,n)}return V(r).length===0?o():Ef(t,r,n,e).orThunk(o)})},Zf=tinymce.util.Tools.resolve("tinymce.util.VK"),lc=function(t,n,e,r,o){return e.fold(s.none,s.none,function(i,u){return ie(u).map(function(c){return Ju(0,c)})},function(i){return M.table(i,n).bind(function(u){var c=Gt.noMenu(i);return t.undoManager.transact(function(){r.insertRowsAfter(u,c)}),Lf(0,u)})})},ts=["table","li","dl"],ns={handle:function(t,n,e,r){if(t.keyCode===Zf.TAB){var o=$t(n),i=function(a){var l=I(a);return A(a,o)||X(ts,l)},u=n.selection.getRng();if(u.collapsed){var c=v.fromDom(u.startContainer);M.cell(c,i).each(function(a){t.preventDefault(),(t.shiftKey?_f:Wf)(n,i,a,e,r).each(function(l){n.selection.setRng(l)})})}}}},hn={create:D("selection","kill")},fc=function(t,n,e,r){return{start:h(q.on(t,n)),finish:h(q.on(e,r))}},vn={convertToRange:function(t,n){var e=Vr(t,n);return qn.create(v.fromDom(e.startContainer),e.startOffset,v.fromDom(e.endContainer),e.endOffset)},makeSitus:fc},sc=function(t,n,e,r,o){return A(e,r)?s.none():ir(e,r,n).bind(function(i){var u=i.boxes().getOr([]);return 0<u.length?(o(t,u,i.start(),i.finish()),s.some(hn.create(s.some(vn.makeSitus(e,0,e,Mt(e))),!0))):s.none()})},Gr={sync:function(t,n,e,r,o,i,u){return A(e,o)&&r===i?s.none():F(e,"td,th",n).bind(function(c){return F(o,"td,th",n).bind(function(a){return sc(t,n,c,a,u)})})},detect:sc,update:function(t,n,e,r,o){return Ta(r,t,n,o.firstSelectedSelector(),o.lastSelectedSelector()).map(function(i){return o.clearBeforeUpdate(e),o.selectRange(e,i.boxes(),i.start(),i.finish()),i.boxes()})}},Yr=D("item","mode"),bn=function(t,n,e,r){return r===void 0&&(r=Gn),e.sibling(t,n).map(function(o){return Yr(o,r)})},Gn=function(t,n,e,r){r===void 0&&(r=Gn);var o=t.property().children(n);return e.first(o).map(function(i){return Yr(i,r)})},es=[{current:Qu,next:bn,fallback:s.none()},{current:bn,next:Gn,fallback:s.some(Qu)},{current:Gn,next:Gn,fallback:s.some(bn)}],dc=function(t,n,e,r,o){return o===void 0&&(o=es),Ct(o,function(i){return i.current===e}).bind(function(i){return i.current(t,n,r,i.next).orThunk(function(){return i.fallback.bind(function(u){return dc(t,n,u,r)})})})},rs=function(){return{sibling:function(t,n){return t.query().prevSibling(n)},first:function(t){return 0<t.length?s.some(t[t.length-1]):s.none()}}},os=function(){return{sibling:function(t,n){return t.query().nextSibling(n)},first:function(t){return 0<t.length?s.some(t[0]):s.none()}}},Kr=function(t,n,e,r,o,i){return dc(t,n,r,o).bind(function(u){return i(u.item())?s.none():e(u.item())?s.some(u.item()):Kr(t,u.item(),e,u.mode(),o,i)})},mc=function(t,n,e,r){return Kr(t,n,e,bn,rs(),r)},gc=function(t,n,e,r){return Kr(t,n,e,bn,os(),r)},Ne=er(),Xr=D("element","offset"),ke=(D("element","deltaOffset"),D("element","start","finish"),D("begin","end"),D("element","text"),Wt([{none:["message"]},{success:[]},{failedUp:["cell"]},{failedDown:["cell"]}])),wn=k(k({},ke),{verify:function(t,n,e,r,o,i,u){return F(r,"td,th",u).bind(function(c){return F(n,"td,th",u).map(function(a){return A(c,a)?A(r,c)&&Mt(c)===o?i(a):ke.none("in same cell"):ae.sharedOne(jf,[c,a]).fold(function(){return function(l,f,d){var g=l.getRect(f),p=l.getRect(d);return p.right>g.left&&p.left<g.right}(t,a,c)?ke.success():i(a)},function(l){return i(a)})})}).getOr(ke.none("default"))},cata:function(t,n,e,r,o){return t.fold(n,e,r,o)}}),is=(D("ancestor","descendants","element","index"),D("parent","children","element","index")),us=function(t,n){return zt(t,N(A,n))},$r=function(t,n,e){return n(t,e).bind(function(r){return Pt(r)&&oe(r).trim().length===0?$r(r,n,e):s.some(r)})},cs=function(t,n,e,r){return(Ur(n)?function(o,i,u){return u.traverse(i).orThunk(function(){return $r(i,u.gather,o)}).map(u.relative)}(t,n,r):zf(t,n,e,r)).map(function(o){return{start:h(o),finish:h(o)}})},as=function(t){return wn.cata(t,function(n){return s.none()},function(){return s.none()},function(n){return s.some(Xr(n,0))},function(n){return s.some(Xr(n,Mt(n)))})},yn=Ue(["left","top","right","bottom"],[]),et={nu:yn,moveUp:function(t,n){return yn({left:t.left(),top:t.top()-n,right:t.right(),bottom:t.bottom()-n})},moveDown:function(t,n){return yn({left:t.left(),top:t.top()+n,right:t.right(),bottom:t.bottom()+n})},moveBottomTo:function(t,n){var e=t.bottom()-t.top();return yn({left:t.left(),top:n-e,right:t.right(),bottom:n})},moveTopTo:function(t,n){var e=t.bottom()-t.top();return yn({left:t.left(),top:n,right:t.right(),bottom:n+e})},getTop:function(t){return t.top()},getBottom:function(t){return t.bottom()},translate:function(t,n,e){return yn({left:t.left()+n,top:t.top()+e,right:t.right()+n,bottom:t.bottom()+e})},toString:function(t){return"("+t.left()+", "+t.top()+") -> ("+t.right()+", "+t.bottom()+")"}},pc=function(t,n,e){return cn(n)?ec(t,n).map(Ae):Pt(n)?function(r,o,i){return 0<=i&&i<Mt(o)?r.getRangedRect(o,i,o,i+1):0<i?r.getRangedRect(o,i-1,o,i):s.none()}(t,n,e).map(Ae):s.none()},hc=function(t,n){return cn(n)?ec(t,n).map(Ae):Pt(n)?t.getRangedRect(n,0,n,Mt(n)).map(Ae):s.none()},bt=Wt([{none:[]},{retry:["caret"]}]),ls={point:et.getTop,adjuster:function(t,n,e,r,o){var i=et.moveUp(o,5);return Math.abs(e.top()-r.top())<1||e.bottom()<o.top()?bt.retry(i):e.bottom()===o.top()?bt.retry(et.moveUp(o,1)):rc(t,n,o)?bt.retry(et.translate(i,5,0)):bt.none()},move:et.moveUp,gather:tc},fs={point:et.getBottom,adjuster:function(t,n,e,r,o){var i=et.moveDown(o,5);return Math.abs(e.bottom()-r.bottom())<1||e.top()>o.bottom()?bt.retry(i):e.top()===o.bottom()?bt.retry(et.moveDown(o,1)):rc(t,n,o)?bt.retry(et.translate(i,5,0)):bt.none()},move:et.moveDown,gather:nc},Jr=function(t,n,e,r,o){return o===0?s.some(r):function(i,u,c){return i.elementFromPoint(u,c).filter(function(a){return I(a)==="table"}).isSome()}(t,r.left(),n.point(r))?function(i,u,c,a,l){return Jr(i,u,c,u.move(a,5),l)}(t,n,e,r,o-1):t.situsFromPoint(r.left(),n.point(r)).bind(function(i){return i.start().fold(s.none,function(u){return hc(t,u).bind(function(c){return n.adjuster(t,u,c,e,r).fold(s.none,function(a){return Jr(t,n,e,a,o-1)})}).orThunk(function(){return s.some(r)})},s.none)})},Yn={tryUp:N(oc,ls),tryDown:N(oc,fs),ieTryUp:function(t,n){return t.situsFromPoint(n.left(),n.top()-5)},ieTryDown:function(t,n){return t.situsFromPoint(n.left(),n.bottom()+5)},getJumpSize:h(5)},Kn=Nn(),Qr=function(t,n,e,r,o,i){return i===0?s.none():ss(t,n,e,r,o).bind(function(u){var c=t.fromSitus(u),a=wn.verify(t,e,r,c.finish(),c.foffset(),o.failure,n);return wn.cata(a,function(){return s.none()},function(){return s.some(u)},function(l){return A(e,l)&&r===0?vc(t,e,r,et.moveUp,o):Qr(t,n,l,0,o,i-1)},function(l){return A(e,l)&&r===Mt(l)?vc(t,e,r,et.moveDown,o):Qr(t,n,l,Mt(l),o,i-1)})})},vc=function(t,n,e,r,o){return pc(t,n,e).bind(function(i){return bc(t,o,r(i,Yn.getJumpSize()))})},bc=function(t,n,e){return Kn.browser.isChrome()||Kn.browser.isSafari()||Kn.browser.isFirefox()||Kn.browser.isEdge()?n.otherRetry(t,e):Kn.browser.isIE()?n.ieRetry(t,e):s.none()},ss=function(t,n,e,r,o){return pc(t,e,r).bind(function(i){return bc(t,o,i)})},ds=function(t,n,e){return function(r,o,i){return r.getSelection().bind(function(u){return cs(o,u.finish(),u.foffset(),i).fold(function(){return s.some(Xr(u.finish(),u.foffset()))},function(c){var a=r.fromSitus(c),l=wn.verify(r,u.finish(),u.foffset(),a.finish(),a.foffset(),i.failure,o);return as(l)})})}(t,n,e).bind(function(r){return Qr(t,n,r.element(),r.offset(),e,20).map(t.fromSitus)})},ms=Nn(),wc=function(t,n,e,r,o,i){return ms.browser.isIE()?s.none():i(r,n).orThunk(function(){return ic(t,n,e,r,o).map(function(u){var c=u.range();return hn.create(s.some(vn.makeSitus(c.start(),c.soffset(),c.finish(),c.foffset())),!0)})})},yc=function(t,n,e,r,o,i,u){return ic(t,e,r,o,i).bind(function(c){return Gr.detect(n,e,c.start(),c.finish(),u)})},gs=function(t,n){return F(t,"tr",n).bind(function(e){return F(e,"table",n).bind(function(r){var o=nt(r,"tr");return A(e,o[0])?function(i,u,c){return mc(Ne,i,u,c)}(r,function(i){return Qe(i).isSome()},n).map(function(i){var u=Mt(i);return hn.create(s.some(vn.makeSitus(i,u,i,u)),!0)}):s.none()})})},ps=function(t,n){return F(t,"tr",n).bind(function(e){return F(e,"table",n).bind(function(r){var o=nt(r,"tr");return A(e,o[o.length-1])?function(i,u,c){return gc(Ne,i,u,c)}(r,function(i){return ie(i).isSome()},n).map(function(i){return hn.create(s.some(vn.makeSitus(i,0,i,0)),!0)}):s.none()})})};function Cn(t){return function(n){return n===t}}function Zr(t){return{elementFromPoint:function(n,e){return v.fromPoint(v.fromDom(t.document),n,e)},getRect:function(n){return n.dom().getBoundingClientRect()},getRangedRect:function(n,e,r,o){var i=jt.exact(n,e,r,o);return Pf(t,i).map(ws)},getSelection:function(){return $u(t).map(function(n){return vn.convertToRange(t,n)})},fromSitus:function(n){var e=jt.relative(n.start(),n.finish());return vn.convertToRange(t,e)},situsFromPoint:function(n,e){return Mf(t,n,e).map(function(r){return fc(r.start(),r.soffset(),r.finish(),r.foffset())})},clearSelection:function(){(function(n){n.getSelection().removeAllRanges()})(t)},collapseSelection:function(n){n===void 0&&(n=!1),$u(t).each(function(e){return e.fold(function(r){return r.collapse(n)},function(r,o){var i=n?r:o;Xu(t,i,i)},function(r,o,i,u){var c=n?r:i,a=n?o:u;Ku(t,c,a,c,a)})})},setSelection:function(n){Ku(t,n.start(),n.soffset(),n.finish(),n.foffset())},setRelativeSelection:function(n,e){Xu(t,n,e)},selectContents:function(n){Bf(t,n)},getInnerHeight:function(){return t.innerHeight},getScrollY:function(){return function(n){var e=n!==void 0?n.dom():O.document,r=e.body.scrollLeft||e.documentElement.scrollLeft,o=e.body.scrollTop||e.documentElement.scrollTop;return Ot(r,o)}(v.fromDom(t.document)).top()},scrollBy:function(n,e){(function(r,o,i){(i!==void 0?i.dom():O.document).defaultView.scrollBy(r,o)})(n,e,v.fromDom(t.document))}}}function hs(t,n){x(n,function(e){(function(r,o){ge(r)?r.dom().classList.remove(o):qa(r,o),Va(r)})(t,e)})}var Ie={down:{traverse:Zn,gather:nc,relative:q.before,otherRetry:Yn.tryDown,ieRetry:Yn.ieTryDown,failure:wn.failedDown},up:{traverse:xo,gather:tc,relative:q.before,otherRetry:Yn.tryUp,ieRetry:Yn.ieTryUp,failure:wn.failedUp}},vs=Cn(38),bs=Cn(40),ut={ltr:{isBackward:Cn(37),isForward:Cn(39)},rtl:{isBackward:Cn(39),isForward:Cn(37)},isUp:vs,isDown:bs,isNavigation:function(t){return 37<=t&&t<=40}},ws=function(t){return{left:t.left(),top:t.top(),right:t.right(),bottom:t.bottom(),width:t.width(),height:t.height()}},Sn=(Nn().browser.isSafari(),D("rows","cols")),to={mouse:function(t,n,e,r){var o=function(u,c,a,l){function f(){d=s.none()}var d=s.none();return{mousedown:function(g){l.clear(c),d=uc(g.target(),a)},mouseover:function(g){d.each(function(p){l.clearBeforeUpdate(c),uc(g.target(),a).each(function(m){ir(p,m,a).each(function(b){var w=b.boxes().getOr([]);(1<w.length||w.length===1&&!A(p,m))&&(l.selectRange(c,w,b.start(),b.finish()),u.selectContents(m))})})})},mouseup:function(g){d.each(f)}}}(Zr(t),n,e,r);return{mousedown:o.mousedown,mouseover:o.mouseover,mouseup:o.mouseup}},keyboard:function(t,n,e,r){function o(){return r.clear(n),s.none()}var i=Zr(t);return{keydown:function(u,c,a,l,f,d){var g=u.raw(),p=g.which,m=g.shiftKey===!0;return ur(n,r.selectedSelector()).fold(function(){return ut.isDown(p)&&m?N(yc,i,n,e,Ie.down,l,c,r.selectRange):ut.isUp(p)&&m?N(yc,i,n,e,Ie.up,l,c,r.selectRange):ut.isDown(p)?N(wc,i,e,Ie.down,l,c,ps):ut.isUp(p)?N(wc,i,e,Ie.up,l,c,gs):s.none},function(b){function w(R){return function(){return Zt(R,function(E){return Gr.update(E.rows(),E.cols(),n,b,r)}).fold(function(){return li(n,r.firstSelectedSelector(),r.lastSelectedSelector()).map(function(E){var _=ut.isDown(p)||d.isForward(p)?q.after:q.before;return i.setRelativeSelection(q.on(E.first(),0),_(E.table())),r.clear(n),hn.create(s.none(),!0)})},function(E){return s.some(hn.create(s.none(),!0))})}}return ut.isDown(p)&&m?w([Sn(1,0)]):ut.isUp(p)&&m?w([Sn(-1,0)]):d.isBackward(p)&&m?w([Sn(0,-1),Sn(-1,0)]):d.isForward(p)&&m?w([Sn(0,1),Sn(1,0)]):ut.isNavigation(p)&&m==!1?o:s.none})()},keyup:function(u,c,a,l,f){return ur(n,r.selectedSelector()).fold(function(){var d=u.raw(),g=d.which;return d.shiftKey!==!0?s.none():ut.isNavigation(g)?Gr.sync(n,e,c,a,l,f,r.selectRange):s.none()},s.none)}}},external:function(t,n,e,r){var o=Zr(t);return function(i,u){r.clearBeforeUpdate(n),ir(i,u,e).each(function(c){var a=c.boxes().getOr([]);r.selectRange(n,a,c.start(),c.finish()),o.selectContents(u),o.collapseSelection()})}}},ys={byClass:function(t){function n(o){var i=nt(o,t.selectedSelector());x(i,r)}var e=function(o){return function(i){Dt(i,o)}}(t.selected()),r=function(o){return function(i){hs(i,o)}}([t.selected(),t.lastSelected(),t.firstSelected()]);return{clearBeforeUpdate:n,clear:n,selectRange:function(o,i,u,c){n(o),x(i,e),Dt(u,t.firstSelected()),Dt(c,t.lastSelected())},selectedSelector:t.selectedSelector,firstSelectedSelector:t.firstSelectedSelector,lastSelectedSelector:t.lastSelectedSelector}},byAttr:function(t,n,e){function r(c){H(c,t.selected()),H(c,t.firstSelected()),H(c,t.lastSelected())}function o(c){tt(c,t.selected(),"1")}function i(c){u(c),e()}var u=function(c){var a=nt(c,t.selectedSelector());x(a,r)};return{clearBeforeUpdate:u,clear:i,selectRange:function(c,a,l,f){i(c),x(a,o),tt(l,t.firstSelected(),"1"),tt(f,t.lastSelected(),"1"),n(a,l,f)},selectedSelector:t.selectedSelector,firstSelectedSelector:t.firstSelectedSelector,lastSelectedSelector:t.lastSelectedSelector}}},Cs={getOtherCells:function(t,n,e){var r=Tt(t),o=B.generate(r);return _t(o,n).map(function(i){var u=Fn(o,e,!1);return{upOrLeftCells:function(c,a,l){var f=c.slice(0,a[a.length-1].row()+1),d=pe(f,l);return gt(d,function(g){var p=g.cells().slice(0,a[a.length-1].column()+1);return C(p,function(m){return m.element()})})}(u,i,e),downOrRightCells:function(c,a,l){var f=c.slice(a[0].row()+a[0].rowspan()-1,c.length),d=pe(f,l);return gt(d,function(g){var p=g.cells().slice(a[0].column()+a[0].colspan()-1,+g.cells().length);return C(p,function(m){return m.element()})})}(u,i,e)}})}},no=function(t){return mr(v.fromDom(t.target),"ephox-snooker-resizer-bar")===!1};function Ss(t,n,e){var r=Ue(["mousedown","mouseover","mouseup","keyup","keydown"],[]),o=s.none(),i=Ou(t),u=ys.byAttr(Vt,function(c,a,l){e.targets().each(function(f){M.table(a).each(function(d){var g=v.fromDom(t.getDoc()),p=Wn.cellOperations(y,g,i),m=Cs.getOtherCells(d,f,p);$l(t,c,a,l,m)})})},function(){Jl(t)});return t.on("init",function(c){var a=t.getWin(),l=$t(t),f=Tu(t),d=to.mouse(a,l,f,u),g=to.keyboard(a,l,f,u),p=to.external(a,l,f,u);t.on("TableSelectorChange",function(T){p(T.start,T.finish)});function m(T,P){!function(L){return L.raw().shiftKey===!0}(T)||(P.kill()&&T.kill(),P.selection().each(function(L){var kt=jt.relative(L.start(),L.finish()),Qt=Vr(a,kt);t.selection.setRng(Qt)}))}function b(T){var P=Jt(T);if(P.raw().shiftKey&&ut.isNavigation(P.raw().which)){var L=t.selection.getRng(),kt=v.fromDom(L.startContainer),Qt=v.fromDom(L.endContainer);g.keyup(P,kt,L.startOffset,Qt,L.endOffset).each(function(eo){m(P,eo)})}}function w(T){var P=Jt(T);n().each(function($n){$n.hideBars()});var L=t.selection.getRng(),kt=v.fromDom(t.selection.getStart()),Qt=v.fromDom(L.startContainer),eo=v.fromDom(L.endContainer),Es=kr.directionAt(kt).isRtl()?ut.rtl:ut.ltr;g.keydown(P,Qt,L.startOffset,eo,L.endOffset,Es).each(function($n){m(P,$n)}),n().each(function($n){$n.showBars()})}function R(T){return T.hasOwnProperty("x")&&T.hasOwnProperty("y")}function E(T){return T.button===0}function _(T){E(T)&&no(T)&&d.mousedown(Jt(T))}function Et(T){(function(P){return P.buttons===void 0||(1&P.buttons)!=0})(T)&&no(T)&&d.mouseover(Jt(T))}function Nt(T){E(T)&&no(T)&&d.mouseup(Jt(T))}var wt,Xn,Jt=function(T){function P(){T.stopPropagation()}function L(){T.preventDefault()}var kt=v.fromDom(T.target),Qt=ro(L,P);return{target:h(kt),x:h(R(T)?T.x:null),y:h(R(T)?T.y:null),stop:P,prevent:L,kill:Qt,raw:h(T)}},As=(wt=mt(v.fromDom(l)),Xn=mt(0),{touchEnd:function(T){var P=v.fromDom(T.target);if(I(P)==="td"||I(P)==="th"){var L=wt.get(),kt=Xn.get();A(L,P)&&T.timeStamp-kt<300&&(T.preventDefault(),p(P,P))}wt.set(P),Xn.set(T.timeStamp)}});t.on("mousedown",_),t.on("mouseover",Et),t.on("mouseup",Nt),t.on("touchend",As.touchEnd),t.on("keyup",b),t.on("keydown",w),t.on("NodeChange",function(){var T=t.selection,P=v.fromDom(T.getStart()),L=v.fromDom(T.getEnd());ae.sharedOne(M.table,[P,L]).fold(function(){u.clear(l)},y)}),o=s.some(r({mousedown:_,mouseover:Et,mouseup:Nt,keyup:b,keydown:w}))}),{clear:u.clear,destroy:function(){o.each(function(c){})}}}var xs=function(t){return{get:function(){var n=$t(t);return Oa(n,Vt.selectedSelector()).fold(function(){return t.selection.getStart()===void 0?fn.none():fn.single(t.selection)},function(e){return fn.multiple(e)})}}},Rs=function(t,n){function e(){return Pu(t).bind(function(c){return M.table(c).map(function(a){return I(c)==="caption"?Gt.notCell(c):Gt.forMenu(n,a,c)})})}function r(){i.set(en(e)()),x(u.get(),function(c){return c()})}function o(c,a){function l(){return i.get().fold(function(){c.setDisabled(!0)},function(f){c.setDisabled(a(f))})}return l(),u.set(u.get().concat([l])),function(){u.set(ot(u.get(),function(f){return f!==l}))}}var i=mt(s.none()),u=mt([]);return t.on("NodeChange TableSelectorChange",r),{onSetupTable:function(c){return o(c,function(a){return!1})},onSetupCellOrRow:function(c){return o(c,function(a){return I(a.element())==="caption"})},onSetupMergeable:function(c){return o(c,function(a){return a.mergable().isNone()})},onSetupUnmergeable:function(c){return o(c,function(a){return a.unmergable().isNone()})},resetTargets:r,targets:function(){return i.get()}}},Cc={addButtons:function(t,n){t.ui.registry.addMenuButton("table",{tooltip:"Table",icon:"table",fetch:function(r){return r("inserttable | cell row column | advtablesort | tableprops deletetable")}});function e(r){return function(){return t.execCommand(r)}}t.ui.registry.addButton("tableprops",{tooltip:"Table properties",onAction:e("mceTableProps"),icon:"table",onSetup:n.onSetupTable}),t.ui.registry.addButton("tabledelete",{tooltip:"Delete table",onAction:e("mceTableDelete"),icon:"table-delete-table",onSetup:n.onSetupTable}),t.ui.registry.addButton("tablecellprops",{tooltip:"Cell properties",onAction:e("mceTableCellProps"),icon:"table-cell-properties",onSetup:n.onSetupCellOrRow}),t.ui.registry.addButton("tablemergecells",{tooltip:"Merge cells",onAction:e("mceTableMergeCells"),icon:"table-merge-cells",onSetup:n.onSetupMergeable}),t.ui.registry.addButton("tablesplitcells",{tooltip:"Split cell",onAction:e("mceTableSplitCells"),icon:"table-split-cells",onSetup:n.onSetupUnmergeable}),t.ui.registry.addButton("tableinsertrowbefore",{tooltip:"Insert row before",onAction:e("mceTableInsertRowBefore"),icon:"table-insert-row-above",onSetup:n.onSetupCellOrRow}),t.ui.registry.addButton("tableinsertrowafter",{tooltip:"Insert row after",onAction:e("mceTableInsertRowAfter"),icon:"table-insert-row-after",onSetup:n.onSetupCellOrRow}),t.ui.registry.addButton("tabledeleterow",{tooltip:"Delete row",onAction:e("mceTableDeleteRow"),icon:"table-delete-row",onSetup:n.onSetupCellOrRow}),t.ui.registry.addButton("tablerowprops",{tooltip:"Row properties",onAction:e("mceTableRowProps"),icon:"table-row-properties",onSetup:n.onSetupCellOrRow}),t.ui.registry.addButton("tableinsertcolbefore",{tooltip:"Insert column before",onAction:e("mceTableInsertColBefore"),icon:"table-insert-column-before",onSetup:n.onSetupCellOrRow}),t.ui.registry.addButton("tableinsertcolafter",{tooltip:"Insert column after",onAction:e("mceTableInsertColAfter"),icon:"table-insert-column-after",onSetup:n.onSetupCellOrRow}),t.ui.registry.addButton("tabledeletecol",{tooltip:"Delete column",onAction:e("mceTableDeleteCol"),icon:"table-delete-column",onSetup:n.onSetupCellOrRow}),t.ui.registry.addButton("tablecutrow",{tooltip:"Cut row",onAction:e("mceTableCutRow"),icon:"temporary-placeholder",onSetup:n.onSetupCellOrRow}),t.ui.registry.addButton("tablecopyrow",{tooltip:"Copy row",onAction:e("mceTableCopyRow"),icon:"temporary-placeholder",onSetup:n.onSetupCellOrRow}),t.ui.registry.addButton("tablepasterowbefore",{tooltip:"Paste row before",onAction:e("mceTablePasteRowBefore"),icon:"temporary-placeholder",onSetup:n.onSetupCellOrRow}),t.ui.registry.addButton("tablepasterowafter",{tooltip:"Paste row after",onAction:e("mceTablePasteRowAfter"),icon:"temporary-placeholder",onSetup:n.onSetupCellOrRow}),t.ui.registry.addButton("tableinsertdialog",{tooltip:"Insert table",onAction:e("mceInsertTable"),icon:"table"})},addToolbars:function(t){var n=function(e){return e.getParam("table_toolbar","tableprops tabledelete | tableinsertrowbefore tableinsertrowafter tabledeleterow | tableinsertcolbefore tableinsertcolafter tabledeletecol")}(t);0<n.length&&t.ui.registry.addContextToolbar("table",{predicate:function(e){return t.dom.is(e,"table")&&t.getBody().contains(e)},items:n,scope:"node",position:"node"})}},Ts={addMenuItems:function(t,n){function e(g){return function(){return t.execCommand(g)}}function r(g){var p=g.numRows,m=g.numColumns;t.undoManager.transact(function(){_r(t,m,p)}),t.addVisual()}var o={text:"Table properties",onSetup:n.onSetupTable,onAction:e("mceTableProps")},i={text:"Delete table",icon:"table-delete-table",onSetup:n.onSetupTable,onAction:e("mceTableDelete")},u=[{type:"menuitem",text:"Insert row before",icon:"table-insert-row-above",onAction:e("mceTableInsertRowBefore"),onSetup:n.onSetupCellOrRow},{type:"menuitem",text:"Insert row after",icon:"table-insert-row-after",onAction:e("mceTableInsertRowAfter"),onSetup:n.onSetupCellOrRow},{type:"menuitem",text:"Delete row",icon:"table-delete-row",onAction:e("mceTableDeleteRow"),onSetup:n.onSetupCellOrRow},{type:"menuitem",text:"Row properties",icon:"table-row-properties",onAction:e("mceTableRowProps"),onSetup:n.onSetupCellOrRow},{type:"separator"},{type:"menuitem",text:"Cut row",onAction:e("mceTableCutRow"),onSetup:n.onSetupCellOrRow},{type:"menuitem",text:"Copy row",onAction:e("mceTableCopyRow"),onSetup:n.onSetupCellOrRow},{type:"menuitem",text:"Paste row before",onAction:e("mceTablePasteRowBefore"),onSetup:n.onSetupCellOrRow},{type:"menuitem",text:"Paste row after",onAction:e("mceTablePasteRowAfter"),onSetup:n.onSetupCellOrRow}],c={type:"nestedmenuitem",text:"Row",getSubmenuItems:function(){return u}},a=[{type:"menuitem",text:"Insert column before",icon:"table-insert-column-before",onAction:e("mceTableInsertColBefore"),onSetup:n.onSetupCellOrRow},{type:"menuitem",text:"Insert column after",icon:"table-insert-column-after",onAction:e("mceTableInsertColAfter"),onSetup:n.onSetupCellOrRow},{type:"menuitem",text:"Delete column",icon:"table-delete-column",onAction:e("mceTableDeleteCol"),onSetup:n.onSetupCellOrRow}],l={type:"nestedmenuitem",text:"Column",getSubmenuItems:function(){return a}},f=[{type:"menuitem",text:"Cell properties",icon:"table-cell-properties",onAction:e("mceTableCellProps"),onSetup:n.onSetupCellOrRow},{type:"menuitem",text:"Merge cells",icon:"table-merge-cells",onAction:e("mceTableMergeCells"),onSetup:n.onSetupMergeable},{type:"menuitem",text:"Split cell",icon:"table-split-cells",onAction:e("mceTableSplitCells"),onSetup:n.onSetupUnmergeable}],d={type:"nestedmenuitem",text:"Cell",getSubmenuItems:function(){return f}};(function(g){return g.getParam("table_grid",!0,"boolean")})(t)===!1?t.ui.registry.addMenuItem("inserttable",{text:"Table",icon:"table",onAction:e("mceInsertTable")}):t.ui.registry.addNestedMenuItem("inserttable",{text:"Table",icon:"table",getSubmenuItems:function(){return[{type:"fancymenuitem",fancytype:"inserttable",onAction:r}]}}),t.ui.registry.addMenuItem("inserttabledialog",{text:"Insert table",icon:"table",onAction:e("mceInsertTable")}),t.ui.registry.addMenuItem("tableprops",o),t.ui.registry.addMenuItem("deletetable",i),t.ui.registry.addNestedMenuItem("row",c),t.ui.registry.addNestedMenuItem("column",l),t.ui.registry.addNestedMenuItem("cell",d),t.ui.registry.addContextMenu("table",{update:function(){return n.resetTargets(),n.targets().fold(function(){return""},function(g){return I(g.element())==="caption"?"tableprops deletetable":"cell row column | advtablesort | tableprops deletetable"})}})}},Os=function(t,n,e,r){return{insertTable:function(o,i){return _r(t,o,i)},setClipboardRows:function(o){return function(i,u){var c=C(i,v.fromDom);u.set(s.from(c))}(o,n)},getClipboardRows:function(){return function(o){return o.get().fold(function(){},function(i){return C(i,function(u){return u.dom()})})}(n)},resizeHandler:e,selectionTargets:r}};function Ds(t){var n=xs(t),e=Rs(t,n),r=Kf(t),o=Ss(t,r.lazyResize,e),i=Ql(t,r.lazyWire),u=mt(s.none());return df.registerCommands(t,i,o,n,u),Pa.registerEvents(t,n,i,o),Ts.addMenuItems(t,e),Cc.addButtons(t,e),Cc.addToolbars(t),t.on("PreInit",function(){t.serializer.addTempAttr(Vt.firstSelected()),t.serializer.addTempAttr(Vt.lastSelected())}),Xl(t)&&t.on("keydown",function(c){ns.handle(c,t,i,r.lazyWire)}),t.on("remove",function(){r.destroy(),o.destroy()}),Os(t,u,r,e)}(function(){Ec.add("table",Ds)})()})(window);
