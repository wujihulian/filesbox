(function(_){"use strict";function S(t){return function(e){return function(n){if(n===null)return"null";var r=typeof n;return r=="object"&&(Array.prototype.isPrototypeOf(n)||n.constructor&&n.constructor.name==="Array")?"array":r=="object"&&(String.prototype.isPrototypeOf(n)||n.constructor&&n.constructor.name==="String")?"string":r}(e)===t}}function tt(){}function A(t){return function(){return t}}function j(){return z}var U,St=tinymce.util.Tools.resolve("tinymce.PluginManager"),jt=tinymce.util.Tools.resolve("tinymce.util.VK"),N=S("string"),nt=S("array"),Ft=S("boolean"),et=S("function"),rt=function(t){var e=t.getParam("link_assume_external_targets",!1);return Ft(e)&&e?1:!N(e)||e!=="http"&&e!=="https"?0:e},Lt=function(t){return t.getParam("link_context_toolbar",!1,"boolean")},Rt=function(t){return t.getParam("link_list")},ot=function(t){return t.getParam("default_link_target")},it=function(t){return t.getParam("target_list",!0)},ut=function(t){return t.getParam("rel_list",[],"array")},Dt=function(t){return t.getParam("link_class_list",[],"array")},Ut=function(t){return t.getParam("link_title",!0,"boolean")},ct=function(t){return t.getParam("allow_unsafe_link_target",!1,"boolean")},Mt=function(t){return t.getParam("link_quicklink",!1,"boolean")},zt=function(t){return t.getParam("link_default_protocol","http","string")},qt=function(t){var e=_.document.createElement("a");e.target="_blank",e.href=t,e.rel="noreferrer noopener";var n=_.document.createEvent("MouseEvents");n.initMouseEvent("click",!0,!0,_.window,0,0,0,0,0,!1,!1,!1,!1,0,null),function(r,i){_.document.body.appendChild(r),r.dispatchEvent(i),_.document.body.removeChild(r)}(e,n)},C=function(){return(C=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)},E=A(!1),M=A(!0),z=(U={fold:function(t,e){return t()},is:E,isSome:E,isNone:M,getOr:ft,getOrThunk:lt,getOrDie:function(t){throw new Error(t||"error: getOrDie called on none.")},getOrNull:A(null),getOrUndefined:A(void 0),or:ft,orThunk:lt,map:j,each:tt,bind:j,exists:E,forall:M,filter:j,equals:at,equals_:at,toArray:function(){return[]},toString:A("none()")},Object.freeze&&Object.freeze(U),U);function at(t){return t.isNone()}function lt(t){return t()}function ft(t){return t}function Kt(t,e){return-1<function(n,r){return Gt.call(n,r)}(t,e)}function st(t,e){for(var n=0,r=t.length;n<r;n++)e(t[n],n)}function mt(t){for(var e=[],n=0,r=t.length;n<r;++n){if(!nt(t[n]))throw new Error("Arr.flatten item "+n+" was not an array, input: "+t);Jt.apply(e,t[n])}return e}function Bt(t,e){return mt(function(n,r){for(var i=n.length,o=new Array(i),u=0;u<i;u++){var a=n[u];o[u]=r(a,u)}return o}(t,e))}function dt(t,e){for(var n=0;n<t.length;n++){var r=e(t[n],n);if(r.isSome())return r}return s.none()}function ht(t){return/^\w+:/i.test(t)}function pt(t,e){var n,r,i=["noopener"],o=t?t.split(/\s+/):[],u=function(d){return d.filter(function(h){return L.inArray(i,h)===-1})},a=e?0<(n=u(n=o)).length?n.concat(i):i:u(o);return 0<a.length?(r=a,L.trim(r.sort().join(" "))):""}function gt(t,e){return e=e||t.selection.getNode(),V(e)?t.dom.select("a[href]",e)[0]:t.dom.getParent(e,"a[href]")}function Vt(t){return t&&t.nodeName==="A"&&!!t.href}function Wt(t){return function(e,n,r){return st(e,function(i){r=n(r,i)}),r}(["title","rel","class","target"],function(e,n){return t[n].each(function(r){e[n]=0<r.length?r:null}),e},{href:t.href})}function Ht(t,e){var n=C({},e);if(!(0<ut(t).length)&&ct(t)===!1){var r=pt(n.rel,n.target==="_blank");n.rel=r||null}return s.from(n.target).isNone()&&it(t)===!1&&(n.target=ot(t)),n.href=function(i,o){return o!=="http"&&o!=="https"||ht(i)?i:o+"://"+i}(n.href,rt(t)),n}function q(t){return N(t.value)?t.value:""}function vt(t){return t===void 0&&(t=q),function(e){return s.from(e).map(function(n){return function(r,i){var o=[];return L.each(r,function(u){var a=N(u.text)?u.text:N(u.title)?u.title:"";if(u.menu===void 0){var d=i(u);o.push({text:a,value:d})}}),o}(n,t)})}}function $t(t,e,n,r){var i=r[e],o=0<t.length;return i!==void 0?function(u,a){return dt(a,function(d){return s.some(d).filter(function(h){return h.value===u})})}(i,n).map(function(u){return{url:{value:u.value,meta:{text:o?t:u.text,attach:tt}},text:o?t:u.text}}):s.none()}var F,yt,K,I,B=function(t){function e(){return i}function n(o){return o(t)}var r=A(t),i={fold:function(o,u){return u(t)},is:function(o){return t===o},isSome:M,isNone:E,getOr:r,getOrThunk:r,getOrDie:r,getOrNull:r,getOrUndefined:r,or:e,orThunk:e,map:function(o){return B(o(t))},each:function(o){o(t)},bind:n,exists:n,forall:n,filter:function(o){return o(t)?i:z},toArray:function(){return[t]},toString:function(){return"some("+t+")"},equals:function(o){return o.is(t)},equals_:function(o,u){return o.fold(E,function(a){return u(t,a)})}};return i},s={some:B,none:j,from:function(t){return t==null?z:B(t)}},_n=Array.prototype.slice,Gt=Array.prototype.indexOf,Jt=Array.prototype.push,L=(et(Array.from)&&Array.from,tinymce.util.Tools.resolve("tinymce.util.Tools")),V=function(t){return t&&t.nodeName==="FIGURE"&&/\bimage\b/i.test(t.className)},Xt=function(t,e){var n=t.dom.select("img",e)[0];if(n){var r=t.dom.getParents(n,"a[href]",e)[0];r&&(r.parentNode.insertBefore(n,r),t.dom.remove(r))}},Qt=function(t,e,n){var r=t.dom.select("img",e)[0];if(r){var i=t.dom.create("a",n);r.parentNode.insertBefore(i,r),i.appendChild(r)}},wt=function(t,e,n){var r=t.selection.getNode(),i=gt(t,r),o=Ht(t,Wt(n));t.undoManager.transact(function(){n.href===e.href&&e.attach(),i?(t.focus(),function(u,a,d,h){d.each(function(l){a.hasOwnProperty("innerText")?a.innerText=l:a.textContent=l}),u.dom.setAttribs(a,h),u.selection.select(a)}(t,i,n.text,o)):function(u,a,d,h){V(a)?Qt(u,a,h):d.fold(function(){u.execCommand("mceInsertLink",!1,h)},function(l){u.insertContent(u.dom.createHTML("a",h,u.dom.encode(l)))})}(t,r,n.text,o)})},R=function(t){t.undoManager.transact(function(){var e=t.selection.getNode();if(V(e))Xt(t,e);else{var n=t.dom.getParent(e,"a[href]",t.getBody());n&&t.dom.remove(n,!0)}t.focus()})},W=function(t){return 0<L.grep(t,Vt).length},kt=function(t){var e=t.getAttribute("data-mce-href");return e||t.getAttribute("href")},xt=function(t){return!(/</.test(t)&&(!/^<a [^>]+>[^<]+<\/a>$/.test(t)||t.indexOf("href=")===-1))},T=gt,bt=function(t,e){return function(n){return n.replace(/\uFEFF/g,"")}(e?e.innerText||e.textContent:t.getContent({format:"text"}))},Yt=pt,Zt=ht,k={sanitize:function(t){return vt(q)(t)},sanitizeWith:vt,createUi:function(t,e){return function(n){return{name:t,type:"selectbox",label:e,items:n}}},getValue:q},_t=function(t){function e(){return n}var n=t;return{get:e,set:function(r){n=r},clone:function(){return _t(e())}}},tn=function(t,e){function n(i,o){var u=function(a,d){return d==="link"?a.catalogs.link:d==="anchor"?a.catalogs.anchor:s.none()}(e,o.name).getOr([]);return $t(r.get(),o.name,u,i)}var r=_t(t.text);return{onChange:function(i,o){return o.name==="url"?function(u){if(r.get().length<=0){var a=u.url.meta.text!==void 0?u.url.meta.text:u.url.value,d=u.url.meta.title!==void 0?u.url.meta.title:"";return s.some({text:a,title:d})}return s.none()}(i()):Kt(["anchor","link"],o.name)?n(i(),o):(o.name==="text"&&r.set(i().text),s.none())}}},Tt={},Ot={exports:Tt};F=void 0,yt=Tt,K=Ot,I=void 0,function(t){typeof yt=="object"&&K!==void 0?K.exports=t():typeof F=="function"&&F.amd?F([],t):(typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:this).EphoxContactWrapper=t()}(function(){return function t(e,n,r){function i(a,d){if(!n[a]){if(!e[a]){var h=typeof I=="function"&&I;if(!d&&h)return h(a,!0);if(o)return o(a,!0);var l=new Error("Cannot find module '"+a+"'");throw l.code="MODULE_NOT_FOUND",l}var m=n[a]={exports:{}};e[a][0].call(m.exports,function(v){return i(e[a][1][v]||v)},m,m.exports,t,e,n,r)}return n[a].exports}for(var o=typeof I=="function"&&I,u=0;u<r.length;u++)i(r[u]);return i}({1:[function(t,e,n){var r,i,o=e.exports={};function u(){throw new Error("setTimeout has not been defined")}function a(){throw new Error("clearTimeout has not been defined")}function d(g){if(r===setTimeout)return setTimeout(g,0);if((r===u||!r)&&setTimeout)return r=setTimeout,setTimeout(g,0);try{return r(g,0)}catch(y){try{return r.call(null,g,0)}catch(x){return r.call(this,g,0)}}}(function(){try{r=typeof setTimeout=="function"?setTimeout:u}catch(g){r=u}try{i=typeof clearTimeout=="function"?clearTimeout:a}catch(g){i=a}})();var h,l=[],m=!1,v=-1;function w(){m&&h&&(m=!1,h.length?l=h.concat(l):v=-1,l.length&&c())}function c(){if(!m){var g=d(w);m=!0;for(var y=l.length;y;){for(h=l,l=[];++v<y;)h&&h[v].run();v=-1,y=l.length}h=null,m=!1,function(b){if(i===clearTimeout)return clearTimeout(b);if((i===a||!i)&&clearTimeout)return i=clearTimeout,clearTimeout(b);try{return i(b)}catch(Y){try{return i.call(null,b)}catch(O){return i.call(this,b)}}}(g)}}function f(g,y){this.fun=g,this.array=y}function p(){}o.nextTick=function(g){var y=new Array(arguments.length-1);if(1<arguments.length)for(var x=1;x<arguments.length;x++)y[x-1]=arguments[x];l.push(new f(g,y)),l.length!==1||m||d(c)},f.prototype.run=function(){this.fun.apply(null,this.array)},o.title="browser",o.browser=!0,o.env={},o.argv=[],o.version="",o.versions={},o.on=p,o.addListener=p,o.once=p,o.off=p,o.removeListener=p,o.removeAllListeners=p,o.emit=p,o.prependListener=p,o.prependOnceListener=p,o.listeners=function(g){return[]},o.binding=function(g){throw new Error("process.binding is not supported")},o.cwd=function(){return"/"},o.chdir=function(g){throw new Error("process.chdir is not supported")},o.umask=function(){return 0}},{}],2:[function(t,e,n){(function(r){function i(){}function o(c){if(typeof this!="object")throw new TypeError("Promises must be constructed via new");if(typeof c!="function")throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],m(c,this)}function u(c,f){for(;c._state===3;)c=c._value;c._state!==0?(c._handled=!0,o._immediateFn(function(){var p=c._state===1?f.onFulfilled:f.onRejected;if(p!==null){var g;try{g=p(c._value)}catch(y){return void d(f.promise,y)}a(f.promise,g)}else(c._state===1?a:d)(f.promise,c._value)})):c._deferreds.push(f)}function a(c,f){try{if(f===c)throw new TypeError("A promise cannot be resolved with itself.");if(f&&(typeof f=="object"||typeof f=="function")){var p=f.then;if(f instanceof o)return c._state=3,c._value=f,void h(c);if(typeof p=="function")return void m(function(y,x){return function(){y.apply(x,arguments)}}(p,f),c)}c._state=1,c._value=f,h(c)}catch(g){d(c,g)}}function d(c,f){c._state=2,c._value=f,h(c)}function h(c){c._state===2&&c._deferreds.length===0&&o._immediateFn(function(){c._handled||o._unhandledRejectionFn(c._value)});for(var f=0,p=c._deferreds.length;f<p;f++)u(c,c._deferreds[f]);c._deferreds=null}function l(c,f,p){this.onFulfilled=typeof c=="function"?c:null,this.onRejected=typeof f=="function"?f:null,this.promise=p}function m(c,f){var p=!1;try{c(function(g){p||(p=!0,a(f,g))},function(g){p||(p=!0,d(f,g))})}catch(g){if(p)return;p=!0,d(f,g)}}var v,w;v=this,w=setTimeout,o.prototype.catch=function(c){return this.then(null,c)},o.prototype.then=function(c,f){var p=new this.constructor(i);return u(this,new l(c,f,p)),p},o.all=function(c){var f=Array.prototype.slice.call(c);return new o(function(p,g){if(f.length===0)return p([]);var y=f.length;function x(Y,O){try{if(O&&(typeof O=="object"||typeof O=="function")){var It=O.then;if(typeof It=="function")return void It.call(O,function(Z){x(Y,Z)},g)}f[Y]=O,--y==0&&p(f)}catch(Z){g(Z)}}for(var b=0;b<f.length;b++)x(b,f[b])})},o.resolve=function(c){return c&&typeof c=="object"&&c.constructor===o?c:new o(function(f){f(c)})},o.reject=function(c){return new o(function(f,p){p(c)})},o.race=function(c){return new o(function(f,p){for(var g=0,y=c.length;g<y;g++)c[g].then(f,p)})},o._immediateFn=typeof r=="function"?function(c){r(c)}:function(c){w(c,0)},o._unhandledRejectionFn=function(c){typeof console!="undefined"&&console&&console.warn("Possible Unhandled Promise Rejection:",c)},o._setImmediateFn=function(c){o._immediateFn=c},o._setUnhandledRejectionFn=function(c){o._unhandledRejectionFn=c},e!==void 0&&e.exports?e.exports=o:v.Promise||(v.Promise=o)}).call(this,t("timers").setImmediate)},{timers:3}],3:[function(t,e,n){(function(r,i){var o=t("process/browser.js").nextTick,u=Function.prototype.apply,a=Array.prototype.slice,d={},h=0;function l(m,v){this._id=m,this._clearFn=v}n.setTimeout=function(){return new l(u.call(setTimeout,window,arguments),clearTimeout)},n.setInterval=function(){return new l(u.call(setInterval,window,arguments),clearInterval)},n.clearTimeout=n.clearInterval=function(m){m.close()},l.prototype.unref=l.prototype.ref=function(){},l.prototype.close=function(){this._clearFn.call(window,this._id)},n.enroll=function(m,v){clearTimeout(m._idleTimeoutId),m._idleTimeout=v},n.unenroll=function(m){clearTimeout(m._idleTimeoutId),m._idleTimeout=-1},n._unrefActive=n.active=function(m){clearTimeout(m._idleTimeoutId);var v=m._idleTimeout;0<=v&&(m._idleTimeoutId=setTimeout(function(){m._onTimeout&&m._onTimeout()},v))},n.setImmediate=typeof r=="function"?r:function(m){var v=h++,w=!(arguments.length<2)&&a.call(arguments,1);return d[v]=!0,o(function(){d[v]&&(w?m.apply(null,w):m.call(null),n.clearImmediate(v))}),v},n.clearImmediate=typeof i=="function"?i:function(m){delete d[m]}}).call(this,t("timers").setImmediate,t("timers").clearImmediate)},{"process/browser.js":1,timers:3}],4:[function(t,e,n){var r=t("promise-polyfill"),i=typeof window!="undefined"?window:Function("return this;")();e.exports={boltExport:i.Promise||r}},{"promise-polyfill":2}]},{},[4])(4)});function nn(t){_.setTimeout(function(){throw t},0)}function en(t){var e=t.href;return 0<e.indexOf("@")&&e.indexOf("//")===-1&&e.indexOf("mailto:")===-1?s.some({message:"The URL you entered seems to be an email address. Do you want to add the required mailto: prefix?",preprocess:function(n){return C(C({},n),{href:"mailto:"+e})}}):s.none()}function H(t,e,n){var r=t.getAttrib(e,n);return r!==null&&0<r.length?s.some(r):s.none()}function At(t,e){return t.dom.getParent(e,"a[href]")}function Ct(t){return At(t,t.selection.getStart())}function $(t,e){if(e){var n=kt(e);if(/^#/.test(n)){var r=t.$(n);r.length&&t.selection.scrollIntoView(r[0],!0)}else qt(e.href)}}var Pt=Ot.exports.boltExport,G=function(t){var e=s.none(),n=[],r=function(a){i()?u(a):n.push(a)},i=function(){return e.isSome()},o=function(a){st(a,u)},u=function(a){e.each(function(d){_.setTimeout(function(){a(d)},0)})};return t(function(a){e=s.some(a),o(n),n=[]}),{get:r,map:function(a){return G(function(d){r(function(h){d(a(h))})})},isReady:i}},rn={nu:G,pure:function(t){return G(function(e){e(t)})}},P=function(t){function e(n){t().then(n,nn)}return{map:function(n){return P(function(){return t().then(n)})},bind:function(n){return P(function(){return t().then(function(r){return n(r).toPromise()})})},anonBind:function(n){return P(function(){return t().then(function(){return n.toPromise()})})},toLazy:function(){return rn.nu(e)},toCached:function(){var n=null;return P(function(){return n===null&&(n=t()),n})},toPromise:t,get:e}},Nt=function(t){return P(function(){return new Pt(t)})},on=function(t){return P(function(){return Pt.resolve(t)})},un=tinymce.util.Tools.resolve("tinymce.util.Delay"),cn=function(t,e){return dt([en,function(n,r){return function(i){var o=i.href;return n===1&&!Zt(o)||n===0&&/^\s*www[\.|\d\.]/i.test(o)?s.some({message:"The URL you entered seems to be an external link. Do you want to add the required "+r+":// prefix?",preprocess:function(u){return C(C({},u),{href:r+"://"+o})}}):s.none()}}(rt(t),zt(t))],function(n){return n(e)}).fold(function(){return on(e)},function(n){return Nt(function(r){(function(i,o,u){var a=i.selection.getRng();un.setEditorTimeout(i,function(){i.windowManager.confirm(o,function(d){i.selection.setRng(a),u(d)})})})(t,n.message,function(i){r(i?n.preprocess(e):e)})})})},an=function(t){var e=t.dom.select("a:not([href])"),n=Bt(e,function(r){var i=r.name||r.id;return i?[{text:i,value:"#"+i}]:[]});return 0<n.length?s.some([{text:"None",value:""}].concat(n)):s.none()},ln=function(t){var e=Dt(t);return 0<e.length?k.sanitize(e):s.none()},fn=tinymce.util.Tools.resolve("tinymce.util.XHR"),sn=function(t){function e(r){return t.convertURL(r.value||r.url,"href")}var n=Rt(t);return Nt(function(r){N(n)?fn.send({url:n,success:function(i){return r(function(o){try{return s.some(JSON.parse(o))}catch(u){return s.none()}}(i))},error:function(i){return r(s.none())}}):et(n)?n(function(i){return r(s.some(i))}):r(s.from(n))}).map(function(r){return r.bind(k.sanitizeWith(e)).map(function(i){return 0<i.length?[{text:"None",value:""}].concat(i):i})})},mn=function(t,e){var n=ut(t);if(0<n.length){var r=e.is("_blank");return(ct(t)===!1?k.sanitizeWith(function(i){return Yt(k.getValue(i),r)}):k.sanitize)(n)}return s.none()},Et=[{text:"Current window",value:""},{text:"New window",value:"_blank"}],dn=function(t){var e=it(t);return nt(e)?k.sanitize(e).orThunk(function(){return s.some(Et)}):e===!1?s.none():s.some(Et)},hn=function(t,e){return sn(t).map(function(n){var r=function(i,o){var u=i.dom,a=xt(i.selection.getContent())?s.some(bt(i.selection,o)):s.none(),d=o?s.some(u.getAttrib(o,"href")):s.none(),h=o?s.from(u.getAttrib(o,"target")):s.none(),l=H(u,o,"rel"),m=H(u,o,"class");return{url:d,text:a,title:H(u,o,"title"),target:h,rel:l,linkClass:m}}(t,e);return{anchor:r,catalogs:{targets:dn(t),rels:mn(t,r.target),classes:ln(t),anchor:an(t),link:n},optNode:s.from(e),flags:{titleEnabled:Ut(t)}}})},pn=function(t){(function(e){var n=T(e);return hn(e,n)})(t).map(function(e){return function(n,r,i){var o=n.anchor.text.map(function(){return{name:"text",type:"input",label:"Text to display"}}).toArray(),u=n.flags.titleEnabled?[{name:"title",type:"input",label:"Title"}]:[],a=function(l,m){return{url:{value:l.anchor.url.getOr(""),meta:{attach:function(){},text:l.anchor.url.fold(function(){return""},function(){return l.anchor.text.getOr("")}),original:{value:l.anchor.url.getOr("")}}},text:l.anchor.text.getOr(""),title:l.anchor.title.getOr(""),anchor:l.anchor.url.getOr(""),link:l.anchor.url.getOr(""),rel:l.anchor.rel.getOr(""),target:l.anchor.target.or(m).getOr(""),linkClass:l.anchor.linkClass.getOr("")}}(n,s.from(ot(i))),d=tn(a,n),h=n.catalogs;return{title:"Insert/Edit Link",size:"normal",body:{type:"panel",items:mt([[{name:"url",type:"urlinput",filetype:"file",label:"URL"}],o,u,function(l){for(var m=[],v=function(c){m.push(c)},w=0;w<l.length;w++)l[w].each(v);return m}([h.anchor.map(k.createUi("anchor","Anchors")),h.rels.map(k.createUi("rel","Rel")),h.targets.map(k.createUi("target","Open link in...")),h.link.map(k.createUi("link","Link list")),h.classes.map(k.createUi("linkClass","Class"))])])},buttons:[{type:"cancel",name:"cancel",text:"Cancel"},{type:"submit",name:"save",text:"Save",primary:!0}],initialData:a,onChange:function(l,m){var v=m.name;d.onChange(l.getData,{name:v}).each(function(w){l.setData(w)})},onSubmit:r}}(e,function(n,r){return function(i){var o=i.getData();if(!o.url.value)return R(n),void i.close();function u(h){return s.from(o[h]).filter(function(l){return!r.anchor[h].is(l)})}var a={href:o.url.value,text:u("text"),target:u("target"),rel:u("rel"),class:u("linkClass"),title:u("title")},d={href:o.url.value,attach:o.url.meta!==void 0&&o.url.meta.attach?o.url.meta.attach:function(){}};cn(n,a).get(function(h){wt(n,d,h)}),i.close()}}(t,e),t)}).get(function(e){t.windowManager.open(e)})},J=function(t){return function(){pn(t)}},X=function(t){return function(){$(t,Ct(t))}},gn=function(t){t.on("click",function(e){var n=At(t,e.target);n&&jt.metaKeyPressed(e)&&(e.preventDefault(),$(t,n))}),t.on("keydown",function(e){var n=Ct(t);n&&e.keyCode===13&&function(r){return r.altKey===!0&&r.shiftKey===!1&&r.ctrlKey===!1&&r.metaKey===!1}(e)&&(e.preventDefault(),$(t,n))})},Q=function(t){return function(e){function n(r){return e.setActive(!t.readonly&&!!T(t,r.element))}return t.on("NodeChange",n),function(){return t.off("NodeChange",n)}}},D=function(t){return function(e){e.setDisabled(!W(t.dom.getParents(t.selection.getStart())));function n(r){return e.setDisabled(!W(r.parents))}return t.on("NodeChange",n),function(){return t.off("NodeChange",n)}}},vn=function(t){t.addCommand("mceLink",function(){Mt(t)?t.fire("contexttoolbar-show",{toolbarKey:"quicklink"}):J(t)()})},yn=function(t){t.addShortcut("Meta+K","",function(){t.execCommand("mceLink")})},wn=function(t){t.ui.registry.addToggleButton("link",{icon:"link",tooltip:"Insert/edit link",onAction:J(t),onSetup:Q(t)}),t.ui.registry.addButton("openlink",{icon:"new-tab",tooltip:"Open link",onAction:X(t),onSetup:D(t)}),t.ui.registry.addButton("unlink",{icon:"unlink",tooltip:"Remove link",onAction:function(){return R(t)},onSetup:D(t)})},kn=function(t){t.ui.registry.addMenuItem("openlink",{text:"Open link",icon:"new-tab",onAction:X(t),onSetup:D(t)}),t.ui.registry.addMenuItem("link",{icon:"link",text:"Link...",shortcut:"Meta+K",onAction:J(t)}),t.ui.registry.addMenuItem("unlink",{icon:"unlink",text:"Remove link",onAction:function(){return R(t)},onSetup:D(t)})},xn=function(t){t.ui.registry.addContextMenu("link",{update:function(e){return W(t.dom.getParents(e,"a"))?"link unlink openlink":"link"}})},bn=function(t){function e(n){var r=t.selection.getNode();return n.setDisabled(!T(t,r)),function(){}}t.ui.registry.addContextForm("quicklink",{launch:{type:"contextformtogglebutton",icon:"link",tooltip:"Link",onSetup:Q(t)},label:"Link",predicate:function(n){return!!T(t,n)&&Lt(t)},initValue:function(){var n=T(t);return n?kt(n):""},commands:[{type:"contextformtogglebutton",icon:"link",tooltip:"Link",primary:!0,onSetup:function(n){var r=t.selection.getNode();return n.setActive(!!T(t,r)),Q(t)(n)},onAction:function(n){var r=T(t),i=n.getValue();if(r)t.dom.setAttrib(r,"href",i),function(a){a.selection.collapse(!1)}(t),n.hide();else{var o={href:i,attach:function(){}},u=xt(t.selection.getContent())?s.some(bt(t.selection,r)).filter(function(a){return 0<a.length}).or(s.from(i)):s.none();wt(t,o,{href:i,text:u,title:s.none(),rel:s.none(),target:s.none(),class:s.none()}),n.hide()}}},{type:"contextformbutton",icon:"unlink",tooltip:"Remove link",onSetup:e,onAction:function(n){R(t),n.hide()}},{type:"contextformbutton",icon:"new-tab",tooltip:"Open link",onSetup:e,onAction:function(n){X(t)(),n.hide()}}]})};(function(){St.add("link",function(e){wn(e),kn(e),xn(e),bn(e),gn(e),vn(e),yn(e)})})()})(window);
