(function(f){"use strict";function b(){}function c(n){return function(){return n}}function C(){return F}var _,N=function(n){function e(){return r}var r=n;return{get:e,set:function(t){r=t},clone:function(){return N(e())}}},bn=tinymce.util.Tools.resolve("tinymce.PluginManager"),Cn=function(n){return{isFullscreen:function(){return n.get()!==null}}},S=c(!1),k=c(!0),F=(_={fold:function(n,e){return n()},is:S,isSome:S,isNone:k,getOr:z,getOrThunk:X,getOrDie:function(n){throw new Error(n||"error: getOrDie called on none.")},getOrNull:c(null),getOrUndefined:c(void 0),or:z,orThunk:X,map:C,each:b,bind:C,exists:S,forall:k,filter:C,equals:q,equals_:q,toArray:function(){return[]},toString:c("none()")},Object.freeze&&Object.freeze(_),_);function q(n){return n.isNone()}function X(n){return n()}function z(n){return n}function Y(){return function(n){function e(){r.get().each(n)}var r=N(h.none());return{clear:function(){e(),r.set(h.none())},isSet:function(){return r.get().isSome()},set:function(t){e(),r.set(h.some(t))}}}(function(n){n.unbind()})}function T(n){return function(e){return function(r){if(r===null)return"null";var t=typeof r;return t=="object"&&(Array.prototype.isPrototypeOf(r)||r.constructor&&r.constructor.name==="Array")?"array":t=="object"&&(String.prototype.isPrototypeOf(r)||r.constructor&&r.constructor.name==="String")?"string":t}(e)===n}}function R(n,e){for(var r=n.length,t=new Array(r),i=0;i<r;i++){var o=n[i];t[i]=e(o,i)}return t}function P(n,e){for(var r=0,t=n.length;r<t;r++)e(n[r],r)}function I(n,e){for(var r=[],t=0,i=n.length;t<i;t++){var o=n[t];e(o,t)&&r.push(o)}return r}function Dn(n,e){return function(r){for(var t=[],i=0,o=r.length;i<o;++i){if(!Un(r[i]))throw new Error("Arr.flatten item "+i+" was not an array, input: "+r);jn.apply(t,r[i])}return t}(R(n,e))}function l(n,e){return n.indexOf(e)!==-1}function G(n){return n.style!==void 0&&W(n.style.getPropertyValue)}function An(n,e,r){(function(t,i,o){if(!(on(o)||Wn(o)||Bn(o)))throw f.console.error("Invalid call to Attr.set. Key ",i,":: Value ",o,":: Element ",t),new Error("Attribute value was not simple");t.setAttribute(i,o+"")})(n.dom(),e,r)}function $(n,e){var r=n.dom().getAttribute(e);return r===null?void 0:r}function K(n,e){n.dom().removeAttribute(e)}function L(n,e){var r=n.dom();(function(t,i){for(var o=Vn(t),u=0,s=o.length;u<s;u++){var a=o[u];i(t[a],a)}})(e,function(t,i){(function(o,u,s){if(!on(s))throw f.console.error("Invalid call to CSS.set. Property ",u,":: Value ",s,":: Element ",o),new Error("CSS value must be a string: "+s);G(o)&&o.style.setProperty(u,s)})(r,i,t)})}function Mn(n,e){var r=n.dom(),t=f.window.getComputedStyle(r).getPropertyValue(e),i=t!==""||function(o){var u=Yn(o)?o.dom().parentNode:o.dom();return u!=null&&u.ownerDocument.body.contains(u)}(n)?t:Gn(r,e);return i===null?void 0:i}function _n(n){function e(){n.stopPropagation()}function r(){n.preventDefault()}var t=w.fromDom(n.target),i=function(o,u){return function(){for(var s=[],a=0;a<arguments.length;a++)s[a]=arguments[a];return o(u.apply(null,s))}}(r,e);return function(o,u,s,a,d,m,y){return{target:c(o),x:c(u),y:c(s),stop:a,prevent:d,kill:m,raw:c(y)}}(t,n.clientX,n.clientY,e,r,i,n)}function kn(n,e){var r=function(i,o){for(var u=0;u<i.length;u++){var s=i[u];if(s.test(o))return s}}(n,e);if(!r)return{major:0,minor:0};function t(i){return Number(e.replace(r,"$"+i))}return B(t(1),t(2))}function O(n,e){return function(){return e===n}}function p(n,e){return function(){return e===n}}function J(n,e){var r=String(e).toLowerCase();return function(t,i){for(var o=0,u=t.length;o<u;o++){var s=t[o];if(i(s,o))return h.some(s)}return h.none()}(n,function(t){return t.search(r)})}function g(n){return function(e){return l(e,n)}}function Q(){return Zn.get()}function Fn(n,e,r){return(n.compareDocumentPosition(e)&r)!=0}function Z(n,e){var r=n.dom();if(r.nodeType!==wn)return!1;var t=r;if(t.matches!==void 0)return t.matches(e);if(t.msMatchesSelector!==void 0)return t.msMatchesSelector(e);if(t.webkitMatchesSelector!==void 0)return t.webkitMatchesSelector(e);if(t.mozMatchesSelector!==void 0)return t.mozMatchesSelector(e);throw new Error("Browser lacks native selectors")}function Rn(n,e){var r=e===void 0?f.document:e.dom();return function(t){return t.nodeType!==wn&&t.nodeType!==ne||t.childElementCount===0}(r)?[]:R(r.querySelectorAll(n),w.fromDom)}function Pn(n){return function(e){return h.from(e.dom().parentNode).map(w.fromDom)}(n).map(ee).map(function(e){return I(e,function(r){return!function(t,i){return t.dom()===i.dom()}(n,r)})}).getOr([])}function H(n){var e=n===void 0?f.window:n;return h.from(e.visualViewport)}function nn(n,e,r,t){return{x:c(n),y:c(e),width:c(r),height:c(t),right:c(n+r),bottom:c(e+t)}}function In(n){var e=n===void 0?f.window:n,r=e.document,t=function(i){var o=i!==void 0?i.dom():f.document,u=o.body.scrollLeft||o.documentElement.scrollLeft,s=o.body.scrollTop||o.documentElement.scrollTop;return re(u,s)}(w.fromDom(r));return H(e).fold(function(){var i=e.document.documentElement,o=i.clientWidth,u=i.clientHeight;return nn(t.left(),t.top(),o,u)},function(i){return nn(Math.max(i.pageLeft,t.left()),Math.max(i.pageTop,t.top()),i.width,i.height)})}function en(n,e,r){return H(r).map(function(t){function i(o){return _n(o)}return t.addEventListener(n,i),{unbind:function(){return t.removeEventListener(n,i)}}}).getOrThunk(function(){return{unbind:b}})}function Ln(n,e,r){return I(function(t,i){for(var o=W(i)?i:S,u=t.dom(),s=[];u.parentNode!==null&&u.parentNode!==void 0;){var a=u.parentNode,d=w.fromDom(a);if(s.push(d),o(d)===!0)break;u=a}return s}(n,r),e)}function Hn(n,e){return function(r,t){return I(Pn(r),t)}(n,function(r){return Z(r,e)})}function rn(n,e){return function(r){r.setActive(e.get()!==null);function t(i){return r.setActive(i.state)}return n.on("FullscreenStateChanged",t),function(){return n.off("FullscreenStateChanged",t)}}}var tn,U=function(n){function e(){return i}function r(o){return o(n)}var t=c(n),i={fold:function(o,u){return u(n)},is:function(o){return n===o},isSome:k,isNone:S,getOr:t,getOrThunk:t,getOrDie:t,getOrNull:t,getOrUndefined:t,or:e,orThunk:e,map:function(o){return U(o(n))},each:function(o){o(n)},bind:r,exists:r,forall:r,filter:function(o){return o(n)?i:F},toArray:function(){return[n]},toString:function(){return"some("+n+")"},equals:function(o){return o.is(n)},equals_:function(o,u){return o.fold(S,function(s){return u(n,s)})}};return i},h={some:U,none:C,from:function(n){return n==null?F:U(n)}},on=T("string"),Un=T("array"),Wn=T("boolean"),W=T("function"),Bn=T("number"),me=Array.prototype.slice,jn=Array.prototype.push,Vn=(W(Array.from)&&Array.from,Object.keys),x=function(n){if(n==null)throw new Error("Node cannot be null or undefined");return{dom:c(n)}},w={fromHtml:function(n,e){var r=(e||f.document).createElement("div");if(r.innerHTML=n,!r.hasChildNodes()||1<r.childNodes.length)throw f.console.error("HTML does not have a single root node",n),new Error("HTML must have a single root node");return x(r.childNodes[0])},fromTag:function(n,e){var r=(e||f.document).createElement(n);return x(r)},fromText:function(n,e){var r=(e||f.document).createTextNode(n);return x(r)},fromDom:x,fromPoint:function(n,e,r){var t=n.dom();return h.from(t.elementFromPoint(e,r)).map(x)}},qn=(f.Node.ATTRIBUTE_NODE,f.Node.CDATA_SECTION_NODE,f.Node.COMMENT_NODE,f.Node.DOCUMENT_NODE),Xn=(f.Node.DOCUMENT_TYPE_NODE,f.Node.DOCUMENT_FRAGMENT_NODE,f.Node.ELEMENT_NODE),zn=f.Node.TEXT_NODE,Yn=(f.Node.PROCESSING_INSTRUCTION_NODE,f.Node.ENTITY_REFERENCE_NODE,f.Node.ENTITY_NODE,f.Node.NOTATION_NODE,typeof f.window!="undefined"?f.window:Function("return this;")(),tn=zn,function(n){return function(e){return e.dom().nodeType}(n)===tn}),Gn=function(n,e){return G(n)?n.style.getPropertyValue(e):""},un=function(){return B(0,0)},B=function(n,e){return{major:n,minor:e}},D={nu:B,detect:function(n,e){var r=String(e).toLowerCase();return n.length===0?un():kn(n,r)},unknown:un},cn="Firefox",sn=function(n){var e=n.current;return{current:e,version:n.version,isEdge:O("Edge",e),isChrome:O("Chrome",e),isIE:O("IE",e),isOpera:O("Opera",e),isFirefox:O(cn,e),isSafari:O("Safari",e)}},fn={unknown:function(){return sn({current:void 0,version:D.unknown()})},nu:sn,edge:c("Edge"),chrome:c("Chrome"),ie:c("IE"),opera:c("Opera"),firefox:c(cn),safari:c("Safari")},an="Windows",ln="Android",dn="Solaris",mn="FreeBSD",hn="ChromeOS",gn=function(n){var e=n.current;return{current:e,version:n.version,isWindows:p(an,e),isiOS:p("iOS",e),isAndroid:p(ln,e),isOSX:p("OSX",e),isLinux:p("Linux",e),isSolaris:p(dn,e),isFreeBSD:p(mn,e),isChromeOS:p(hn,e)}},vn={unknown:function(){return gn({current:void 0,version:D.unknown()})},nu:gn,windows:c(an),ios:c("iOS"),android:c(ln),linux:c("Linux"),osx:c("OSX"),solaris:c(dn),freebsd:c(mn),chromeos:c(hn)},$n=function(n,e){return J(n,e).map(function(r){var t=D.detect(r.versionRegexes,e);return{current:r.name,version:t}})},Kn=function(n,e){return J(n,e).map(function(r){var t=D.detect(r.versionRegexes,e);return{current:r.name,version:t}})},j=/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,Jn=[{name:"Edge",versionRegexes:[/.*?edge\/ ?([0-9]+)\.([0-9]+)$/],search:function(n){return l(n,"edge/")&&l(n,"chrome")&&l(n,"safari")&&l(n,"applewebkit")}},{name:"Chrome",versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/,j],search:function(n){return l(n,"chrome")&&!l(n,"chromeframe")}},{name:"IE",versionRegexes:[/.*?msie\ ?([0-9]+)\.([0-9]+).*/,/.*?rv:([0-9]+)\.([0-9]+).*/],search:function(n){return l(n,"msie")||l(n,"trident")}},{name:"Opera",versionRegexes:[j,/.*?opera\/([0-9]+)\.([0-9]+).*/],search:g("opera")},{name:"Firefox",versionRegexes:[/.*?firefox\/\ ?([0-9]+)\.([0-9]+).*/],search:g("firefox")},{name:"Safari",versionRegexes:[j,/.*?cpu os ([0-9]+)_([0-9]+).*/],search:function(n){return(l(n,"safari")||l(n,"mobile/"))&&l(n,"applewebkit")}}],Qn=[{name:"Windows",search:g("win"),versionRegexes:[/.*?windows\ nt\ ?([0-9]+)\.([0-9]+).*/]},{name:"iOS",search:function(n){return l(n,"iphone")||l(n,"ipad")},versionRegexes:[/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,/.*cpu os ([0-9]+)_([0-9]+).*/,/.*cpu iphone os ([0-9]+)_([0-9]+).*/]},{name:"Android",search:g("android"),versionRegexes:[/.*?android\ ?([0-9]+)\.([0-9]+).*/]},{name:"OSX",search:g("mac os x"),versionRegexes:[/.*?mac\ os\ x\ ?([0-9]+)_([0-9]+).*/]},{name:"Linux",search:g("linux"),versionRegexes:[]},{name:"Solaris",search:g("sunos"),versionRegexes:[]},{name:"FreeBSD",search:g("freebsd"),versionRegexes:[]},{name:"ChromeOS",search:g("cros"),versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/]}],pn={browsers:c(Jn),oses:c(Qn)},Zn=N(function(n,e){var r=pn.browsers(),t=pn.oses(),i=$n(r,n).fold(fn.unknown,fn.nu),o=Kn(t,n).fold(vn.unknown,vn.nu);return{browser:i,os:o,deviceType:function(u,s,a,d){var m=u.isiOS()&&/ipad/i.test(a)===!0,y=u.isiOS()&&!m,v=u.isiOS()||u.isAndroid(),le=v||d("(pointer:coarse)"),V=m||!y&&v&&d("(min-device-width:768px)"),Tn=y||v&&!V,xn=s.isSafari()&&u.isiOS()&&/safari/i.test(a)===!1,de=!Tn&&!V&&!xn;return{isiPad:c(m),isiPhone:c(y),isTablet:c(V),isPhone:c(Tn),isTouch:c(le),isAndroid:u.isAndroid,isiOS:u.isiOS,isWebView:c(xn),isDesktop:c(de)}}(o,i,n,e)}}(f.navigator.userAgent,function(n){return f.window.matchMedia(n).matches})),he=function(n,e){return Fn(n,e,f.Node.DOCUMENT_POSITION_CONTAINED_BY)},wn=Xn,ne=qn,ee=(Q().browser.isIE(),function(n){return R(n.dom().childNodes,w.fromDom)}),yn=(function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e]}("element","offset"),function(n,e){return{left:c(n),top:c(e),translate:function(r,t){return yn(n+r,e+t)}}}),re=yn,te=(Q().browser.isSafari(),tinymce.util.Tools.resolve("tinymce.dom.DOMUtils")),Sn=tinymce.util.Tools.resolve("tinymce.Env"),oe=tinymce.util.Tools.resolve("tinymce.util.Delay"),On=function(n,e){n.fire("FullscreenStateChanged",{state:e})},A="data-ephox-mobile-fullscreen-style",En="position:absolute!important;",Nn="top:0!important;left:0!important;margin:0!important;padding:0!important;width:100%!important;height:100%!important;overflow:visible!important;",ie=Sn.os.isAndroid(),ue=function(n,e,r){function t(s){return function(a){var d=$(a,"style"),m=d===void 0?"no-styles":d.trim();m!==s&&(An(a,A,m),L(a,n.parseStyle(s)))}}var i=function(s,a,d){return Ln(s,function(m){return Z(m,a)},d)}(e,"*"),o=Dn(i,function(s){return Hn(s,"*:not(.tox-silver-sink)")}),u=function(s){var a=Mn(s,"background-color");return a!==void 0&&a!==""?"background-color:"+a+"!important":"background-color:rgb(255,255,255)!important;"}(r);P(o,t("display:none!important;")),P(i,t(En+Nn+u)),t((ie===!0?"":En)+Nn+u)(e)},ce=function(n){var e=function(r){return Rn(r)}("["+A+"]");P(e,function(r){var t=$(r,A);t!=="no-styles"?L(r,n.parseStyle(t)):K(r,"style"),K(r,A)})},E=te.DOM,M=H().fold(function(){return{bind:b,unbind:b}},function(n){var e=function(){var o=N(h.none());return{clear:function(){o.set(h.none())},set:function(u){o.set(h.some(u))},isSet:function(){return o.get().isSome()},on:function(u){o.get().each(u)}}}(),r=Y(),t=Y(),i=oe.throttle(function(){f.document.body.scrollTop=0,f.document.documentElement.scrollTop=0,f.window.requestAnimationFrame(function(){e.on(function(o){return L(o,{top:n.offsetTop+"px",left:n.offsetLeft+"px",height:n.height+"px",width:n.width+"px"})})})},50);return{bind:function(o){e.set(o),i(),r.set(en("resize")),t.set(en("scroll"))},unbind:function(){e.on(function(){r.clear(),t.clear()}),e.clear()}}}),se=function(n,e){var r,t,i,o=f.document.body,u=f.document.documentElement;t=n.getContainer();var s=w.fromDom(t),a=e.get(),d=w.fromDom(n.getBody()),m=Sn.deviceType.isTouch();if(r=t.style,i=n.getContentAreaContainer().firstChild.style,a)i.width=a.iframeWidth,i.height=a.iframeHeight,r.width=a.containerWidth,r.height=a.containerHeight,r.top=a.containerTop,r.left=a.containerLeft,m&&ce(n.dom),E.removeClass(o,"tox-fullscreen"),E.removeClass(u,"tox-fullscreen"),E.removeClass(t,"tox-fullscreen"),function(v){f.window.scrollTo(v.x,v.y)}(a.scrollPos),e.set(null),On(n,!1),M.unbind(),n.off("remove",M.unbind);else{var y={scrollPos:function(){var v=In(f.window);return{x:v.x(),y:v.y()}}(),containerWidth:r.width,containerHeight:r.height,containerTop:r.top,containerLeft:r.left,iframeWidth:i.width,iframeHeight:i.height};m&&ue(n.dom,s,d),i.width=i.height="100%",r.width=r.height="",E.addClass(o,"tox-fullscreen"),E.addClass(u,"tox-fullscreen"),E.addClass(t,"tox-fullscreen"),M.bind(s),n.on("remove",M.unbind),e.set(y),On(n,!0)}},fe=function(n,e){n.addCommand("mceFullScreen",function(){se(n,e)})},ae=function(n,e){n.ui.registry.addToggleMenuItem("fullscreen",{text:"Fullscreen",shortcut:"Meta+Shift+F",onAction:function(){return n.execCommand("mceFullScreen")},onSetup:rn(n,e)}),n.ui.registry.addToggleButton("fullscreen",{tooltip:"Fullscreen",icon:"fullscreen",onAction:function(){return n.execCommand("mceFullScreen")},onSetup:rn(n,e)})};(function(){bn.add("fullscreen",function(e){var r=N(null);return e.settings.inline||(fe(e,r),ae(e,r),e.addShortcut("Meta+Shift+F","","mceFullScreen")),Cn(r)})})()})(window);
