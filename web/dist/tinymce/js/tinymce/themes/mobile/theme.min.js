(function(M){"use strict";var D=function(){return(D=Object.assign||function(n){for(var t,e=1,r=arguments.length;e<r;e++)for(var o in t=arguments[e])Object.prototype.hasOwnProperty.call(t,o)&&(n[o]=t[o]);return n}).apply(this,arguments)};function yu(n,t){var e={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&t.indexOf(r)<0&&(e[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function"){var o=0;for(r=Object.getOwnPropertySymbols(n);o<r.length;o++)t.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(n,r[o])&&(e[r[o]]=n[r[o]])}return e}function A(){}function un(n){return n}var wo=function(n,t){return function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];return n(t.apply(null,e))}},m=function(n){return function(){return n}};function Hn(n){for(var t=[],e=1;e<arguments.length;e++)t[e-1]=arguments[e];return function(){for(var r=[],o=0;o<arguments.length;o++)r[o]=arguments[o];var i=t.concat(r);return n.apply(null,i)}}function bu(n){return function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return!n.apply(null,t)}}function So(n){return function(){throw new Error(n)}}function xu(n){return n()}function tr(){return Oo}var To,Kn=m(!1),Zt=m(!0),Oo=(To={fold:function(n,t){return n()},is:Kn,isSome:Kn,isNone:Zt,getOr:Tu,getOrThunk:Su,getOrDie:function(n){throw new Error(n||"error: getOrDie called on none.")},getOrNull:m(null),getOrUndefined:m(void 0),or:Tu,orThunk:Su,map:tr,each:A,bind:tr,exists:Kn,forall:Zt,filter:tr,equals:wu,equals_:wu,toArray:function(){return[]},toString:m("none()")},Object.freeze&&Object.freeze(To),To);function wu(n){return n.isNone()}function Su(n){return n()}function Tu(n){return n}function gn(n,t){return Hu(n,function(e,r){return{k:r,v:t(e,r)}})}function cn(n,t){return cr(n,t)&&n[t]!==void 0&&n[t]!==null}function ql(n,t){var e=function(o,i){for(var u=0;u<o.length;u++){var c=o[u];if(c.test(i))return c}}(n,t);if(!e)return{major:0,minor:0};function r(o){return Number(t.replace(e,"$"+o))}return Ro(r(1),r(2))}function ne(n,t){return function(){return t===n}}function lt(n,t){return function(){return t===n}}function te(n){return function(t){return function(e){if(e===null)return"null";var r=typeof e;return r=="object"&&(Array.prototype.isPrototypeOf(e)||e.constructor&&e.constructor.name==="Array")?"array":r=="object"&&(String.prototype.isPrototypeOf(e)||e.constructor&&e.constructor.name==="String")?"string":r}(t)===n}}function hn(n,t){return-1<function(e,r){return nd.call(e,r)}(n,t)}function ko(n,t){for(var e=0,r=n.length;e<r;e++)if(t(n[e],e))return!0;return!1}function B(n,t){for(var e=0,r=n.length;e<r;e++)t(n[e],e)}function yn(n,t){for(var e=[],r=0,o=n.length;r<o;r++){var i=n[r];t(i,r)&&e.push(i)}return e}function er(n,t,e){return function(r,o){for(var i=r.length-1;0<=i;i--)o(r[i],i)}(n,function(r){e=t(e,r)}),e}function rr(n,t,e){return B(n,function(r){e=t(e,r)}),e}function Rn(n,t){for(var e=0,r=n.length;e<r;e++){var o=n[e];if(t(o,e))return g.some(o)}return g.none()}function ee(n,t){for(var e=0,r=n.length;e<r;e++)if(t(n[e],e))return g.some(e);return g.none()}function Ce(n){for(var t=[],e=0,r=n.length;e<r;++e){if(!re(n[e]))throw new Error("Arr.flatten item "+e+" was not an array, input: "+n);td.apply(t,n[e])}return t}function Pn(n,t){return Ce(P(n,t))}function Eo(n,t){for(var e=0,r=n.length;e<r;++e)if(t(n[e],e)!==!0)return!1;return!0}function De(n){var t=oc.call(n,0);return t.reverse(),t}function Ou(n,t){return yn(n,function(e){return!hn(t,e)})}function ku(n){return[n]}function Co(n,t){for(var e=0;e<n.length;e++){var r=t(n[e],e);if(r.isSome())return r}return g.none()}function Eu(n,t){var e=String(t).toLowerCase();return Rn(n,function(r){return r.search(e)})}function Sn(n,t){return n.indexOf(t)!==-1}function ot(n){return function(t){return Sn(t,n)}}function Ot(){return ud.get()}function kt(n,t){zo(n,n.element(),t,{})}function it(n,t,e){zo(n,n.element(),t,e)}function Cu(n){kt(n,lr())}function Do(n,t,e){zo(n,t,e,{})}function Et(n){var t,e=!1;return function(){for(var r=[],o=0;o<arguments.length;o++)r[o]=arguments[o];return e||(e=!0,t=n.apply(null,r)),t}}function Dn(n){return n.dom().nodeName.toLowerCase()}function Du(n){return function(t){return function(e){return e.dom().nodeType}(t)===n}}function Ct(n){var t=dr(n)?n.dom().parentNode:n.dom();return t!=null&&t.ownerDocument.body.contains(t)}function _o(){for(var n=[],t=0;t<arguments.length;t++)n[t]=arguments[t];return function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];if(n.length!==e.length)throw new Error('Wrong number of arguments to struct. Expected "['+n.length+']", got '+e.length+" arguments");var o={};return B(n,function(i,u){o[i]=m(e[u])}),o}}function or(n){return n.slice(0).sort()}function _u(n,t){if(!re(t))throw new Error("The "+n+" fields must be an array. Was: "+t+".");B(t,function(e){if(!Bo(e))throw new Error("The value "+e+" in the "+n+" fields was not a string.")})}function Mu(n,t){var e=n.concat(t);if(e.length===0)throw new Error("You must specify at least one required or optional field.");return _u("required",n),_u("optional",t),function(r){var o=or(r);Rn(o,function(i,u){return u<o.length-1&&i===o[u+1]}).each(function(i){throw new Error("The field: "+i+" occurs more than once in the combined fields: ["+o.join(", ")+"].")})}(e),function(r){var o=bn(r);Eo(n,function(c){return hn(o,c)})||function(c,a){throw new Error("All required keys ("+or(c).join(", ")+") were not specified. Specified keys were: "+or(a).join(", ")+".")}(n,o);var i=yn(o,function(c){return!hn(e,c)});0<i.length&&function(c){throw new Error("Unsupported keys for object: "+or(c).join(", "))}(i);var u={};return B(n,function(c){u[c]=m(r[c])}),B(t,function(c){u[c]=m(Object.prototype.hasOwnProperty.call(r,c)?g.some(r[c]):g.none())}),u}}function Yl(n,t,e){return(n.compareDocumentPosition(t)&e)!=0}function ir(n,t){var e=n.dom();if(e.nodeType!==vc)return!1;var r=e;if(r.matches!==void 0)return r.matches(t);if(r.msMatchesSelector!==void 0)return r.msMatchesSelector(t);if(r.webkitMatchesSelector!==void 0)return r.webkitMatchesSelector(t);if(r.mozMatchesSelector!==void 0)return r.mozMatchesSelector(t);throw new Error("Browser lacks native selectors")}function Iu(n){return n.nodeType!==vc&&n.nodeType!==xd||n.childElementCount===0}function Au(n,t){var e=t===void 0?M.document:t.dom();return Iu(e)?[]:P(e.querySelectorAll(n),_.fromDom)}function Fu(n,t){var e=t===void 0?M.document:t.dom();return Iu(e)?g.none():g.from(e.querySelector(n)).map(_.fromDom)}function on(n,t){return n.dom()===t.dom()}function zn(n){return _.fromDom(n.dom().ownerDocument)}function dt(n){return g.from(n.dom().parentNode).map(_.fromDom)}function Ru(n,t){var e=n.dom().childNodes;return g.from(e[t]).map(_.fromDom)}function Bu(n,t){dt(n).each(function(e){e.dom().insertBefore(t.dom(),n.dom())})}function Kl(n,t){(function(e){return g.from(e.dom().nextSibling).map(_.fromDom)})(n).fold(function(){dt(n).each(function(e){_n(e,t)})},function(e){Bu(e,t)})}function Jl(n,t){(function(e){return Ru(e,0)})(n).fold(function(){_n(n,t)},function(e){n.dom().insertBefore(t.dom(),e.dom())})}function Mo(n,t){B(t,function(e){_n(n,e)})}function Io(n){n.dom().textContent="",B(ut(n),function(t){Mt(t)})}function Vu(n,t){_n(n.element(),t.element())}function Ql(n,t){var e=n.components();(function(o){B(o.components(),function(i){return Mt(i.element())}),Io(o.element()),o.syncComponents()})(n);var r=Ou(e,t);B(r,function(o){mr(o),n.getSystem().removeFromWorld(o)}),B(t,function(o){o.getSystem().isConnected()?Vu(n,o):(n.getSystem().addToWorld(o),Vu(n,o),Ct(n.element())&&gr(o)),n.syncComponents()})}function Nu(n){var t=dt(n.element()).bind(function(e){return n.getSystem().getByDom(e).toOption()});(function(e){mr(e),Mt(e.element()),e.getSystem().removeFromWorld(e)})(n),t.each(function(e){e.syncComponents()})}function ju(n){return function(){for(var t=new Array(arguments.length),e=0;e<t.length;e++)t[e]=arguments[e];if(t.length===0)throw new Error("Can't merge zero objects");for(var r={},o=0;o<t.length;o++){var i=t[o];for(var u in i)Sd.call(i,u)&&(r[u]=n(r[u],i[u]))}return r}}var Ln,ur,Ao=function(n){function t(){return o}function e(i){return i(n)}var r=m(n),o={fold:function(i,u){return u(n)},is:function(i){return n===i},isSome:Zt,isNone:Kn,getOr:r,getOrThunk:r,getOrDie:r,getOrNull:r,getOrUndefined:r,or:t,orThunk:t,map:function(i){return Ao(i(n))},each:function(i){i(n)},bind:e,exists:e,forall:e,filter:function(i){return i(n)?o:Oo},toArray:function(){return[n]},toString:function(){return"some("+n+")"},equals:function(i){return i.is(n)},equals_:function(i,u){return i.fold(Kn,function(c){return u(n,c)})}};return o},g={some:Ao,none:tr,from:function(n){return n==null?Oo:Ao(n)}},bn=Object.keys,Zl=Object.hasOwnProperty,Tn=function(n,t){for(var e=bn(n),r=0,o=e.length;r<o;r++){var i=e[r];t(n[i],i)}},Hu=function(n,t){var e={};return Tn(n,function(r,o){var i=t(r,o);e[i.k]=i.v}),e},Fo=function(n,t){var e=[];return Tn(n,function(r,o){e.push(t(r,o))}),e},N=function(n,t){return cr(n,t)?g.from(n[t]):g.none()},cr=function(n,t){return Zl.call(n,t)},j=function(n){function t(){return e}var e=n;return{get:t,set:function(r){e=r},clone:function(){return j(t())}}},Pu=function(){return Ro(0,0)},Ro=function(n,t){return{major:n,minor:t}},ar={nu:Ro,detect:function(n,t){var e=String(t).toLowerCase();return n.length===0?Pu():ql(n,e)},unknown:Pu},zu="Edge",Lu="Chrome",Gu="Opera",Uu="Firefox",$u="Safari",Wu=function(n){var t=n.current;return{current:t,version:n.version,isEdge:ne(zu,t),isChrome:ne(Lu,t),isIE:ne("IE",t),isOpera:ne(Gu,t),isFirefox:ne(Uu,t),isSafari:ne($u,t)}},Xu={unknown:function(){return Wu({current:void 0,version:ar.unknown()})},nu:Wu,edge:m(zu),chrome:m(Lu),ie:m("IE"),opera:m(Gu),firefox:m(Uu),safari:m($u)},qu="Windows",Yu="Android",Ku="Linux",Ju="Solaris",Qu="FreeBSD",Zu="ChromeOS",nc=function(n){var t=n.current;return{current:t,version:n.version,isWindows:lt(qu,t),isiOS:lt("iOS",t),isAndroid:lt(Yu,t),isOSX:lt("OSX",t),isLinux:lt(Ku,t),isSolaris:lt(Ju,t),isFreeBSD:lt(Qu,t),isChromeOS:lt(Zu,t)}},tc={unknown:function(){return nc({current:void 0,version:ar.unknown()})},nu:nc,windows:m(qu),ios:m("iOS"),android:m(Yu),linux:m(Ku),osx:m("OSX"),solaris:m(Ju),freebsd:m(Qu),chromeos:m(Zu)},Bo=te("string"),Vo=te("object"),re=te("array"),ec=te("boolean"),Jn=te("function"),rc=te("number"),oc=Array.prototype.slice,nd=Array.prototype.indexOf,td=Array.prototype.push,P=function(n,t){for(var e=n.length,r=new Array(e),o=0;o<e;o++){var i=n[o];r[o]=t(i,o)}return r},ed=(Jn(Array.from)&&Array.from,function(n,t){return Eu(n,t).map(function(e){var r=ar.detect(e.versionRegexes,t);return{current:e.name,version:r}})}),rd=function(n,t){return Eu(n,t).map(function(e){var r=ar.detect(e.versionRegexes,t);return{current:e.name,version:r}})},No=/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,od=[{name:"Edge",versionRegexes:[/.*?edge\/ ?([0-9]+)\.([0-9]+)$/],search:function(n){return Sn(n,"edge/")&&Sn(n,"chrome")&&Sn(n,"safari")&&Sn(n,"applewebkit")}},{name:"Chrome",versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/,No],search:function(n){return Sn(n,"chrome")&&!Sn(n,"chromeframe")}},{name:"IE",versionRegexes:[/.*?msie\ ?([0-9]+)\.([0-9]+).*/,/.*?rv:([0-9]+)\.([0-9]+).*/],search:function(n){return Sn(n,"msie")||Sn(n,"trident")}},{name:"Opera",versionRegexes:[No,/.*?opera\/([0-9]+)\.([0-9]+).*/],search:ot("opera")},{name:"Firefox",versionRegexes:[/.*?firefox\/\ ?([0-9]+)\.([0-9]+).*/],search:ot("firefox")},{name:"Safari",versionRegexes:[No,/.*?cpu os ([0-9]+)_([0-9]+).*/],search:function(n){return(Sn(n,"safari")||Sn(n,"mobile/"))&&Sn(n,"applewebkit")}}],id=[{name:"Windows",search:ot("win"),versionRegexes:[/.*?windows\ nt\ ?([0-9]+)\.([0-9]+).*/]},{name:"iOS",search:function(n){return Sn(n,"iphone")||Sn(n,"ipad")},versionRegexes:[/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,/.*cpu os ([0-9]+)_([0-9]+).*/,/.*cpu iphone os ([0-9]+)_([0-9]+).*/]},{name:"Android",search:ot("android"),versionRegexes:[/.*?android\ ?([0-9]+)\.([0-9]+).*/]},{name:"OSX",search:ot("mac os x"),versionRegexes:[/.*?mac\ os\ x\ ?([0-9]+)_([0-9]+).*/]},{name:"Linux",search:ot("linux"),versionRegexes:[]},{name:"Solaris",search:ot("sunos"),versionRegexes:[]},{name:"FreeBSD",search:ot("freebsd"),versionRegexes:[]},{name:"ChromeOS",search:ot("cros"),versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/]}],ic={browsers:m(od),oses:m(id)},ud=j(function(n,t){var e=ic.browsers(),r=ic.oses(),o=ed(e,n).fold(Xu.unknown,Xu.nu),i=rd(r,n).fold(tc.unknown,tc.nu);return{browser:o,os:i,deviceType:function(u,c,a,f){var s=u.isiOS()&&/ipad/i.test(a)===!0,l=u.isiOS()&&!s,d=u.isiOS()||u.isAndroid(),v=d||f("(pointer:coarse)"),p=s||!l&&d&&f("(min-device-width:768px)"),y=l||d&&!p,h=c.isSafari()&&u.isiOS()&&/safari/i.test(a)===!1,x=!y&&!p&&!h;return{isiPad:m(s),isiPhone:m(l),isTablet:m(p),isPhone:m(y),isTouch:m(v),isAndroid:u.isAndroid,isiOS:u.isiOS,isWebView:m(h),isDesktop:m(x)}}(i,o,n,t)}}(M.navigator.userAgent,function(n){return M.window.matchMedia(n).matches})),Dt=m("touchstart"),fr=m("touchmove"),sr=m("touchend"),oe=m("mousedown"),jo=m("mousemove"),uc=m("mouseup"),cc=m("mouseover"),cd=m("keydown"),ad=m("keyup"),ac=m("input"),fd=m("change"),fc=m("click"),Ho=m("transitionend"),sd=m("selectstart"),ld={tap:m("alloy.tap")},_t=m("alloy.focus"),dd=m("alloy.blur.post"),md=m("alloy.paste.post"),sc=m("alloy.receive"),lr=m("alloy.execute"),_e=m("alloy.focus.item"),lc=ld.tap,gd=m("alloy.longpress"),Po=m("alloy.system.init"),dc=m("alloy.system.attached"),mc=m("alloy.system.detached"),pd=m("alloy.focusmanager.shifted"),hd=m("alloy.highlight"),gc=m("alloy.dehighlight"),zo=function(n,t,e,r){var o=D({target:t},r);n.getSystem().triggerEvent(e,t,gn(o,m))},Me=function(n){if(n==null)throw new Error("Node cannot be null or undefined");return{dom:m(n)}},_={fromHtml:function(n,t){var e=(t||M.document).createElement("div");if(e.innerHTML=n,!e.hasChildNodes()||1<e.childNodes.length)throw M.console.error("HTML does not have a single root node",n),new Error("HTML must have a single root node");return Me(e.childNodes[0])},fromTag:function(n,t){var e=(t||M.document).createElement(n);return Me(e)},fromText:function(n,t){var e=(t||M.document).createTextNode(n);return Me(e)},fromDom:Me,fromPoint:function(n,t,e){var r=n.dom();return g.from(r.elementFromPoint(t,e)).map(Me)}},vd=(M.Node.ATTRIBUTE_NODE,M.Node.CDATA_SECTION_NODE,M.Node.COMMENT_NODE,M.Node.DOCUMENT_NODE),pc=(M.Node.DOCUMENT_TYPE_NODE,M.Node.DOCUMENT_FRAGMENT_NODE,M.Node.ELEMENT_NODE),yd=M.Node.TEXT_NODE,Lo=(M.Node.PROCESSING_INSTRUCTION_NODE,M.Node.ENTITY_REFERENCE_NODE,M.Node.ENTITY_NODE,M.Node.NOTATION_NODE,typeof M.window!="undefined"?M.window:Function("return this;")(),Du(pc)),dr=Du(yd),hc=Et(function(){return bd(_.fromDom(M.document))}),bd=function(n){var t=n.dom().body;if(t==null)throw new Error("Body is not available yet");return _.fromDom(t)},by=function(n,t){return Yl(n,t,M.Node.DOCUMENT_POSITION_CONTAINED_BY)},vc=pc,xd=vd,ut=(Ot().browser.isIE(),function(n){return P(n.dom().childNodes,_.fromDom)}),_n=(_o("element","offset"),function(n,t){n.dom().appendChild(t.dom())}),Mt=function(n){var t=n.dom();t.parentNode!==null&&t.parentNode.removeChild(t)},mr=function(n){kt(n,mc());var t=n.components();B(t,mr)},gr=function(n){var t=n.components();B(t,gr),kt(n,dc())},yc=function(n,t,e){n.getSystem().addToWorld(t),e(n.element(),t.element()),Ct(n.element())&&gr(t),n.syncComponents()},wd=function(n,t,e){e(n,t.element());var r=ut(t.element());B(r,function(o){t.getByDom(o).each(gr)})},ie=function(n){return{is:function(t){return n===t},isValue:Zt,isError:Kn,getOr:m(n),getOrThunk:m(n),getOrDie:m(n),or:function(t){return ie(n)},orThunk:function(t){return ie(n)},fold:function(t,e){return e(n)},map:function(t){return ie(t(n))},mapError:function(t){return ie(n)},each:function(t){t(n)},bind:function(t){return t(n)},exists:function(t){return t(n)},forall:function(t){return t(n)},toOption:function(){return g.some(n)}}},Ie=function(n){return{is:Kn,isValue:Kn,isError:Zt,getOr:un,getOrThunk:function(t){return t()},getOrDie:function(){return So(String(n))()},or:function(t){return t},orThunk:function(t){return t()},fold:function(t,e){return t(n)},map:function(t){return Ie(n)},mapError:function(t){return Ie(t(n))},each:A,bind:function(t){return Ie(n)},exists:Kn,forall:Zt,toOption:g.none}},en={value:ie,error:Ie,fromOption:function(n,t){return n.fold(function(){return Ie(t)},ie)}},Qn=function(n){if(!re(n))throw new Error("cases must be an array");if(n.length===0)throw new Error("there must be at least one case");var t=[],e={};return B(n,function(r,o){var i=bn(r);if(i.length!==1)throw new Error("one and only one name per case");var u=i[0],c=r[u];if(e[u]!==void 0)throw new Error("duplicate key detected:"+u);if(u==="cata")throw new Error("cannot have a case named cata (sorry)");if(!re(c))throw new Error("case arguments must be an array");t.push(u),e[u]=function(){var a=arguments.length;if(a!==c.length)throw new Error("Wrong number of arguments to case "+u+". Expected "+c.length+" ("+c+"), got "+a);for(var f=new Array(a),s=0;s<f.length;s++)f[s]=arguments[s];return{fold:function(){if(arguments.length!==n.length)throw new Error("Wrong number of arguments to fold. Expected "+n.length+", got "+arguments.length);return arguments[o].apply(null,f)},match:function(l){var d=bn(l);if(t.length!==d.length)throw new Error("Wrong number of arguments to match. Expected: "+t.join(",")+`
Actual: `+d.join(","));if(!Eo(t,function(v){return hn(d,v)}))throw new Error("Not all branches were specified when using match. Specified: "+d.join(", ")+`
Required: `+t.join(", "));return l[u].apply(null,f)},log:function(l){M.console.log(l,{constructors:t,constructor:u,params:f})}}}}),e},Sd=Object.prototype.hasOwnProperty,an=ju(function(n,t){return Vo(n)&&Vo(t)?an(n,t):t}),bc=ju(function(n,t){return t});(ur=Ln=Ln||{})[ur.Error=0]="Error",ur[ur.Value=1]="Value";function xc(n,t,e){return n.stype===Ln.Error?t(n.serror):e(n.svalue)}function wc(n){return{stype:Ln.Value,svalue:n}}function Sc(n){return{stype:Ln.Error,serror:n}}function pr(n){return Ft.defaultedThunk(m(n))}function Ae(n,t){var e;return(e={})[n]=t,e}function Td(n,t){return function(e,r){var o={};return Tn(e,function(i,u){hn(r,u)||(o[u]=i)}),o}(n,t)}function On(n,t){return Ae(n,t)}function Gn(n){return function(t){var e={};return B(t,function(r){e[r.key]=r.value}),e}(n)}function Od(n,t){var e=function(r){var o=[],i=[];return B(r,function(u){u.fold(function(c){o.push(c)},function(c){i.push(c)})}),{errors:o,values:i}}(n);return 0<e.errors.length?function(r){return en.error(Ce(r))}(e.errors):function(r,o){return r.length===0?en.value(o):en.value(an(o,bc.apply(void 0,r)))}(e.values,t)}function Tc(n){return wo(Be,Ce)(n)}function Go(n){return Vo(n)&&100<bn(n).length?" removed due to size":JSON.stringify(n,null,2)}function Fe(n,t){return Be([{path:n,getErrorInfo:t}])}function kd(n,t,e){return N(t,e).fold(function(){return function(r,o,i){return Fe(r,function(){return'Could not find valid *strict* value for "'+o+'" in '+Go(i)})}(n,e,t)},In)}function Oc(n,t,e){var r=N(n,t).fold(function(){return e(n)},un);return In(r)}function Ed(n,t,e,r){return e.fold(function(o,i,u,c){function a(s){var l=c.extract(n.concat([o]),r,s);return Zo(l,function(d){return Ae(i,r(d))})}function f(s){return s.fold(function(){var l=Ae(i,r(g.none()));return In(l)},function(l){var d=c.extract(n.concat([o]),r,l);return Zo(d,function(v){return Ae(i,r(g.some(v)))})})}return u.fold(function(){return le(kd(n,t,o),a)},function(s){return le(Oc(t,o,s),a)},function(){return le(function(s,l){return In(N(s,l))}(t,o),f)},function(s){return le(function(l,d,v){var p=N(l,d).map(function(y){return y===!0?v(l):y});return In(p)}(t,o,s),f)},function(s){var l=s(t),d=Zo(Oc(t,o,m({})),function(v){return an(l,v)});return le(d,a)})},function(o,i){var u=i(t);return In(Ae(o,r(u)))})}function ue(n){return{extract:function(t,e,r){return jd(n(r,e),function(o){return function(i,u){return Fe(i,function(){return u})}(t,o)})},toString:function(){return"val"}}}function Mn(n){var t=ln(n),e=er(n,function(r,o){return o.fold(function(i){return an(r,On(i,!0))},m(r))},{});return{extract:function(r,o,i){var u=ec(i)?[]:function(a){var f=bn(a);return yn(f,function(s){return cn(a,s)})}(i),c=yn(u,function(a){return!cn(e,a)});return c.length===0?t.extract(r,o,i):function(a,f){return Fe(a,function(){return"There are unsupported fields: ["+f.join(", ")+"] specified"})}(r,c)},toString:t.toString}}function Cd(n,t){function e(r,o){return function(i){return{extract:function(u,c,a){var f=P(a,function(s,l){return i.extract(u.concat(["["+l+"]"]),c,s)});return Gd(f)},toString:function(){return"array("+i.toString()+")"}}}(ue(n)).extract(r,un,o)}return{extract:function(r,o,i){var u=bn(i),c=e(r,u);return le(c,function(a){var f=P(a,function(s){return ti.field(s,s,Rt(),t)});return ln(f).extract(r,o,i)})},toString:function(){return"setOf("+t.toString()+")"}}}function Dd(n,t,e,r,o){return N(r,o).fold(function(){return function(i,u,c){return Fe(i,function(){return'The chosen schema: "'+c+'" did not exist in branches: '+Go(u)})}(n,r,o)},function(i){return i.extract(n.concat(["branch: "+o]),t,e)})}function _d(n,t){return{extract:function(e,r,o){return N(o,n).fold(function(){return function(i,u){return Fe(i,function(){return'Choice schema did not contain choice key: "'+u+'"'})}(e,n)},function(i){return Dd(e,r,o,t,i)})},toString:function(){return"chooseOn("+n+"). Possible values: "+bn(t)}}}function kc(n){return ue(function(t){return n(t).fold(Be,In)})}function Uo(n,t){return Cd(function(e){return Vd(n(e))},t)}function $o(n,t,e){return Nd(function(r,o,i,u){var c=o.extract([r],i,u);return Hd(c,function(a){return{input:u,errors:a}})}(n,t,un,e))}function Ec(n){return n.fold(function(t){throw new Error(Nc(t))},un)}function fn(n,t,e){return Ec($o(n,t,e))}function It(n,t){return _d(n,gn(t,ln))}function O(n){return An(n,n,Rt(),ei())}function ce(n,t){return An(n,n,Rt(),t)}function mt(n,t){return An(n,n,Rt(),ln(t))}function $(n){return An(n,n,ni(),ei())}function Wo(n,t){return An(n,n,ni(),t)}function Xo(n,t){return Wo(n,ln(t))}function Cc(n,t){return Wo(n,Mn(t))}function w(n,t){return An(n,n,pr(t),ei())}function Re(n,t,e){return An(n,n,pr(t),e)}function kn(n,t){return Ud(n,t)}function Dc(n,t){return on(n.element(),t.event().target())}function ae(n){if(!cn(n,"can")&&!cn(n,"abort")&&!cn(n,"run"))throw new Error("EventHandler defined by: "+JSON.stringify(n,null,2)+" does not have can, abort, or run!");return fn("Extracting event.handler",Mn([w("can",m(!0)),w("abort",m(!1)),w("run",A)]),n)}function Md(n){var t=function(r,o){return function(){for(var i=[],u=0;u<arguments.length;u++)i[u]=arguments[u];return rr(r,function(c,a){return c&&o(a).apply(void 0,i)},!0)}}(n,function(r){return r.can}),e=function(r,o){return function(){for(var i=[],u=0;u<arguments.length;u++)i[u]=arguments[u];return rr(r,function(c,a){return c||o(a).apply(void 0,i)},!1)}}(n,function(r){return r.abort});return ae({can:t,abort:e,run:function(){for(var r=[],o=0;o<arguments.length;o++)r[o]=arguments[o];B(n,function(i){i.run.apply(void 0,r)})}})}function tn(n){return Gn(n)}function _c(n,t){return{key:n,value:ae({abort:t})}}function z(n,t){return{key:n,value:ae({run:t})}}function qo(n,t,e){return{key:n,value:ae({run:function(r,o){t.apply(void 0,[r,o].concat(e))}})}}function hr(n){return function(t){return{key:n,value:ae({run:function(e,r){Dc(e,r)&&t(e,r)}})}}}function fe(n,t,e){return function(r,o){return z(r,function(i,u){i.getSystem().getByUid(o).each(function(c){(function(a,f,s,l){a.getSystem().triggerEvent(s,f,l.event())})(c,c.element(),r,u)})})}(n,t.partUids[e])}function Yo(n){return z(n,function(t,e){e.cut()})}function Ko(n,t){var e=n.toString(),r=e.indexOf(")")+1,o=e.indexOf("("),i=e.substring(o+1,r-1).split(/,\s*/);return n.toFunctionAnnotation=function(){return{name:t,parameters:ri(i)}},n}function Zn(n){return{classes:n.classes!==void 0?n.classes:[],attributes:n.attributes!==void 0?n.attributes:{},styles:n.styles!==void 0?n.styles:{}}}function Jo(n,t,e){return Hc(function(r,o){e(r,n,t)})}function Id(n,t,e){return function(r,o,i){var u=i.toString(),c=u.indexOf(")")+1,a=u.indexOf("("),f=u.substring(a+1,c-1).split(/,\s*/);return r.toFunctionAnnotation=function(){return{name:o,parameters:ri(f.slice(0,1).concat(f.slice(3)))}},r}(function(r){for(var o=[],i=1;i<arguments.length;i++)o[i-1]=arguments[i];var u=[r].concat(o);return r.config({name:m(n)}).fold(function(){throw new Error("We could not find any behaviour configuration for: "+n+". Using API: "+e)},function(c){var a=Array.prototype.slice.call(u,1);return t.apply(void 0,[r,c.config,c.state].concat(a))})},e,t)}function Ad(n){return{key:n,value:void 0}}function En(n){var t=fn("Creating behaviour: "+n.name,qd,n);return function(e,r,o,i,u,c){var a=Mn(e),f=Xo(r,[Cc("config",e)]);return Pc(a,f,r,o,i,u,c)}(t.fields,t.name,t.active,t.apis,t.extra,t.state)}function Mc(n,t,e){if(!(Bo(e)||ec(e)||rc(e)))throw M.console.error("Invalid call to Attr.set. Key ",t,":: Value ",e,":: Element ",n),new Error("Attribute value was not simple");n.setAttribute(t,e+"")}function H(n,t,e){Mc(n.dom(),t,e)}function Ic(n,t){var e=n.dom();Tn(t,function(r,o){Mc(e,o,r)})}function X(n,t){var e=n.dom().getAttribute(t);return e===null?void 0:e}function se(n,t){var e=n.dom();return!(!e||!e.hasAttribute)&&e.hasAttribute(t)}function xn(n,t){n.dom().removeAttribute(t)}function Qo(n,t){var e=X(n,t);return e===void 0||e===""?[]:e.split(" ")}function vr(n){return n.dom().classList!==void 0}function Fd(n,t){return function(e,r,o){var i=Qo(e,r).concat([o]);return H(e,r,i.join(" ")),!0}(n,"class",t)}function Rd(n,t){return function(e,r,o){var i=yn(Qo(e,r),function(u){return u!==o});return 0<i.length?H(e,r,i.join(" ")):xn(e,r),!1}(n,"class",t)}function pn(n,t){vr(n)?n.dom().classList.add(t):Fd(n,t)}function Bd(n){(vr(n)?n.dom().classList:function(t){return Qo(t,"class")}(n)).length===0&&xn(n,"class")}function sn(n,t){vr(n)?n.dom().classList.remove(t):Rd(n,t),Bd(n)}function At(n,t){return vr(n)&&n.dom().classList.contains(t)}function Ac(n,t,e){sn(n,e),pn(n,t)}var Fc,Rc,Bc,Vd=function(n){return n.fold(Sc,wc)},Nd=function(n){return xc(n,en.error,en.value)},In=wc,Vc=function(n){var t=[],e=[];return B(n,function(r){xc(r,function(o){return e.push(o)},function(o){return t.push(o)})}),{values:t,errors:e}},Be=Sc,le=function(n,t){return n.stype===Ln.Value?t(n.svalue):n},jd=function(n,t){return n.stype===Ln.Error?t(n.serror):n},Zo=function(n,t){return n.stype===Ln.Value?{stype:Ln.Value,svalue:t(n.svalue)}:n},Hd=function(n,t){return n.stype===Ln.Error?{stype:Ln.Error,serror:t(n.serror)}:n},Ft=Qn([{strict:[]},{defaultedThunk:["fallbackThunk"]},{asOption:[]},{asDefaultedOptionThunk:["fallbackThunk"]},{mergeWithThunk:["baseThunk"]}]),Rt=Ft.strict,ni=Ft.asOption,Pd=Ft.defaultedThunk,zd=(Ft.asDefaultedOptionThunk,Ft.mergeWithThunk),Ld=(Qn([{bothErrors:["error1","error2"]},{firstError:["error1","value2"]},{secondError:["value1","error2"]},{bothValues:["value1","value2"]}]),function(n,t){var e=Vc(n);return 0<e.errors.length?Tc(e.errors):function(r,o){return 0<r.length?In(an(o,bc.apply(void 0,r))):In(o)}(e.values,t)}),Gd=function(n){var t=Vc(n);return 0<t.errors.length?Tc(t.errors):In(t.values)},ti=Qn([{field:["key","okey","presence","prop"]},{state:["okey","instantiator"]}]),ln=function(n){return{extract:function(t,e,r){return function(o,i,u,c){var a=P(u,function(f){return Ed(o,i,f,c)});return Ld(a,{})}(t,r,n,e)},toString:function(){return`obj{
`+P(n,function(t){return t.fold(function(e,r,o,i){return e+" -> "+i.toString()},function(e,r){return"state("+e+")"})}).join(`
`)+"}"}}},ei=m(ue(In)),Ud=ti.state,An=ti.field,$d=ue(In),Nc=function(n){return`Errors: 
`+function(t){var e=10<t.length?t.slice(0,10).concat([{path:[],getErrorInfo:function(){return"... (only showing first ten failures)"}}]):t;return P(e,function(r){return"Failed path: ("+r.path.join(" > ")+`)
`+r.getErrorInfo()})}(n.errors).join(`
`)+`

Input object: `+Go(n.input)},yr=m($d),Wd=(Fc=Jn,Rc="function",ue(function(n){var t=typeof n;return Fc(n)?In(n):Be("Expected type: "+Rc+" but got: "+t)})),Xd=function(n,t,e){return t(n).orThunk(function(){return e(n)?g.none():function(r,o,i){for(var u=r.dom(),c=Jn(i)?i:m(!1);u.parentNode;){u=u.parentNode;var a=_.fromDom(u),f=o(a);if(f.isSome())return f;if(c(a))break}return g.none()}(n,t,e)})},Bt=hr(dc()),jc=hr(mc()),Hc=hr(Po()),Ve=(Bc=lr(),function(n){return z(Bc,n)}),ri=function(n){return P(n,function(t){return function(e,r){return function(o,i,u){return i===""||!(o.length<i.length)&&o.substr(u,u+i.length)===i}(e,r,e.length-r.length)}(t,"/*")?t.substring(0,t.length-"/*".length):t})},Pc=function(n,t,e,r,o,i,u){function c(l){return cn(l,e)?l[e]():g.none()}var a=gn(o,function(l,d){return Id(e,l,d)}),f=gn(i,function(l,d){return Ko(l,d)}),s=D(D(D({},f),a),{revoke:Hn(Ad,e),config:function(l){var d=fn(e+"-config",n,l);return{key:e,value:{config:d,me:s,configAsRaw:Et(function(){return fn(e+"-config",n,l)}),initialConfig:l,state:u}}},schema:function(){return t},exhibit:function(l,d){return c(l).bind(function(v){return N(r,"exhibit").map(function(p){return p(d,v.config,v.state)})}).getOr(Zn({}))},name:function(){return e},handlers:function(l){return c(l).map(function(d){return N(r,"events").getOr(function(){return{}})(d.config,d.state)}).getOr({})}});return s},Un={init:function(){return de({readState:function(){return"No State required"}})}},de=function(n){return n},W=function(n){return Gn(n)},qd=Mn([O("fields"),O("name"),w("active",{}),w("apis",{}),w("state",Un),w("extra",{})]),Yd=Mn([O("branchKey"),O("branches"),O("name"),w("active",{}),w("apis",{}),w("state",Un),w("extra",{})]),Kd=m(void 0),Jd=Object.freeze({__proto__:null,toAlpha:function(n,t,e){Ac(n.element(),t.alpha,t.omega)},toOmega:function(n,t,e){Ac(n.element(),t.omega,t.alpha)},isAlpha:function(n,t,e){return At(n.element(),t.alpha)},isOmega:function(n,t,e){return At(n.element(),t.omega)},clear:function(n,t,e){sn(n.element(),t.alpha),sn(n.element(),t.omega)}}),Qd=[O("alpha"),O("omega")],br=En({fields:Qd,name:"swapping",apis:Jd});function zc(n,t,e,r,o){return n(e,r)?g.some(e):Jn(o)&&o(e)?g.none():t(e,r,o)}function Lc(n,t,e){for(var r=n.dom(),o=Jn(e)?e:m(!1);r.parentNode;){r=r.parentNode;var i=_.fromDom(r);if(t(i))return g.some(i);if(o(i))break}return g.none()}function Vt(n){n.dom().focus()}function gt(n){n.dom().blur()}function Nt(n){var t=n!==void 0?n.dom():M.document;return g.from(t.activeElement).map(_.fromDom)}function xr(n){return Nt(zn(n)).filter(function(t){return n.dom().contains(t.dom())})}function Gc(n){return n.dom().innerHTML}function Zd(n,t){var e=zn(n).dom(),r=_.fromDom(e.createDocumentFragment()),o=function(i,u){var c=(u||M.document).createElement("div");return c.innerHTML=i,ut(_.fromDom(c))}(t,e);Mo(r,o),Io(n),_n(n,r)}function nm(n){return function(t,e){return _.fromDom(t.dom().cloneNode(e))}(n,!1)}function tm(n){return function(t){var e=_.fromTag("div"),r=_.fromDom(t.dom().cloneNode(!0));return _n(e,r),Gc(e)}(nm(n))}function pt(n){return tm(n)}var me,ge,em=tinymce.util.Tools.resolve("tinymce.dom.DOMUtils"),rm=tinymce.util.Tools.resolve("tinymce.ThemeManager"),om=function(n){var t=M.document.createElement("a");t.target="_blank",t.href=n.href,t.rel="noreferrer noopener";var e=M.document.createEvent("MouseEvents");e.initMouseEvent("click",!0,!0,M.window,0,0,0,0,0,!1,!1,!1,!1,0,null),M.document.body.appendChild(t),t.dispatchEvent(e),M.document.body.removeChild(t)},jt={formatChanged:m("formatChanged"),orientationChanged:m("orientationChanged"),dropupDismissed:m("dropupDismissed")},im=Object.freeze({__proto__:null,events:function(n){return tn([z(sc(),function(t,e){var r=n.channels,o=bn(r),i=e,u=function(c,a){return a.universal()?c:yn(c,function(f){return hn(a.channels(),f)})}(o,i);B(u,function(c){var a=r[c],f=a.schema,s=fn("channel["+c+`] data
Receiver: `+pt(t.element()),f,i.data());a.onReceive(t,s)})})])}}),um="unknown";(ge=me=me||{})[ge.STOP=0]="STOP",ge[ge.NORMAL=1]="NORMAL",ge[ge.LOGGING=2]="LOGGING";function cm(n,t,e){switch(N(ci.get(),n).orThunk(function(){var i=bn(ci.get());return Co(i,function(u){return-1<n.indexOf(u)?g.some(ci.get()[u]):g.none()})}).getOr(me.NORMAL)){case me.NORMAL:return e(fm());case me.LOGGING:var r=function(i,u){var c=[],a=new Date().getTime();return{logEventCut:function(f,s,l){c.push({outcome:"cut",target:s,purpose:l})},logEventStopped:function(f,s,l){c.push({outcome:"stopped",target:s,purpose:l})},logNoParent:function(f,s,l){c.push({outcome:"no-parent",target:s,purpose:l})},logEventNoHandlers:function(f,s){c.push({outcome:"no-handlers-left",target:s})},logEventResponse:function(f,s,l){c.push({outcome:"response",purpose:l,target:s})},write:function(){var f=new Date().getTime();hn(["mousemove","mouseover","mouseout",Po()],i)||M.console.log(i,{event:i,time:f-a,target:u.dom(),sequence:P(c,function(s){return hn(["cut","stopped","response"],s.outcome)?"{"+s.purpose+"} "+s.outcome+" at ("+pt(s.target)+")":s.outcome})})}}}(n,t),o=e(r);return r.write(),o;case me.STOP:return!0}}function oi(n,t,e){return cm(n,t,e)}function wr(n,t,e){return function(){var r=new Error;if(r.stack!==void 0){var o=r.stack.split(`
`);Rn(o,function(i){return 0<i.indexOf("alloy")&&!ko(am,function(u){return-1<i.indexOf(u)})}).getOr(um)}}(),An(t,t,e,kc(function(r){return en.value(function(){for(var o=[],i=0;i<arguments.length;i++)o[i]=arguments[i];return r.apply(void 0,o)})}))}function dn(n){return wr(0,n,pr(A))}function Bn(n){return wr(0,n,pr(g.none))}function ii(n){return wr(0,n,Rt())}function Uc(n){return wr(0,n,Rt())}function K(n,t){return kn(n,m(t))}function $c(n){return kn(n,un)}function Wc(n,t,e){var r=t.aria;r.update(n,r,e.get())}function Xc(n,t,e){t.toggleClass.each(function(r){e.get()?pn(n.element(),r):sn(n.element(),r)})}function qc(n,t,e){fi(n,t,e,!e.get())}function Yc(n,t,e){e.set(!0),Xc(n,t,e),Wc(n,t,e)}function Kc(n,t,e){e.set(!1),Xc(n,t,e),Wc(n,t,e)}function Jc(n,t,e){fi(n,t,e,t.selected)}function Qc(){function n(t,e){e.stop(),Cu(t)}return[z(fc(),n),z(lc(),n),Yo(Dt()),Yo(oe())]}function Zc(n,t){t.ignore||(Vt(n.element()),t.onFocus(n))}function Sr(n){return n.style!==void 0&&Jn(n.style.getPropertyValue)}function na(n,t,e){if(!Bo(e))throw M.console.error("Invalid call to CSS.set. Property ",t,":: Value ",e,":: Element ",n),new Error("CSS value must be a string: "+e);Sr(n)&&n.style.setProperty(t,e)}function pe(n,t){var e=n.dom();Tn(t,function(r,o){na(e,o,r)})}function Ne(n,t){var e=n.dom(),r=M.window.getComputedStyle(e).getPropertyValue(t),o=r!==""||Ct(n)?r:ca(e,t);return o===null?void 0:o}function Ht(n,t){var e=n.dom(),r=ca(e,t);return g.from(r).filter(function(o){return 0<o.length})}function Pt(n,t){(function(e,r){Sr(e)&&e.style.removeProperty(r)})(n.dom(),t),se(n,"style")&&function(e){return e.replace(/^\s+|\s+$/g,"")}(X(n,"style"))===""&&xn(n,"style")}function Tr(n){return n.dom().offsetWidth}var ui,ci=j({}),am=["alloy/data/Fields","alloy/debugging/Debugging"],fm=m({logEventCut:A,logEventStopped:A,logNoParent:A,logEventNoHandlers:A,logEventResponse:A,write:A}),ta=m([O("menu"),O("selectedMenu")]),ai=m([O("item"),O("selectedItem")]),sm=(m(ln(ai().concat(ta()))),m(ln(ai()))),lm=mt("initSize",[O("numColumns"),O("numRows")]),ea=m(lm),dm=[ce("channels",Uo(en.value,Mn([ii("onReceive"),w("schema",yr())])))],Or=En({fields:dm,name:"receiving",active:im}),fi=function(n,t,e,r){(r?Yc:Kc)(n,t,e)},mm=Object.freeze({__proto__:null,onLoad:Jc,toggle:qc,isOn:function(n,t,e){return e.get()},on:Yc,off:Kc,set:fi}),gm=Object.freeze({__proto__:null,exhibit:function(){return Zn({})},events:function(n,t){var e=function(o,i,u){return Ve(function(c){u(c,o,i)})}(n,t,qc),r=Jo(n,t,Jc);return tn(Ce([n.toggleOnExecute?[e]:[],[r]]))}}),ra=function(n,t,e){H(n.element(),"aria-expanded",e)},pm=[w("selected",!1),$("toggleClass"),w("toggleOnExecute",!0),Re("aria",{mode:"none"},It("mode",{pressed:[w("syncWithExpanded",!1),K("update",function(n,t,e){H(n.element(),"aria-pressed",e),t.syncWithExpanded&&ra(n,t,e)})],checked:[K("update",function(n,t,e){H(n.element(),"aria-checked",e)})],expanded:[K("update",ra)],selected:[K("update",function(n,t,e){H(n.element(),"aria-selected",e)})],none:[K("update",A)]}))],G=En({fields:pm,name:"toggling",active:gm,apis:mm,state:(ui=!1,{init:function(){var n=j(ui);return{get:function(){return n.get()},set:function(t){return n.set(t)},clear:function(){return n.set(ui)},readState:function(){return n.get()}}}})}),oa=function(n,t){return Or.config({channels:On(jt.formatChanged(),{onReceive:function(e,r){r.command===n&&t(e,r.state)}})})},kr=function(n){return Or.config({channels:On(jt.orientationChanged(),{onReceive:n})})},ia=function(n,t){return{key:n,value:{onReceive:t}}},ua="tinymce-mobile",E={resolve:function(n){return ua+"-"+n},prefix:m(ua)},hm=Object.freeze({__proto__:null,focus:Zc,blur:function(n,t){t.ignore||gt(n.element())},isFocused:function(n){return function(t){var e=zn(t).dom();return t.dom()===e.activeElement}(n.element())}}),vm=Object.freeze({__proto__:null,exhibit:function(n,t){var e=t.ignore?{}:{attributes:{tabindex:"-1"}};return Zn(e)},events:function(n){return tn([z(_t(),function(t,e){Zc(t,n),e.stop()})].concat(n.stopMousedown?[z(oe(),function(t,e){e.event().prevent()})]:[]))}}),ym=[dn("onFocus"),w("stopMousedown",!1),w("ignore",!1)],vn=En({fields:ym,name:"focusing",active:vm,apis:hm}),U=function(n,t,e){var r=n.dom();na(r,t,e)},ca=function(n,t){return Sr(n)?n.style.getPropertyValue(t):""};function aa(n,t){function e(o){var i=t(o);if(i<=0||i===null){var u=Ne(o,n);return parseFloat(u)||0}return i}function r(o,i){return rr(i,function(u,c){var a=Ne(o,c),f=a===void 0?0:parseInt(a,10);return isNaN(f)?u:u+f},0)}return{set:function(o,i){if(!rc(i)&&!i.match(/^[0-9]+$/))throw new Error(n+".set accepts only positive integer values. Value was "+i);var u=o.dom();Sr(u)&&(u.style[n]=i+"px")},get:e,getOuter:e,aggregate:r,max:function(o,i,u){var c=r(o,u);return c<i?i-c:0}}}function Fn(n){return Em.get(n)}function bm(n,t,e){return yn(function(r,o){for(var i=Jn(o)?o:Kn,u=r.dom(),c=[];u.parentNode!==null&&u.parentNode!==void 0;){var a=u.parentNode,f=_.fromDom(a);if(c.push(f),i(f)===!0)break;u=a}return c}(n,e),t)}function xm(n,t){return yn(function(e){return dt(e).map(ut).map(function(r){return yn(r,function(o){return!on(e,o)})}).getOr([])}(n),t)}function wn(n,t){return Au(t,n)}function fa(n){return Fu(n)}function si(n,t,e){return Lc(n,function(r){return ir(r,t)},e)}function ht(n,t){return Fu(t,n)}function ct(n,t,e){return zc(ir,si,n,t,e)}function wm(n,t,e){var r=De(n.slice(0,t)),o=De(n.slice(t+1));return Rn(r.concat(o),e)}function Sm(n,t,e){var r=De(n.slice(0,t));return Rn(r,e)}function Tm(n,t,e){var r=n.slice(0,t),o=n.slice(t+1);return Rn(o.concat(r),e)}function Om(n,t,e){var r=n.slice(t+1);return Rn(r,e)}function F(n){return function(t){var e=t.raw();return hn(n,e.which)}}function $n(n){return function(t){return Eo(n,function(e){return e(t)})}}function he(n){return n.raw().shiftKey===!0}function km(n){return n.raw().ctrlKey===!0}function R(n,t){return{matches:n,classification:t}}function li(n){for(var t=[],e=function(o){t.push(o)},r=0;r<n.length;r++)n[r].each(e);return t}function ve(n,t,e,r){var o=n+t;return r<o?e:o<e?r:o}function je(n,t,e){return Math.min(Math.max(n,t),e)}function sa(n,t,e,r){var o=wn(n.element(),"."+t.highlightClass);B(o,function(i){ko(r,function(u){return u.element()===i})||(sn(i,t.highlightClass),n.getSystem().getByDom(i).each(function(u){t.onDehighlight(n,u),kt(u,gc())}))})}function He(n,t,e,r){sa(n,t,0,[r]),gi(n,t,e,r)||(pn(r.element(),t.highlightClass),t.onHighlight(n,r),kt(r,hd()))}function la(n,t,e,r){var o=wn(n.element(),"."+t.itemClass);return ee(o,function(i){return At(i,t.highlightClass)}).bind(function(i){var u=ve(i,r,0,o.length-1);return n.getSystem().getByDom(o[u]).toOption()})}function da(n,t,e){t.exists(function(r){return e.exists(function(o){return on(o,r)})})||it(n,pd(),{prevFocus:t,newFocus:e})}function di(){function n(t){return xr(t.element())}return{get:n,set:function(t,e){var r=n(t);t.getSystem().triggerFocus(e,t.element());var o=n(t);da(t,r,o)}}}var Er,mi,Em=aa("height",function(n){var t=n.dom();return Ct(n)?t.getBoundingClientRect().height:t.offsetHeight}),Pe=bu(he),gi=function(n,t,e,r){return At(r.element(),t.highlightClass)},Cm=function(n,t,e,r){var o=wn(n.element(),"."+t.itemClass);return g.from(o[r]).fold(function(){return en.error("No element found with index "+r)},n.getSystem().getByDom)},ma=function(n,t,e){return ht(n.element(),"."+t.itemClass).bind(function(r){return n.getSystem().getByDom(r).toOption()})},ga=function(n,t,e){var r=wn(n.element(),"."+t.itemClass);return(0<r.length?g.some(r[r.length-1]):g.none()).bind(function(o){return n.getSystem().getByDom(o).toOption()})},pa=function(n,t,e){var r=wn(n.element(),"."+t.itemClass);return li(P(r,function(o){return n.getSystem().getByDom(o).toOption()}))},Dm=Object.freeze({__proto__:null,dehighlightAll:function(n,t,e){return sa(n,t,0,[])},dehighlight:function(n,t,e,r){gi(n,t,e,r)&&(sn(r.element(),t.highlightClass),t.onDehighlight(n,r),kt(r,gc()))},highlight:He,highlightFirst:function(n,t,e){ma(n,t).each(function(r){He(n,t,e,r)})},highlightLast:function(n,t,e){ga(n,t).each(function(r){He(n,t,e,r)})},highlightAt:function(n,t,e,r){Cm(n,t,e,r).fold(function(o){throw new Error(o)},function(o){He(n,t,e,o)})},highlightBy:function(n,t,e,r){var o=pa(n,t);Rn(o,r).each(function(i){He(n,t,e,i)})},isHighlighted:gi,getHighlighted:function(n,t,e){return ht(n.element(),"."+t.highlightClass).bind(function(r){return n.getSystem().getByDom(r).toOption()})},getFirst:ma,getLast:ga,getPrevious:function(n,t,e){return la(n,t,0,-1)},getNext:function(n,t,e){return la(n,t,0,1)},getCandidates:pa}),_m=[O("highlightClass"),O("itemClass"),dn("onHighlight"),dn("onDehighlight")],rn=En({fields:_m,name:"highlighting",apis:Dm});(mi=Er=Er||{}).OnFocusMode="onFocus",mi.OnEnterOrSpaceMode="onEnterOrSpace",mi.OnApiMode="onApi";function zt(n,t,e,r,o){function i(c,a,f,s,l){return function(d,v){return Rn(d,function(p){return p.matches(v)}).map(function(p){return p.classification})}(f(c,a,s,l),a.event()).bind(function(d){return d(c,a,s,l)})}var u={schema:function(){return n.concat([w("focusManager",di()),Re("focusInside","onFocus",kc(function(c){return hn(["onFocus","onEnterOrSpace","onApi"],c)?en.value(c):en.error("Invalid value for focusInside")})),K("handler",u),K("state",t),K("sendFocusIn",o)])},processKey:i,toEvents:function(c,a){var f=c.focusInside!==Er.OnFocusMode?g.none():o(c).map(function(s){return z(_t(),function(l,d){s(l,c,a),d.stop()})});return tn(f.toArray().concat([z(cd(),function(s,l){i(s,l,e,c,a).fold(function(){(function(d,v){var p=F([32].concat([13]))(v.event());c.focusInside===Er.OnEnterOrSpaceMode&&p&&Dc(d,v)&&o(c).each(function(y){y(d,c,a),v.stop()})})(s,l)},function(d){l.stop()})}),z(ad(),function(s,l){i(s,l,r,c,a).each(function(d){l.stop()})})]))}};return u}function ha(n){function t(a,f){var s=a.visibilitySelector.bind(function(l){return ct(f,l)}).getOr(f);return 0<Fn(s)}function e(a,f,s){(function(l,d){var v=wn(l.element(),d.selector),p=yn(v,function(y){return t(d,y)});return g.from(p[d.firstTabstop])})(a,f).each(function(l){f.focusManager.set(a,l)})}function r(a,f,s,l,d){return d(f,s,function(v){return function(p,y){return t(p,y)&&p.useTabstopAt(y)}(l,v)}).fold(function(){return l.cyclic?g.some(!0):g.none()},function(v){return l.focusManager.set(a,v),g.some(!0)})}function o(a,f,s,l){var d=wn(a.element(),s.selector);return function(v,p){return p.focusManager.get(v).bind(function(y){return ct(y,p.selector)})}(a,s).bind(function(v){return ee(d,Hn(on,v)).bind(function(p){return r(a,d,p,s,l)})})}var i=[$("onEscape"),$("onEnter"),w("selector",'[data-alloy-tabstop="true"]:not(:disabled)'),w("firstTabstop",0),w("useTabstopAt",m(!0)),$("visibilitySelector")].concat([n]),u=m([R($n([he,F([9])]),function(a,f,s){var l=s.cyclic?wm:Sm;return o(a,0,s,l)}),R(F([9]),function(a,f,s){var l=s.cyclic?Tm:Om;return o(a,0,s,l)}),R(F([27]),function(a,f,s){return s.onEscape.bind(function(l){return l(a,f)})}),R($n([Pe,F([13])]),function(a,f,s){return s.onEnter.bind(function(l){return l(a,f)})})]),c=m([]);return zt(i,Un.init,u,c,function(){return g.some(e)})}function ye(n){return Dn(n)==="input"&&X(n,"type")!=="radio"||Dn(n)==="textarea"}function ze(n,t,e){return ye(e)&&F([32])(t.event())?g.none():function(r,o,i){return Do(r,i,lr()),g.some(!0)}(n,0,e)}function be(n,t){return g.some(!0)}function va(n,t,e){return e.execute(n,t,n.element())}function ya(){var n=j(g.none());return de({readState:function(){return n.get().map(function(t){return{numRows:String(t.numRows()),numColumns:String(t.numColumns())}}).getOr({numRows:"?",numColumns:"?"})},setGridSize:function(t,e){n.set(g.some({numRows:m(t),numColumns:m(e)}))},getNumRows:function(){return n.get().map(function(t){return t.numRows()})},getNumColumns:function(){return n.get().map(function(t){return t.numColumns()})}})}function ba(n,t){return function(e){return Xm(e)==="rtl"?t:n}}function xa(n){return function(t,e,r,o){var i=n(t.element());return Qa(i,t,e,r,o)}}function pi(n,t){var e=ba(n,t);return xa(e)}function hi(n,t){var e=ba(t,n);return xa(e)}function vi(n){return function(t,e,r,o){return Qa(n,t,e,r,o)}}function Mm(n){return!function(t){return t.offsetWidth<=0&&t.offsetHeight<=0}(n.dom())}function wa(n,t,e){var r=wn(n,e);return function(o,i){return ee(o,i).map(function(u){return{index:m(u),candidates:m(o)}})}(yn(r,Mm),function(o){return on(o,t)})}function Sa(n,t){return ee(n,function(e){return on(t,e)})}function Ta(n,t,e,r){return r(Math.floor(t/e),t%e).bind(function(o){var i=o.row()*e+o.column();return 0<=i&&i<n.length?g.some(n[i]):g.none()})}function Oa(n,t,e,r,o){return Ta(n,t,r,function(i,u){var c=i===e-1?n.length-i*r:r,a=ve(u,o,0,c-1);return g.some({row:m(i),column:m(a)})})}function ka(n,t,e,r,o){return Ta(n,t,r,function(i,u){var c=ve(i,o,0,e-1),a=c===e-1?n.length-c*r:r,f=je(u,0,a-1);return g.some({row:m(c),column:m(f)})})}function Im(n,t,e){ht(n.element(),t.selector).each(function(r){t.focusManager.set(n,r)})}function Cr(n){return function(t,e,r,o){return wa(t,e,r.selector).bind(function(i){return n(i.candidates(),i.index(),o.getNumRows().getOr(r.initSize.numRows),o.getNumColumns().getOr(r.initSize.numColumns))})}}function Ea(n,t,e){return e.captureTab?g.some(!0):g.none()}function Dr(n,t,e,r){var o=function(i,u,c){var a=ve(u,r,0,c.length-1);return a===i?g.none():function(f){return Dn(f)==="button"&&X(f,"disabled")==="disabled"}(c[a])?o(i,a,c):g.from(c[a])};return wa(n,e,t).bind(function(i){var u=i.index(),c=i.candidates();return o(u,u,c)})}function yi(n,t,e){return function(r,o){return o.focusManager.get(r).bind(function(i){return ct(i,o.selector)})}(n,e).bind(function(r){return e.execute(n,t,r)})}function Am(n,t,e){t.getInitial(n).orThunk(function(){return ht(n.element(),t.selector)}).each(function(r){t.focusManager.set(n,r)})}function Ca(n,t,e){return Dr(n,e.selector,t,-1)}function Da(n,t,e){return Dr(n,e.selector,t,1)}function _a(n){return function(t,e,r,o){return n(t,e,r,o).bind(function(){return r.executeOnMove?yi(t,e,r):g.some(!0)})}}function Fm(n,t,e){return e.onEscape(n,t)}function _r(n,t,e){return g.from(n[t]).bind(function(r){return g.from(r[e]).map(function(o){return rg({rowIndex:t,columnIndex:e,cell:o})})})}function Ma(n,t,e,r){var o=n[t].length,i=ve(e,r,0,o-1);return _r(n,t,i)}function Ia(n,t,e,r){var o=ve(e,r,0,n.length-1),i=n[o].length,u=je(t,0,i-1);return _r(n,o,u)}function Aa(n,t,e,r){var o=n[t].length,i=je(e+r,0,o-1);return _r(n,t,i)}function Fa(n,t,e,r){var o=je(e+r,0,n.length-1),i=n[o].length,u=je(t,0,i-1);return _r(n,o,u)}function Rm(n,t,e){t.previousSelector(n).orThunk(function(){var r=t.selectors;return ht(n.element(),r.cell)}).each(function(r){t.focusManager.set(n,r)})}function Mr(n,t){return function(e,r,o){var i=o.cycles?n:t;return ct(r,o.selectors.row).bind(function(u){var c=wn(u,o.selectors.cell);return Sa(c,r).bind(function(a){var f=wn(e,o.selectors.row);return Sa(f,u).bind(function(s){var l=function(d,v){return P(d,function(p){return wn(p,v.selectors.cell)})}(f,o);return i(l,s,a).map(function(d){return d.cell()})})})})}}function Ra(n,t,e){return e.focusManager.get(n).bind(function(r){return e.execute(n,t,r)})}function Bm(n,t,e){ht(n.element(),t.selector).each(function(r){t.focusManager.set(n,r)})}function Ba(n,t,e){return Dr(n,e.selector,t,-1)}function Va(n,t,e){return Dr(n,e.selector,t,1)}function at(n,t){return function(e,r,o){return Re(e,r,ln(o))}(n,{},P(t,function(e){return function(r,o){return An(r,r,ni(),ue(function(i){return Be("The field: "+r+" is forbidden. "+o)}))}(e.name(),"Cannot configure "+e.name()+" for "+n)}).concat([kn("dump",un)]))}function Vm(n){return n.dump}function vt(n,t){return D(D({},n.dump),W(t))}function bi(n){return cr(n,"uiType")}function Nm(n,t,e,r){return bi(e)&&e.uiType===uf?function(o,i,u,c){return o.exists(function(a){return a!==u.owner})?Vr.single(!0,m(u)):N(c,u.name).fold(function(){throw new Error("Unknown placeholder component: "+u.name+`
Known: [`+bn(c)+`]
Namespace: `+o.getOr("none")+`
Spec: `+JSON.stringify(u,null,2))},function(a){return a.replace()})}(n,0,e,r):Vr.single(!1,m(e))}function jm(n,t,e,r){var o=gn(r,function(u,c){return function(a,f){var s=!1;return{name:m(a),required:function(){return f.fold(function(l,d){return l},function(l,d){return l})},used:function(){return s},replace:function(){if(s)throw new Error("Trying to use the same placeholder more than once: "+a);return s=!0,f}}}(c,u)}),i=function(u,c,a,f){return Pn(a,function(s){return cf(u,c,s,f)})}(n,t,e,o);return Tn(o,function(u){if(u.used()===!1&&u.required())throw new Error("Placeholder: "+u.name()+` was not found in components list
Namespace: `+n.getOr("none")+`
Components: `+JSON.stringify(t.components,null,2))}),i}function Lt(n){var t=new Date().getTime();return n+"_"+Math.floor(1e9*Math.random())+ ++kg+String(t)}function Hm(n){function t(e){return e.name}return n.fold(t,t,t,t)}function Ir(n,t){return function(e){var r=fn("Converting part type",t,e);return n(r)}}function xi(n,t,e,r){return an(t.defaults(n,e,r),e,{uid:n.partUids[t.name]},t.overrides(n,e,r))}function Pm(n,t){var e={};return B(t,function(r){(function(o){return o.fold(g.some,g.none,g.some,g.some)})(r).each(function(o){var i=Ig(n,o.pname);e[o.name]=function(u){var c=fn("Part: "+o.name+" in "+n,ln(o.schema),u);return D(D({},i),{config:u,validated:c})}})}),e}function Na(n,t,e){return function(r,o,i){var u={},c={};return B(i,function(a){a.fold(function(f){u[f.pname]=af(!0,function(s,l,d){return f.factory.sketch(xi(s,f,l,d))})},function(f){var s=o.parts[f.name];c[f.name]=m(f.factory.sketch(xi(o,f,s[lf()]),s))},function(f){u[f.pname]=af(!1,function(s,l,d){return f.factory.sketch(xi(s,f,l,d))})},function(f){u[f.pname]=Og(!0,function(s,l,d){var v=s[f.name];return P(v,function(p){return f.factory.sketch(an(f.defaults(s,p,d),p,f.overrides(s,p)))})})})}),{internals:m(u),externals:m(c)}}(0,t,e)}function ja(n,t,e){return jm(g.some(n),t,t.components,e)}function Wn(n,t,e){var r=t.partUids[e];return n.getSystem().getByUid(r).toOption()}function Ha(n,t,e){return Wn(n,t,e).getOrDie("Could not find part: "+e)}function zm(n,t){var e=function(r){return P(r,Hm)}(t);return Gn(P(e,function(r){return{key:r,value:n+"-"+r}}))}function Pa(n){return An("partUids","partUids",zd(function(t){return zm(t.uid,n)}),yr())}function za(n){return On(df,n)}function wi(n){return function(t,e){var r=e.toString(),o=r.indexOf(")")+1,i=r.indexOf("("),u=r.substring(i+1,o-1).split(/,\s*/);return t.toFunctionAnnotation=function(){return{name:"OVERRIDE",parameters:ri(u.slice(1))}},t}(function(t){for(var e=[],r=1;r<arguments.length;r++)e[r-1]=arguments[r];return n.apply(void 0,[t.getApis()].concat([t].concat(e)))},n)}function Ar(n){return Lt(n)}function La(n,t,e,r,o){var i=function(u,c){return(0<u.length?[mt("parts",u)]:[]).concat([O("uid"),w("dom",{}),w("components",[]),$c("originalSpec"),w("debug.sketcher",{})]).concat(c)}(r,o);return fn(n+" [SpecSchema]",Mn(i.concat(t)),e)}function Ga(n,t,e,r,o){var i=gf(o),u=function(s){return Pn(s,function(l){return l.fold(g.none,g.some,g.none,g.none).map(function(d){return mt(d.name,d.schema.concat([$c(lf())]))}).toArray()})}(e),c=Pa(e),a=La(n,t,i,u,[c]),f=Na(0,a,e);return r(a,ja(n,a,f.internals()),i,f.externals())}var Ua,Si,$a,Wa,Xa,qa,Ya,Ka,Ja,yt,Lm=ha(kn("cyclic",m(!1))),Gm=ha(kn("cyclic",m(!0))),Um=[w("execute",ze),w("useSpace",!1),w("useEnter",!0),w("useControlEnter",!1),w("useDown",!1)],$m=zt(Um,Un.init,function(n,t,e,r){var o=e.useSpace&&!ye(n.element())?[32]:[],i=e.useEnter?[13]:[],u=e.useDown?[40]:[],c=o.concat(i).concat(u);return[R(F(c),va)].concat(e.useControlEnter?[R($n([km,F([13])]),va)]:[])},function(n,t,e,r){return e.useSpace&&!ye(n.element())?[R(F([32]),be)]:[]},function(){return g.none()}),Wm=Object.freeze({__proto__:null,flatgrid:ya,init:function(n){return n.state(n)}}),Xm=function(n){return Ne(n,"direction")==="rtl"?"rtl":"ltr"},Qa=function(n,t,e,r,o){return r.focusManager.get(t).bind(function(i){return n(t.element(),i,r,o)}).map(function(i){return r.focusManager.set(t,i),!0})},Za=vi,nf=vi,Fr=vi,qm=[O("selector"),w("execute",ze),Bn("onEscape"),w("captureTab",!1),ea()],tf=Cr(function(n,t,e,r){return Oa(n,t,e,r,-1)}),ef=Cr(function(n,t,e,r){return Oa(n,t,e,r,1)}),Ym=Cr(function(n,t,e,r){return ka(n,t,e,r,-1)}),Km=Cr(function(n,t,e,r){return ka(n,t,e,r,1)}),Jm=m([R(F([37]),pi(tf,ef)),R(F([39]),hi(tf,ef)),R(F([38]),Za(Ym)),R(F([40]),nf(Km)),R($n([he,F([9])]),Ea),R($n([Pe,F([9])]),Ea),R(F([27]),function(n,t,e){return e.onEscape(n,t)}),R(F([32].concat([13])),function(n,t,e,r){return function(o,i){return i.focusManager.get(o).bind(function(u){return ct(u,i.selector)})}(n,e).bind(function(o){return e.execute(n,t,o)})})]),Qm=m([R(F([32]),be)]),Zm=zt(qm,ya,Jm,Qm,function(){return g.some(Im)}),ng=[O("selector"),w("getInitial",g.none),w("execute",ze),Bn("onEscape"),w("executeOnMove",!1),w("allowVertical",!0)],tg=m([R(F([32]),be)]),eg=zt(ng,Un.init,function(n,t,e,r){var o=[37].concat(e.allowVertical?[38]:[]),i=[39].concat(e.allowVertical?[40]:[]);return[R(F(o),_a(pi(Ca,Da))),R(F(i),_a(hi(Ca,Da))),R(F([13]),yi),R(F([32]),yi),R(F([27]),Fm)]},tg,function(){return g.some(Am)}),rg=Mu(["rowIndex","columnIndex","cell"],[]),og=[mt("selectors",[O("row"),O("cell")]),w("cycles",!0),w("previousSelector",g.none),w("execute",ze)],rf=Mr(function(n,t,e){return Ma(n,t,e,-1)},function(n,t,e){return Aa(n,t,e,-1)}),of=Mr(function(n,t,e){return Ma(n,t,e,1)},function(n,t,e){return Aa(n,t,e,1)}),ig=Mr(function(n,t,e){return Ia(n,e,t,-1)},function(n,t,e){return Fa(n,e,t,-1)}),ug=Mr(function(n,t,e){return Ia(n,e,t,1)},function(n,t,e){return Fa(n,e,t,1)}),cg=m([R(F([37]),pi(rf,of)),R(F([39]),hi(rf,of)),R(F([38]),Za(ig)),R(F([40]),nf(ug)),R(F([32].concat([13])),function(n,t,e){return xr(n.element()).bind(function(r){return e.execute(n,t,r)})})]),ag=m([R(F([32]),be)]),fg=zt(og,Un.init,cg,ag,function(){return g.some(Rm)}),sg=[O("selector"),w("execute",ze),w("moveOnTab",!1)],lg=m([R(F([38]),Fr(Ba)),R(F([40]),Fr(Va)),R($n([he,F([9])]),function(n,t,e,r){return e.moveOnTab?Fr(Ba)(n,t,e,r):g.none()}),R($n([Pe,F([9])]),function(n,t,e,r){return e.moveOnTab?Fr(Va)(n,t,e,r):g.none()}),R(F([13]),Ra),R(F([32]),Ra)]),dg=m([R(F([32]),be)]),mg=zt(sg,Un.init,lg,dg,function(){return g.some(Bm)}),gg=[Bn("onSpace"),Bn("onEnter"),Bn("onShiftEnter"),Bn("onLeft"),Bn("onRight"),Bn("onTab"),Bn("onShiftTab"),Bn("onUp"),Bn("onDown"),Bn("onEscape"),w("stopSpaceKeyup",!1),$("focusIn")],pg=zt(gg,Un.init,function(n,t,e){return[R(F([32]),e.onSpace),R($n([Pe,F([13])]),e.onEnter),R($n([he,F([13])]),e.onShiftEnter),R($n([he,F([9])]),e.onShiftTab),R($n([Pe,F([9])]),e.onTab),R(F([38]),e.onUp),R(F([40]),e.onDown),R(F([37]),e.onLeft),R(F([39]),e.onRight),R(F([32]),e.onSpace),R(F([27]),e.onEscape)]},function(n,t,e){return e.stopSpaceKeyup?[R(F([32]),be)]:[]},function(n){return n.focusIn}),hg=Lm.schema(),vg=Gm.schema(),yg=eg.schema(),bg=Zm.schema(),xg=fg.schema(),wg=$m.schema(),Sg=mg.schema(),Tg=pg.schema(),nn=(yt=fn("Creating behaviour: "+(Ja={branchKey:"mode",branches:Object.freeze({__proto__:null,acyclic:hg,cyclic:vg,flow:yg,flatgrid:bg,matrix:xg,execution:wg,menu:Sg,special:Tg}),name:"keying",active:{events:function(n,t){return n.handler.toEvents(n,t)}},apis:{focusIn:function(n,t,e){t.sendFocusIn(t).fold(function(){n.getSystem().triggerFocus(n.element(),n.element())},function(r){r(n,t,e)})},setGridSize:function(n,t,e,r,o){(function(i){return cn(i,"setGridSize")})(e)?e.setGridSize(r,o):M.console.error("Layout does not support setGridSize")}},state:Wm}).name,Yd,Ja),Ua=It(yt.branchKey,yt.branches),Si=yt.name,$a=yt.active,Wa=yt.apis,Xa=yt.extra,qa=yt.state,Ka=Xo(Si,[Wo("config",Ya=Ua)]),Pc(Ya,Ka,Si,$a,Wa,Xa,qa)),Rr=at,Br=vt,uf="placeholder",Vr=Qn([{single:["required","valueThunk"]},{multiple:["required","valueThunks"]}]),cf=function(n,t,e,r){return Nm(n,0,e,r).fold(function(o,i){var u=bi(e)?i(t,e.config,e.validated):i(t),c=N(u,"components").getOr([]),a=Pn(c,function(f){return cf(n,t,f,r)});return[D(D({},u),{components:a})]},function(o,i){if(bi(e)){var u=i(t,e.config,e.validated);return e.validated.preprocess.getOr(un)(u)}return i(t)})},af=Vr.single,Og=Vr.multiple,ff=m(uf),kg=0,Nr=Qn([{required:["data"]},{external:["data"]},{optional:["data"]},{group:["data"]}]),jr=w("factory",{sketch:un}),Ti=w("schema",[]),Hr=O("name"),Oi=An("pname","pname",Pd(function(n){return"<alloy."+Lt(n.name)+">"}),yr()),Eg=kn("schema",function(){return[$("preprocess")]}),Pr=w("defaults",m({})),zr=w("overrides",m({})),Cg=ln([jr,Ti,Hr,Oi,Pr,zr]),Dg=ln([jr,Ti,Hr,Pr,zr]),_g=ln([jr,Ti,Hr,Oi,Pr,zr]),Mg=ln([jr,Eg,Hr,O("unit"),Oi,Pr,zr]),Lr=Ir(Nr.required,Cg),ki=(Ir(Nr.external,Dg),Ir(Nr.optional,_g)),sf=Ir(Nr.group,Mg),lf=m("entirety"),Ig=function(n,t){return{uiType:ff(),owner:n,name:t}},df=Lt("alloy-premade"),Ag=m("alloy-id-"),Fg=m("data-alloy-id"),Rg=Ag(),mf=Fg(),Ei=function(n,t){Object.defineProperty(n.dom(),mf,{value:t,writable:!0})},Le=function(n){var t=Lo(n)?n.dom()[mf]:null;return g.from(t)},gf=function(n){return function(t){return cr(t,"uid")}(n)?n:D(D({},n),{uid:Ar("uid")})};function Ge(n){var t=fn("Sketcher for "+n.name,Hg,n),e=gn(t.apis,wi),r=gn(t.extraApis,function(o,i){return Ko(o,i)});return D(D({name:m(t.name),configFields:m(t.configFields),sketch:function(o){return function(i,u,c,a){var f=gf(a);return c(La(i,u,f,[],[]),f)}(t.name,t.configFields,t.factory,o)}},e),r)}function Gr(n){var t=fn("Sketcher for "+n.name,Pg,n),e=Pm(t.name,t.partFields),r=gn(t.apis,wi),o=gn(t.extraApis,function(i,u){return Ko(i,u)});return D(D({name:m(t.name),partFields:m(t.partFields),configFields:m(t.configFields),sketch:function(i){return Ga(t.name,t.configFields,t.partFields,t.factory,i)},parts:m(e)},r),o)}function Bg(n){var t=_.fromHtml(n),e=ut(t),r=function(u){var c=u.dom().attributes!==void 0?u.dom().attributes:[];return rr(c,function(a,f){var s;return f.name==="class"?a:D(D({},a),((s={})[f.name]=f.value,s))},{})}(t),o=function(u){return Array.prototype.slice.call(u.dom().classList,0)}(t),i=e.length===0?{}:{innerHtml:Gc(t)};return D({tag:Dn(t),classes:o,attributes:r},i)}function Gt(n){return{dom:J(n)}}function pf(n){return W([G.config({toggleClass:E.resolve("toolbar-button-selected"),toggleOnExecute:!1,aria:{mode:"pressed"}}),oa(n,function(t,e){(e?G.on:G.off)(t)})])}function hf(n,t){var e=t.ui.registry.getAll().icons;return g.from(e[n]).fold(function(){return J('<span class="${prefix}-toolbar-button ${prefix}-toolbar-group-item ${prefix}-icon-'+n+' ${prefix}-icon"></span>')},function(r){return J('<span class="${prefix}-toolbar-button ${prefix}-toolbar-group-item">'+r+"</span>")})}function bt(n){return ki({name:n+"-edge",overrides:function(t){return t.model.manager.edgeActions[n].fold(function(){return{}},function(e){return{events:tn([qo(Dt(),function(r,o,i){return e(r,i)},[t]),qo(oe(),function(r,o,i){return e(r,i)},[t]),qo(jo(),function(r,o,i){i.mouseIsDown.get()&&e(r,i)},[t])])}})}})}function Ci(n,t,e){t.store.manager.onLoad(n,t,e)}function vf(n,t,e){t.store.manager.onUnload(n,t,e)}function yf(){var n=j(null);return de({set:n.set,get:n.get,isNotSet:function(){return n.get()===null},clear:function(){n.set(null)},readState:function(){return{mode:"memory",value:n.get()}}})}function bf(){var n=j({}),t=j({});return de({readState:function(){return{mode:"dataset",dataByValue:n.get(),dataByText:t.get()}},lookup:function(e){return N(n.get(),e).orThunk(function(){return N(t.get(),e)})},update:function(e){var r=n.get(),o=t.get(),i={},u={};B(e,function(c){i[c.value]=c,N(c,"meta").each(function(a){N(a,"text").each(function(f){u[f]=c})})}),n.set(D(D({},r),i)),t.set(D(D({},o),u))},clear:function(){n.set({}),t.set({})}})}function xf(n,t,e,r){var o=t.store;e.update([r]),o.setValue(n,r),t.onSetValue(n,r)}function wf(n,t){Kf.set(n,t)}function xe(n){return Kf.get(n)}function Di(n){var t=n.event().raw();if(function(o){return o.type.indexOf("touch")!==-1}(t)){var e=t;return e.touches!==void 0&&e.touches.length===1?g.some(e.touches[0]).map(function(o){return Qf(o.clientX,o.clientY)}):g.none()}var r=t;return r.clientX!==void 0?g.some(r).map(function(o){return Qf(o.clientX,o.clientY)}):g.none()}function Ut(n){return n.model.minX}function $t(n){return n.model.minY}function Ur(n){return n.model.minX-1}function $r(n){return n.model.minY-1}function Wt(n){return n.model.maxX}function Xt(n){return n.model.maxY}function Wr(n){return n.model.maxX+1}function Xr(n){return n.model.maxY+1}function Sf(n,t,e){return t(n)-e(n)}function _i(n){return Sf(n,Wt,Ut)}function Mi(n){return Sf(n,Xt,$t)}function Tf(n){return _i(n)/2}function Of(n){return Mi(n)/2}function we(n){return n.stepSize}function kf(n){return n.snapToGrid}function Ef(n){return n.snapStart}function Cf(n){return n.rounded}function qr(n,t){return n[t+"-edge"]!==void 0}function Df(n){return qr(n,"left")}function _f(n){return qr(n,"right")}function Mf(n){return qr(n,"top")}function If(n){return qr(n,"bottom")}function ft(n){return n.model.value.get()}function Af(n){return{x:m(n)}}function Ff(n){return{y:m(n)}}function xt(n,t){return{x:m(n),y:m(t)}}function Vn(n,t){it(n,Ue(),{value:t})}function Ii(n,t,e,r){return n<t?n:e<n?e:n===t?t-1:Math.max(t,n-r)}function Ai(n,t,e,r){return e<n?n:n<t?t:n===e?e+1:Math.min(e,n+r)}function Rf(n,t,e){return Math.max(t,Math.min(e,n))}function Bf(n){var t=n.min,e=n.max,r=n.range,o=n.value,i=n.step,u=n.snap,c=n.snapStart,a=n.rounded,f=n.hasMinEdge,s=n.hasMaxEdge,l=n.minBound,d=n.maxBound,v=n.screenRange,p=f?t-1:t,y=s?e+1:e;if(o<l)return p;if(d<o)return y;var h=function(b,k,S){return Math.min(S,Math.max(b,k))-k}(o,l,d),x=Rf(h/v*r+t,p,y);return u&&t<=x&&x<=e?function(b,k,S,T,C){return C.fold(function(){var I=b-k,V=Math.round(I/T)*T;return Rf(k+V,k-1,S+1)},function(I){var V=(b-I)%T,L=Math.round(V/T),Q=Math.floor((b-I)/T),Z=Math.floor((S-I)/T),jn=I+Math.min(Z,Q+L)*T;return Math.max(I,jn)})}(x,t,e,i,c):a?Math.round(x):x}function Vf(n){var t=n.min,e=n.max,r=n.range,o=n.value,i=n.hasMinEdge,u=n.hasMaxEdge,c=n.maxBound,a=n.maxOffset,f=n.centerMinEdge,s=n.centerMaxEdge;return o<t?i?0:f:e<o?u?c:s:(o-t)/r*a}function nt(n){return n.element().dom().getBoundingClientRect()}function Nn(n,t){return n[t]}function Yr(n){var t=nt(n);return Nn(t,Ni)}function Nf(n){var t=nt(n);return Nn(t,"right")}function Kr(n){var t=nt(n);return Nn(t,"top")}function jf(n){var t=nt(n);return Nn(t,"bottom")}function Hf(n){var t=nt(n);return Nn(t,"width")}function Pf(n){var t=nt(n);return Nn(t,"height")}function zf(n,t,e){return(n+t)/2-e}function Lf(n,t){var e=nt(n),r=nt(t),o=Nn(e,Ni),i=Nn(e,"right"),u=Nn(r,Ni);return zf(o,i,u)}function Gf(n,t){var e=nt(n),r=nt(t),o=Nn(e,"top"),i=Nn(e,"bottom"),u=Nn(r,"top");return zf(o,i,u)}function Jr(n,t){it(n,Ue(),{value:t})}function Qr(n){return{x:m(n)}}function Fi(n,t,e){var r={min:Ut(t),max:Wt(t),range:_i(t),value:e,step:we(t),snap:kf(t),snapStart:Ef(t),rounded:Cf(t),hasMinEdge:Df(t),hasMaxEdge:_f(t),minBound:Yr(n),maxBound:Nf(n),screenRange:Hf(n)};return Bf(r)}function Uf(n){return function(t,e){return function(r,o,i){var u=(0<r?Ai:Ii)(ft(i).x(),Ut(i),Wt(i),we(i));return Jr(o,Qr(u)),g.some(u)}(n,t,e).map(function(){return!0})}}function Ri(n,t,e,r,o,i){var u=function(c,a,f,s,l){var d=Hf(c),v=s.bind(function(h){return g.some(Lf(h,c))}).getOr(0),p=l.bind(function(h){return g.some(Lf(h,c))}).getOr(d),y={min:Ut(a),max:Wt(a),range:_i(a),value:f,hasMinEdge:Df(a),hasMaxEdge:_f(a),minBound:Yr(c),minOffset:0,maxBound:Nf(c),maxOffset:d,centerMinEdge:v,centerMaxEdge:p};return Vf(y)}(t,i,e,r,o);return Yr(t)-Yr(n)+u}function Zr(n,t){it(n,Ue(),{value:t})}function no(n){return{y:m(n)}}function Bi(n,t,e){var r={min:$t(t),max:Xt(t),range:Mi(t),value:e,step:we(t),snap:kf(t),snapStart:Ef(t),rounded:Cf(t),hasMinEdge:Mf(t),hasMaxEdge:If(t),minBound:Kr(n),maxBound:jf(n),screenRange:Pf(n)};return Bf(r)}function $f(n){return function(t,e){return function(r,o,i){var u=(0<r?Ai:Ii)(ft(i).y(),$t(i),Xt(i),we(i));return Zr(o,no(u)),g.some(u)}(n,t,e).map(function(){return!0})}}function Vi(n,t,e,r,o,i){var u=function(c,a,f,s,l){var d=Pf(c),v=s.bind(function(h){return g.some(Gf(h,c))}).getOr(0),p=l.bind(function(h){return g.some(Gf(h,c))}).getOr(d),y={min:$t(a),max:Xt(a),range:Mi(a),value:f,hasMinEdge:Mf(a),hasMaxEdge:If(a),minBound:Kr(c),minOffset:0,maxBound:jf(c),maxOffset:d,centerMinEdge:v,centerMaxEdge:p};return Vf(y)}(t,i,e,r,o);return Kr(t)-Kr(n)+u}function to(n,t){it(n,Ue(),{value:t})}function eo(n,t){return{x:m(n),y:m(t)}}function ro(n,t){return function(e,r){return function(o,i,u,c){var a=0<o?Ai:Ii,f=i?ft(c).x():a(ft(c).x(),Ut(c),Wt(c),we(c)),s=i?a(ft(c).y(),$t(c),Xt(c),we(c)):ft(c).y();return to(u,eo(f,s)),g.some(f)}(n,t,e,r).map(function(){return!0})}}function Wf(n,t,e,r){return st.forToolbar(t,function(){var o=e();n.setContextToolbar([{label:t+" group",items:o}])},{},r)}function Vg(n){return[function(t){function e(r){return r<0?"black":360<r?"white":"hsl("+r+", 100%, 50%)"}return tt.sketch({dom:J('<div class="${prefix}-slider ${prefix}-hue-slider-container"></div>'),components:[tt.parts()["left-edge"](Gt('<div class="${prefix}-hue-slider-black"></div>')),tt.parts().spectrum({dom:J('<div class="${prefix}-slider-gradient-container"></div>'),components:[Gt('<div class="${prefix}-slider-gradient"></div>')],behaviours:W([G.config({toggleClass:E.resolve("thumb-active")})])}),tt.parts()["right-edge"](Gt('<div class="${prefix}-hue-slider-white"></div>')),tt.parts().thumb({dom:J('<div class="${prefix}-slider-thumb"></div>'),behaviours:W([G.config({toggleClass:E.resolve("thumb-active")})])})],onChange:function(r,o,i){var u=e(i.x());U(o.element(),"background-color",u),t.onChange(r,o,u)},onDragStart:function(r,o){G.on(o)},onDragEnd:function(r,o){G.off(o)},onInit:function(r,o,i,u){var c=e(u.x());U(o.element(),"background-color",c)},stepSize:10,model:{mode:"x",minX:0,maxX:360,getInitialValue:function(){return{x:function(){return t.getInitialValue()}}}},sliderBehaviours:W([kr(tt.refresh)])})}(n)]}function Ng(n,t){return(Lo(t)?g.some(t):dt(t).filter(Lo)).map(function(e){return function(r,o,i){return zc(function(u,c){return c(u)},Lc,r,o,i)}(e,function(r){return Ht(r,"font-size").isSome()},n).bind(function(r){return Ht(r,"font-size")}).getOrThunk(function(){return Ne(e,"font-size")})}).getOr("")}function Xf(n){var t=n.selection.getStart(),e=_.fromDom(t),r=_.fromDom(n.getBody()),o=Ng(function(i){return on(r,i)},e);return Rn(io,function(i){return o===i}).getOr("medium")}function jg(n){return[Gt('<span class="${prefix}-toolbar-button ${prefix}-icon-small-font ${prefix}-icon"></span>'),function(t){return Ep({onChange:t.onChange,sizes:Cp,category:"font",getInitialValue:t.getInitialValue})}(n),Gt('<span class="${prefix}-toolbar-button ${prefix}-icon-large-font ${prefix}-icon"></span>')]}function qt(n){var t=function(r){return r.uid!==void 0}(n)&&cn(n,"uid")?n.uid:Ar("memento");return{get:function(e){return e.getSystem().getByUid(t).getOrDie()},getOpt:function(e){return e.getSystem().getByUid(t).toOption()},asSpec:function(){return D(D({},n),{uid:t})}}}var qf,Yf,Hg=Mn([O("name"),O("factory"),O("configFields"),w("apis",{}),w("extraApis",{})]),Pg=Mn([O("name"),O("factory"),O("configFields"),O("partFields"),w("apis",{}),w("extraApis",{})]),Yt=Ge({name:"Button",factory:function(n){function t(o){return N(n.dom,"attributes").bind(function(i){return N(i,o)})}var e=function(o){return tn(Ce([o.map(function(i){return Ve(function(u,c){i(u),c.stop()})}).toArray(),Qc()]))}(n.action),r=n.dom.tag;return{uid:n.uid,dom:n.dom,components:n.components,events:e,behaviours:Br(n.buttonBehaviours,[vn.config({}),nn.config({mode:"execution",useSpace:!0,useEnter:!0})]),domModification:{attributes:function(){if(r!=="button")return{role:t("role").getOr("button")};var o=t("type").getOr("button"),i=t("role").map(function(u){return{role:u}}).getOr({});return D({type:o},i)}()},eventOrder:n.eventOrder}},configFields:[w("uid",void 0),O("dom"),w("components",[]),Rr("buttonBehaviours",[vn,nn]),$("action"),$("role"),w("eventOrder",{})]}),zg=En({fields:[],name:"unselecting",active:Object.freeze({__proto__:null,events:function(){return tn([_c(sd(),m(!0))])},exhibit:function(){return Zn({styles:{"-webkit-user-select":"none","user-select":"none","-ms-user-select":"none","-moz-user-select":"-moz-none"},attributes:{unselectable:"on"}})}})}),J=function(n){var t=function(e,r){return e.replace(/\$\{([^{}]*)\}/g,function(o,i){var u=r[i];return function(c){var a=typeof c;return a=="string"||a=="number"}(u)?u.toString():o})}(n,{prefix:E.prefix()});return Bg(t)},oo=function(n,t,e,r){return Yt.sketch({dom:hf(n,r),action:t,buttonBehaviours:an(W([zg.config({})]),e)})},st={forToolbar:oo,forToolbarCommand:function(n,t){return oo(t,function(){n.execCommand(t)},{},n)},forToolbarStateAction:function(n,t,e,r){var o=pf(e);return oo(t,r,o,n)},forToolbarStateCommand:function(n,t){var e=pf(t);return oo(t,function(){n.execCommand(t)},e,n)},getToolbarIconButton:hf},Lg=ki({schema:[O("dom")],name:"label"}),Gg=bt("top-left"),Ug=bt("top"),$g=bt("top-right"),Wg=bt("right"),Xg=bt("bottom-right"),qg=bt("bottom"),Yg=bt("bottom-left"),Kg=[Lg,bt("left"),Wg,Ug,qg,Gg,$g,Yg,Xg,Lr({name:"thumb",defaults:m({dom:{styles:{position:"absolute"}}}),overrides:function(n){return{events:tn([fe(Dt(),n,"spectrum"),fe(fr(),n,"spectrum"),fe(sr(),n,"spectrum"),fe(oe(),n,"spectrum"),fe(jo(),n,"spectrum"),fe(uc(),n,"spectrum")])}}}),Lr({schema:[kn("mouseIsDown",function(){return j(!1)})],name:"spectrum",overrides:function(n){function t(r,o){return e.getValueFromEvent(o).map(function(i){return e.setValueFrom(r,n,i)})}var e=n.model.manager;return{behaviours:W([nn.config({mode:"special",onLeft:function(r){return e.onLeft(r,n)},onRight:function(r){return e.onRight(r,n)},onUp:function(r){return e.onUp(r,n)},onDown:function(r){return e.onDown(r,n)}}),vn.config({})]),events:tn([z(Dt(),t),z(fr(),t),z(oe(),t),z(jo(),function(r,o){n.mouseIsDown.get()&&t(r,o)})])}}})],Jg=Object.freeze({__proto__:null,onLoad:Ci,onUnload:vf,setValue:function(n,t,e,r){t.store.manager.setValue(n,t,e,r)},getValue:function(n,t,e){return t.store.manager.getValue(n,t,e)},getState:function(n,t,e){return e}}),Qg=Object.freeze({__proto__:null,events:function(n,t){var e=n.resetOnDom?[Bt(function(r,o){Ci(r,n,t)}),jc(function(r,o){vf(r,n,t)})]:[Jo(n,t,Ci)];return tn(e)}}),Zg=Object.freeze({__proto__:null,memory:yf,dataset:bf,manual:function(){return de({readState:function(){}})},init:function(n){return n.store.manager.state(n)}}),np=[$("initialValue"),O("getFallbackEntry"),O("getDataKey"),O("setValue"),K("manager",{setValue:xf,getValue:function(n,t,e){var r=t.store,o=r.getDataKey(n);return e.lookup(o).fold(function(){return r.getFallbackEntry(o)},function(i){return i})},onLoad:function(n,t,e){t.store.initialValue.each(function(r){xf(n,t,e,r)})},onUnload:function(n,t,e){e.clear()},state:bf})],tp=[O("getValue"),w("setValue",A),$("initialValue"),K("manager",{setValue:function(n,t,e,r){t.store.setValue(n,r),t.onSetValue(n,r)},getValue:function(n,t,e){return t.store.getValue(n)},onLoad:function(n,t,e){t.store.initialValue.each(function(r){t.store.setValue(n,r)})},onUnload:A,state:Un.init})],ep=[$("initialValue"),K("manager",{setValue:function(n,t,e,r){e.set(r),t.onSetValue(n,r)},getValue:function(n,t,e){return e.get()},onLoad:function(n,t,e){t.store.initialValue.each(function(r){e.isNotSet()&&e.set(r)})},onUnload:function(n,t,e){e.clear()},state:yf})],rp=[Re("store",{mode:"memory"},It("mode",{memory:ep,manual:tp,dataset:np})),dn("onSetValue"),w("resetOnDom",!1)],q=En({fields:rp,name:"representing",active:Qg,apis:Jg,extra:{setValueFrom:function(n,t){var e=q.getValue(t);q.setValue(n,e)}},state:Zg}),Kf=aa("width",function(n){return n.dom().offsetWidth}),Jf=function(n,t){return{left:m(n),top:m(t),translate:function(e,r){return Jf(n+e,t+r)}}},Qf=Jf,Ue=m("slider.change.value"),Ni="left",op=Uf(-1),ip=Uf(1),up=g.none,cp=g.none,ap={"top-left":g.none(),top:g.none(),"top-right":g.none(),right:g.some(function(n,t){Vn(n,Af(Wr(t)))}),"bottom-right":g.none(),bottom:g.none(),"bottom-left":g.none(),left:g.some(function(n,t){Vn(n,Af(Ur(t)))})},fp=Object.freeze({__proto__:null,setValueFrom:function(n,t,e){var r=Fi(n,t,e),o=Qr(r);return Jr(n,o),r},setToMin:function(n,t){var e=Ut(t);Jr(n,Qr(e))},setToMax:function(n,t){var e=Wt(t);Jr(n,Qr(e))},findValueOfOffset:Fi,getValueFromEvent:function(n){return Di(n).map(function(t){return t.left()})},findPositionOfValue:Ri,setPositionFromValue:function(n,t,e,r){var o=ft(e),i=Ri(n,r.getSpectrum(n),o.x(),r.getLeftEdge(n),r.getRightEdge(n),e),u=xe(t.element())/2;U(t.element(),"left",i-u+"px")},onLeft:op,onRight:ip,onUp:up,onDown:cp,edgeActions:ap}),sp=g.none,lp=g.none,dp=$f(-1),mp=$f(1),gp={"top-left":g.none(),top:g.some(function(n,t){Vn(n,Ff($r(t)))}),"top-right":g.none(),right:g.none(),"bottom-right":g.none(),bottom:g.some(function(n,t){Vn(n,Ff(Xr(t)))}),"bottom-left":g.none(),left:g.none()},pp=Object.freeze({__proto__:null,setValueFrom:function(n,t,e){var r=Bi(n,t,e),o=no(r);return Zr(n,o),r},setToMin:function(n,t){var e=$t(t);Zr(n,no(e))},setToMax:function(n,t){var e=Xt(t);Zr(n,no(e))},findValueOfOffset:Bi,getValueFromEvent:function(n){return Di(n).map(function(t){return t.top()})},findPositionOfValue:Vi,setPositionFromValue:function(n,t,e,r){var o=ft(e),i=Vi(n,r.getSpectrum(n),o.y(),r.getTopEdge(n),r.getBottomEdge(n),e),u=Fn(t.element())/2;U(t.element(),"top",i-u+"px")},onLeft:sp,onRight:lp,onUp:dp,onDown:mp,edgeActions:gp}),hp=ro(-1,!1),vp=ro(1,!1),yp=ro(-1,!0),bp=ro(1,!0),xp={"top-left":g.some(function(n,t){Vn(n,xt(Ur(t),$r(t)))}),top:g.some(function(n,t){Vn(n,xt(Tf(t),$r(t)))}),"top-right":g.some(function(n,t){Vn(n,xt(Wr(t),$r(t)))}),right:g.some(function(n,t){Vn(n,xt(Wr(t),Of(t)))}),"bottom-right":g.some(function(n,t){Vn(n,xt(Wr(t),Xr(t)))}),bottom:g.some(function(n,t){Vn(n,xt(Tf(t),Xr(t)))}),"bottom-left":g.some(function(n,t){Vn(n,xt(Ur(t),Xr(t)))}),left:g.some(function(n,t){Vn(n,xt(Ur(t),Of(t)))})},wp=Object.freeze({__proto__:null,setValueFrom:function(n,t,e){var r=Fi(n,t,e.left()),o=Bi(n,t,e.top()),i=eo(r,o);return to(n,i),i},setToMin:function(n,t){var e=Ut(t),r=$t(t);to(n,eo(e,r))},setToMax:function(n,t){var e=Wt(t),r=Xt(t);to(n,eo(e,r))},getValueFromEvent:function(n){return Di(n)},setPositionFromValue:function(n,t,e,r){var o=ft(e),i=Ri(n,r.getSpectrum(n),o.x(),r.getLeftEdge(n),r.getRightEdge(n),e),u=Vi(n,r.getSpectrum(n),o.y(),r.getTopEdge(n),r.getBottomEdge(n),e),c=xe(t.element())/2,a=Fn(t.element())/2;U(t.element(),"left",i-c+"px"),U(t.element(),"top",u-a+"px")},onLeft:hp,onRight:vp,onUp:yp,onDown:bp,edgeActions:xp}),Sp=[w("stepSize",1),w("onChange",A),w("onChoose",A),w("onInit",A),w("onDragStart",A),w("onDragEnd",A),w("snapToGrid",!1),w("rounded",!0),$("snapStart"),ce("model",It("mode",{x:[w("minX",0),w("maxX",100),kn("value",function(n){return j(n.mode.minX)}),O("getInitialValue"),K("manager",fp)],y:[w("minY",0),w("maxY",100),kn("value",function(n){return j(n.mode.minY)}),O("getInitialValue"),K("manager",pp)],xy:[w("minX",0),w("maxX",100),w("minY",0),w("maxY",100),kn("value",function(n){return j({x:m(n.mode.minX),y:m(n.mode.minY)})}),O("getInitialValue"),K("manager",wp)]})),at("sliderBehaviours",[nn,q]),kn("mouseIsDown",function(){return j(!1)})],Tp=m("mouse.released"),tt=Gr({name:"Slider",configFields:Sp,partFields:Kg,factory:function(n,t,e,r){function o(b){return Ha(b,n,"thumb")}function i(b){return Ha(b,n,"spectrum")}function u(b){return Wn(b,n,"left-edge")}function c(b){return Wn(b,n,"right-edge")}function a(b){return Wn(b,n,"top-edge")}function f(b){return Wn(b,n,"bottom-edge")}function s(b,k){x.setPositionFromValue(b,k,n,{getLeftEdge:u,getRightEdge:c,getTopEdge:a,getBottomEdge:f,getSpectrum:i})}function l(b,k){h.value.set(k);var S=o(b);return s(b,S),n.onChange(b,S,k),g.some(!0)}function d(b){var k=n.mouseIsDown.get();n.mouseIsDown.set(!1),k&&Wn(b,n,"thumb").each(function(S){var T=h.value.get();n.onChoose(b,S,T)})}function v(b,k){k.stop(),n.mouseIsDown.set(!0),n.onDragStart(b,o(b))}function p(b,k){k.stop(),n.onDragEnd(b,o(b)),d(b)}var y,h=n.model,x=h.manager;return{uid:n.uid,dom:n.dom,components:t,behaviours:vt(n.sliderBehaviours,[nn.config({mode:"special",focusIn:function(b){return Wn(b,n,"spectrum").map(nn.focusIn).map(m(!0))}}),q.config({store:{mode:"manual",getValue:function(b){return h.value.get()}}}),Or.config({channels:(y={},y[Tp()]={onReceive:d},y)})]),events:tn([z(Ue(),function(b,k){l(b,k.event().value())}),Bt(function(b,k){var S=h.getInitialValue();h.value.set(S);var T=o(b);s(b,T);var C=i(b);n.onInit(b,T,C,h.value.get())}),z(Dt(),v),z(sr(),p),z(oe(),v),z(uc(),p)]),apis:{resetToMin:function(b){x.setToMin(b,n)},resetToMax:function(b){x.setToMax(b,n)},changeValue:l,refresh:s},domModification:{styles:{position:"relative"}}}},apis:{resetToMin:function(n,t){n.resetToMin(t)},resetToMax:function(n,t){n.resetToMax(t)},refresh:function(n,t){n.refresh(t)}}}),Op=function(n,t){var e={onChange:function(r,o,i){t.undoManager.transact(function(){t.formatter.apply("forecolor",{value:i}),t.nodeChanged()})},getInitialValue:function(){return-1}};return Wf(n,"color-levels",function(){return Vg(e)},t)},kp=Mn([O("getInitialValue"),O("onChange"),O("category"),O("sizes")]),Ep=function(n){var t=fn("SizeSlider",kp,n);return tt.sketch({dom:{tag:"div",classes:[E.resolve("slider-"+t.category+"-size-container"),E.resolve("slider"),E.resolve("slider-size-container")]},onChange:function(e,r,o){var i=o.x();!function(u){return 0<=u&&u<t.sizes.length}(i)||t.onChange(i)},onDragStart:function(e,r){G.on(r)},onDragEnd:function(e,r){G.off(r)},model:{mode:"x",minX:0,maxX:t.sizes.length-1,getInitialValue:function(){return{x:function(){return t.getInitialValue()}}}},stepSize:1,snapToGrid:!0,sliderBehaviours:W([kr(tt.refresh)]),components:[tt.parts().spectrum({dom:J('<div class="${prefix}-slider-size-container"></div>'),components:[Gt('<div class="${prefix}-slider-size-line"></div>')]}),tt.parts().thumb({dom:J('<div class="${prefix}-slider-thumb"></div>'),behaviours:W([G.config({toggleClass:E.resolve("thumb-active")})])})]})},io=["9px","10px","11px","12px","14px","16px","18px","20px","24px","32px","36px"],ji={candidates:m(io),get:function(n){return function(t){return ee(io,function(e){return e===t})}(Xf(n)).getOr(2)},apply:function(n,t){(function(e){return g.from(io[e])})(t).each(function(e){(function(r,o){Xf(r)!==o&&r.execCommand("fontSize",!1,o)})(n,e)})}},Cp=ji.candidates(),Dp=window.Promise?window.Promise:(qf=Cn.immediateFn||typeof window.setImmediate=="function"&&window.setImmediate||function(n){M.setTimeout(n,1)},Yf=Array.isArray||function(n){return Object.prototype.toString.call(n)==="[object Array]"},Cn.prototype.catch=function(n){return this.then(null,n)},Cn.prototype.then=function(n,t){var e=this;return new Cn(function(r,o){Zf.call(e,new _p(n,t,r,o))})},Cn.all=function(){for(var n=[],t=0;t<arguments.length;t++)n[t]=arguments[t];var e=Array.prototype.slice.call(n.length===1&&Yf(n[0])?n[0]:n);return new Cn(function(r,o){if(e.length===0)return r([]);var i=e.length;function u(a,f){try{if(f&&(typeof f=="object"||typeof f=="function")){var s=f.then;if(typeof s=="function")return void s.call(f,function(l){u(a,l)},o)}e[a]=f,--i==0&&r(e)}catch(l){o(l)}}for(var c=0;c<e.length;c++)u(c,e[c])})},Cn.resolve=function(n){return n&&typeof n=="object"&&n.constructor===Cn?n:new Cn(function(t){t(n)})},Cn.reject=function(n){return new Cn(function(t,e){e(n)})},Cn.race=function(n){return new Cn(function(t,e){for(var r=0,o=n;r<o.length;r++)o[r].then(t,e)})},Cn);function Cn(n){if(typeof this!="object")throw new TypeError("Promises must be constructed via new");if(typeof n!="function")throw new TypeError("not a function");this._state=null,this._value=null,this._deferreds=[],es(n,$e(ns,this),$e(Hi,this))}function $e(n,t){return function(){return n.apply(t,arguments)}}function Zf(n){var t=this;this._state!==null?qf(function(){var e=t._state?n.onFulfilled:n.onRejected;if(e!==null){var r;try{r=e(t._value)}catch(o){return void n.reject(o)}n.resolve(r)}else(t._state?n.resolve:n.reject)(t._value)}):this._deferreds.push(n)}function ns(n){try{if(n===this)throw new TypeError("A promise cannot be resolved with itself.");if(n&&(typeof n=="object"||typeof n=="function")){var t=n.then;if(typeof t=="function")return void es($e(t,n),$e(ns,this),$e(Hi,this))}this._state=!0,this._value=n,ts.call(this)}catch(e){Hi.call(this,e)}}function Hi(n){this._state=!1,this._value=n,ts.call(this)}function ts(){for(var n=0,t=this._deferreds;n<t.length;n++){var e=t[n];Zf.call(this,e)}this._deferreds=[]}function _p(n,t,e,r){this.onFulfilled=typeof n=="function"?n:null,this.onRejected=typeof t=="function"?t:null,this.resolve=e,this.reject=r}function es(n,t,e){var r=!1;try{n(function(o){r||(r=!0,t(o))},function(o){r||(r=!0,e(o))})}catch(o){if(r)return;r=!0,e(o)}}function Mp(n){return function(e){return new Dp(function(r){var o=new M.FileReader;o.onloadend=function(){r(o.result)},o.readAsDataURL(e)})}(n).then(function(t){return t.split(",")[1]})}function Ip(n,t){(function(e){return Mp(e)})(t).then(function(e){n.undoManager.transact(function(){var r=n.editorUpload.blobCache,o=r.create(Lt("mceu"),t,e);r.add(o);var i=n.dom.createHTML("img",{src:o.blobUri()});n.insertContent(i)})})}function Ap(n){var t=qt({dom:{tag:"input",attributes:{accept:"image/*",type:"file",title:""},styles:{visibility:"hidden",position:"absolute"}},events:tn([Yo(fc()),z(fd(),function(e,r){(function(o){var i=o.event(),u=i.raw().target.files||i.raw().dataTransfer.files;return g.from(u[0])})(r).each(function(o){Ip(n,o)})})])});return Yt.sketch({dom:st.getToolbarIconButton("image",n),components:[t.asSpec()],action:function(e){t.get(e).element().dom().click()}})}function rs(n){return n.dom().textContent}function We(n){return 0<n.length}function uo(n){return n==null?"":n}function Fp(n,t,e){return e.text.toOption().filter(We).fold(function(){return function(r){return X(r,"href")===rs(r)}(n)?g.some(t):g.none()},g.some)}function Rp(n,t){var e=t.selection.getRng();n(),t.selection.setRng(e)}function Pi(n){return n.dom().value}function os(n,t){if(t===void 0)throw new Error("Value.set was undefined");n.dom().value=t}function Bp(n){return D(D({},function(t){return W([vn.config({onFocus:t.selectOnFocus?function(e){var r=e.element(),o=Pi(r);r.dom().setSelectionRange(0,o.length)}:A})])}(n)),vt(n.inputBehaviours,[q.config({store:D(D({mode:"manual"},n.data.map(function(t){return{initialValue:t}}).getOr({})),{getValue:function(t){return Pi(t.element())},setValue:function(t,e){Pi(t.element())!==e&&os(t.element(),e)}}),onSetValue:n.onSetValue})]))}function co(n,t){var e=qt(sh.sketch({inputAttributes:{placeholder:gh.translate(t)},onSetValue:function(o,i){kt(o,ac())},inputBehaviours:W([Xn.config({find:g.some}),mh.config({}),nn.config({mode:"execution"})]),selectOnFocus:!1})),r=qt(Yt.sketch({dom:J('<button class="${prefix}-input-container-x ${prefix}-icon-cancel-circle ${prefix}-icon"></button>'),action:function(o){var i=e.get(o);q.setValue(i,"")}}));return{name:n,spec:qn.sketch({dom:J('<div class="${prefix}-input-container"></div>'),components:[e.asSpec(),r.asSpec()],containerBehaviours:W([G.config({toggleClass:E.resolve("input-container-empty")}),Xn.config({find:function(o){return g.some(e.get(o))}}),Te("input-clearing",[z(ac(),function(o){var i=e.get(o);(0<q.getValue(i).length?G.off:G.on)(o)})])])})}}function is(n,t,e){t.disabled&&Ji(n,t)}function zi(n,t){return t.useNative===!0&&hn(ph,Dn(n.element()))}function Vp(n){H(n.element(),"disabled","disabled")}function Np(n){xn(n.element(),"disabled")}function jp(n){H(n.element(),"aria-disabled","true")}function Hp(n){H(n.element(),"aria-disabled","false")}function us(n,t,e){t.disableClass.each(function(r){sn(n.element(),r)}),(zi(n,t)?Np:Hp)(n),t.onEnabled(n)}function cs(n,t){return zi(n,t)?function(e){return se(e.element(),"disabled")}(n):function(e){return X(e.element(),"aria-disabled")==="true"}(n)}function as(n){return"<alloy.field."+n+">"}function Se(){function n(){t.get().each(function(e){e.destroy()})}var t=j(g.none());return{clear:function(){n(),t.set(g.none())},isSet:function(){return t.get().isSome()},set:function(e){n(),t.set(g.some(e))},run:function(e){t.get().each(e)}}}function Li(){var n=j(g.none());return{clear:function(){n.set(g.none())},set:function(t){n.set(g.some(t))},isSet:function(){return n.get().isSome()},on:function(t){n.get().each(t)}}}function Pp(n){function t(f,s,l){return Yt.sketch({dom:J('<span class="${prefix}-icon-'+s+' ${prefix}-icon"></span>'),action:function(d){it(d,o,{direction:f})},buttonBehaviours:W([bh.config({disableClass:E.resolve("toolbar-navigation-disabled"),disabled:!l})])})}function e(f,s){var l=wn(f.element(),"."+E.resolve("serialised-dialog-screen"));ht(f.element(),"."+E.resolve("serialised-dialog-chain")).each(function(d){0<=u.state.currentScreen.get()+s&&u.state.currentScreen.get()+s<l.length&&(Ht(d,"left").each(function(v){var p=parseInt(v,10),y=xe(l[0]);U(d,"left",p-s*y+"px")}),u.state.currentScreen.set(u.state.currentScreen.get()+s))})}function r(f){var s=wn(f.element(),"input");g.from(s[u.state.currentScreen.get()]).each(function(d){f.getSystem().getByDom(d).each(function(v){(function(p,y){p.getSystem().triggerFocus(y,p.element())})(f,v.element())})});var l=a.get(f);rn.highlightAt(l,u.state.currentScreen.get())}var o="navigateEvent",i=ln([O("fields"),w("maxFieldIndex",n.fields.length-1),O("onExecute"),O("getInitialValue"),kn("state",function(){return{dialogSwipeState:Li(),currentScreen:j(0)}})]),u=fn("SerialisedDialog",i,n),c=qt(Sh(function(f){return{dom:J('<div class="${prefix}-serialised-dialog"></div>'),components:[qn.sketch({dom:J('<div class="${prefix}-serialised-dialog-chain" style="left: 0px; position: absolute;"></div>'),components:P(u.fields,function(s,l){return l<=u.maxFieldIndex?qn.sketch({dom:J('<div class="${prefix}-serialised-dialog-screen"></div>'),components:[t(-1,"previous",0<l),f.field(s.name,s.spec),t(1,"next",l<u.maxFieldIndex)]}):f.field(s.name,s.spec)})})],formBehaviours:W([kr(function(s,l){(function(d,v){ht(d.element(),"."+E.resolve("serialised-dialog-chain")).each(function(p){U(p,"left",-u.state.currentScreen.get()*v.width+"px")})})(s,l)}),nn.config({mode:"special",focusIn:function(s){r(s)},onTab:function(s){return e(s,1),g.some(!0)},onShiftTab:function(s){return e(s,-1),g.some(!0)}}),Te("form-events",[Bt(function(s,l){u.state.currentScreen.set(0),u.state.dialogSwipeState.clear();var d=a.get(s);rn.highlightFirst(d),u.getInitialValue(s).each(function(v){q.setValue(s,v)})}),Ve(u.onExecute),z(Ho(),function(s,l){l.event().raw().propertyName==="left"&&r(s)}),z(o,function(s,l){var d=l.event().direction();e(s,d)})])])}})),a=qt({dom:J('<div class="${prefix}-dot-container"></div>'),behaviours:W([rn.config({highlightClass:E.resolve("dot-active"),itemClass:E.resolve("dot-item")})]),components:Pn(u.fields,function(f,s){return s<=u.maxFieldIndex?[Gt('<div class="${prefix}-dot-item ${prefix}-icon-full-dot ${prefix}-icon"></div>')]:[]})});return{dom:J('<div class="${prefix}-serializer-wrapper"></div>'),components:[c.asSpec(),a.asSpec()],behaviours:W([nn.config({mode:"special",focusIn:function(f){var s=c.get(f);nn.focusIn(s)}}),Te("serializer-wrapper-events",[z(Dt(),function(f,s){var l=s.event();u.state.dialogSwipeState.set(Th(l.raw().touches[0].clientX))}),z(fr(),function(f,s){var l=s.event();u.state.dialogSwipeState.on(function(d){s.event().prevent(),u.state.dialogSwipeState.set(Oh(d,l.raw().touches[0].clientX))})}),z(sr(),function(f){u.state.dialogSwipeState.on(function(s){var l=c.get(f),d=-1*kh(s);e(l,d)})})])])}}function ao(n){function t(e){return function(){throw new Error("The component must be in a context to send: "+e+(n?`
`+pt(n().element())+" is not in context.":""))}}return{debugInfo:m("fake"),triggerEvent:t("triggerEvent"),triggerFocus:t("triggerFocus"),triggerEscape:t("triggerEscape"),build:t("build"),addToWorld:t("addToWorld"),removeFromWorld:t("removeFromWorld"),addToGui:t("addToGui"),removeFromGui:t("removeFromGui"),getByUid:t("getByUid"),getByDom:t("getByDom"),broadcast:t("broadcast"),broadcastOn:t("broadcastOn"),broadcastEvent:t("broadcastEvent"),isConnected:m(!1)}}function fs(n,t){var e={};return Tn(n,function(r,o){Tn(r,function(i,u){var c=N(e,u).getOr([]);e[u]=c.concat([t(o,i)])})}),e}function zp(n,t,e,r){try{var o=function(i,u){var c=oc.call(i,0);return c.sort(u),c}(e,function(i,u){var c=i[t](),a=u[t](),f=r.indexOf(c),s=r.indexOf(a);if(f===-1)throw new Error("The ordering for "+n+" does not have an entry for "+c+`.
Order specified: `+JSON.stringify(r,null,2));if(s===-1)throw new Error("The ordering for "+n+" does not have an entry for "+a+`.
Order specified: `+JSON.stringify(r,null,2));return f<s?-1:s<f?1:0});return en.value(o)}catch(i){return en.error([i])}}function Gi(n){return n.cHandler}function Lp(n,t){return{name:m(n),handler:m(t)}}function Gp(n,t,e){var r=D(D({},e),function(o,i){var u={};return B(o,function(c){u[c.name()]=c.handlers(i)}),u}(t,n));return fs(r,Lp)}function Up(n){var t=function(e){return Jn(e)?{can:m(!0),abort:m(!1),run:e}:e}(n);return function(e,r){for(var o=[],i=2;i<arguments.length;i++)o[i-2]=arguments[i];var u=[e,r].concat(o);t.abort.apply(void 0,u)?r.stop():t.can.apply(void 0,u)&&t.run.apply(void 0,u)}}function $p(n,t,e){var r=t[e];return r?zp("Event: "+e,"name",n,r).map(function(o){var i=P(o,function(u){return u.handler()});return Md(i)}):function(o,i){return en.error(["The event ("+o+`) has more than one behaviour that listens to it.
When this occurs, you must specify an event ordering for the behaviours in your spec (e.g. [ "listing", "toggling" ]).
The behaviours that can trigger it are: `+JSON.stringify(P(i,function(u){return u.name()}),null,2)])}(e,n)}function Wp(n){return $o("custom.definition",ln([An("dom","dom",Rt(),ln([O("tag"),w("styles",{}),w("classes",[]),w("attributes",{}),$("value"),$("innerHtml")])),O("components"),O("uid"),w("events",{}),w("apis",{}),An("eventOrder","eventOrder",function(t){return Ft.mergeWithThunk(m(t))}({"alloy.execute":["disabling","alloy.base.behaviour","toggling","typeaheadevents"],"alloy.focus":["alloy.base.behaviour","focusing","keying"],"alloy.system.init":["alloy.base.behaviour","disabling","toggling","representing"],input:["alloy.base.behaviour","representing","streaming","invalidating"],"alloy.system.detached":["alloy.base.behaviour","representing","item-events","tooltipping"],mousedown:["focusing","alloy.base.behaviour","item-type-events"],touchstart:["focusing","alloy.base.behaviour","item-type-events"],mouseover:["item-type-events","tooltipping"]}),yr()),$("domModification")]),n)}function ss(n,t){B(t,function(e){pn(n,e)})}function Ui(n,t){B(t,function(e){sn(n,e)})}function Xp(n,t){return function(e,r){var o=P(r,function(u){return Xo(u.name(),[O("config"),w("state",Un)])}),i=$o("component.behaviours",ln(o),e.behaviours).fold(function(u){throw new Error(Nc(u)+`
Complete spec:
`+JSON.stringify(e,null,2))},function(u){return u});return{list:r,data:gn(i,function(u){var c=u.map(function(a){return{config:a.config,state:a.state.init(a.config)}});return function(){return c}})}}(n,t)}function qp(n){var t=function(e){var r=N(e,"behaviours").getOr({}),o=yn(bn(r),function(i){return r[i]!==void 0});return P(o,function(i){return r[i].me})}(n);return Xp(n,t)}function Yp(n,t,e){var r=function(u){return D(D({},u.dom),{uid:u.uid,domChildren:P(u.components,function(c){return c.element()})})}(n),o=function(u){return u.domModification.fold(function(){return Zn({})},Zn)}(n),i={"alloy.base.modification":o};return function(u,c){return D(D({},u),{attributes:D(D({},u.attributes),c.attributes),styles:D(D({},u.styles),c.styles),classes:u.classes.concat(c.classes)})}(r,0<t.length?function(u,c,a,f){var s=D({},c);B(a,function(h){s[h.name()]=h.exhibit(u,f)});function l(h){return er(h,function(x,b){return D(D({},b.modification),x)},{})}var d=fs(s,function(h,x){return{name:h,modification:x}}),v=er(d.classes,function(h,x){return x.modification.concat(h)},[]),p=l(d.attributes),y=l(d.styles);return Zn({classes:v,attributes:p,styles:y})}(e,i,t,r):o)}function Kp(n,t,e){var r={"alloy.base.behaviour":function(o){return o.events}(n)};return function(o,i,u,c){var a=Gp(o,u,c);return Fh(a,i)}(e,n.eventOrder,t,r).getOrDie()}function Jp(n){function t(){return s}var e=j(Ih),r=Ec(Wp(n)),o=qp(n),i=function(l){return l.list}(o),u=function(l){return l.data}(o),c=function(l){var d=_.fromTag(l.tag);Ic(d,l.attributes),ss(d,l.classes),pe(d,l.styles),l.innerHtml.each(function(p){return Zd(d,p)});var v=l.domChildren;return Mo(d,v),l.value.each(function(p){os(d,p)}),l.uid,Ei(d,l.uid),d}(Yp(r,i,u)),a=Kp(r,i,u),f=j(r.components),s={getSystem:e.get,config:function(l){var d=u;return(Jn(d[l.name()])?d[l.name()]:function(){throw new Error("Could not find "+l.name()+" in "+JSON.stringify(n,null,2))})()},hasConfigured:function(l){return Jn(u[l.name()])},spec:m(n),readState:function(l){return u[l]().map(function(d){return d.state.readState()}).getOr("not enabled")},getApis:function(){return r.apis},connect:function(l){e.set(l)},disconnect:function(){e.set(ao(t))},element:m(c),syncComponents:function(){var l=ut(c),d=Pn(l,function(v){return e.get().getByDom(v).fold(function(){return[]},function(p){return[p]})});f.set(d)},components:f.get,events:m(a)};return s}function Qp(n){var t=Mh(n),e=t.events,r=yu(t,["events"]),o=function(u){var c=N(u,"components").getOr([]);return P(c,et)}(r),i=D(D({},r),{events:D(D({},_h),e),components:o});return en.value(Jp(i))}function ls(n){var t=_.fromText(n);return Rh({element:t})}function ds(n){(xr(n.element()).isNone()||vn.isFocused(n))&&(vn.isFocused(n)||vn.focus(n),it(n,ws,{item:n}))}function ms(n){it(n,Ss,{item:n})}function Zp(n,t){var e=zn(t),r=Nt(e).bind(function(i){function u(c){return on(i,c)}return u(t)?g.some(t):function(c,a){var f=function(s){for(var l=0;l<s.childNodes.length;l++){var d=_.fromDom(s.childNodes[l]);if(a(d))return g.some(d);var v=f(s.childNodes[l]);if(v.isSome())return v}return g.none()};return f(c.dom())}(t,u)}),o=n(t);return r.each(function(i){Nt(e).filter(function(u){return on(u,i)}).fold(function(){Vt(i)},A)}),o}function $i(n,t,e,r){var o=n.getSystem().build(r);yc(n,o,e)}function gs(n,t,e,r){var o=lo(n);Rn(o,function(i){return on(r.element(),i.element())}).each(Nu)}function ps(n,t,e,r,o){var i=lo(n);return g.from(i[r]).map(function(u){return gs(n,0,0,u),o.each(function(c){$i(n,0,function(a,f){(function(s,l,d){Ru(s,d).fold(function(){_n(s,l)},function(v){Bu(v,l)})})(a,f,r)},c)}),u})}function nh(n,t){var e={};Tn(n,function(u,c){B(u,function(a){e[a]=c})});var r=t,o=function(u){return Hu(u,function(c,a){return{k:c,v:a}})}(t),i=gn(o,function(u,c){return[c].concat(Cs(e,r,o,c))});return gn(e,function(u){return N(i,u).getOr([u])})}function Wi(n,t,e,r){return N(t.routes,r.start).bind(function(o){return N(o,r.destination)})}function Xi(n,t,e){(function(r,o,i){return Zi(r,o).bind(function(u){return Ms(r,o,i,u)})})(n,t,e).each(function(r){var o=r.transition;sn(n.element(),o.transitionClass),xn(n.element(),t.destinationAttr)})}function fo(n,t,e,r){Xi(n,t,e),se(n.element(),t.stateAttr)&&X(n.element(),t.stateAttr)!==r&&t.onFinish(n,r),H(n.element(),t.stateAttr,r)}function so(n){return N(n,"format").getOr(n.title)}function th(n){return cn(n,"items")?function(t){var e=an(Td(t,["items"]),{menu:!0}),r=Fs(t.items);return{item:e,menus:an(r.menus,On(t.title,r.items)),expansions:an(r.expansions,On(t.title,t.title))}}(n):{item:n,menus:{},expansions:{}}}function hs(n){var t=n.replace(/\|/g," ").trim();return 0<t.length?t.split(/\s+/):[]}function eh(n){var t=n.toolbar!==void 0?n.toolbar:Jh;return re(t)?Rs(t):hs(t)}function rh(n){function t(){n.stopPropagation()}function e(){n.preventDefault()}var r=_.fromDom(n.target),o=wo(e,t);return function(i,u,c,a,f,s,l){return{target:m(i),x:m(u),y:m(c),stop:a,prevent:f,kill:s,raw:m(l)}}(r,n.clientX,n.clientY,t,e,o,n)}function vs(n,t,e,r,o){var i=function(u,c){return function(a){u(a)&&c(rh(a))}}(e,r);return n.dom().addEventListener(t,i,o),{unbind:Hn(nv,n,t,i,o)}}function Y(n,t,e){return function(r,o,i,u){return vs(r,o,i,u,!1)}(n,t,Bs,e)}function qi(n,t,e){return function(r,o,i,u){return vs(r,o,i,u,!0)}(n,t,Bs,e)}function Yi(n){var t=n.matchMedia("(orientation: portrait)").matches;return{isPortrait:m(t)}}var ys,bs,xs=function(n){var t=_.fromDom(n.selection.getStart());return ct(t,"a")},Ki={getInfo:function(n){return xs(n).fold(function(){return function(t){return{url:"",text:t.selection.getContent({format:"text"}),title:"",target:"",link:g.none()}}(n)},function(t){return function(e){var r=rs(e),o=X(e,"href"),i=X(e,"title"),u=X(e,"target");return{url:uo(o),text:r!==o?uo(r):"",title:uo(i),target:uo(u),link:g.some(e)}}(t)})},applyInfo:function(n,t){t.url.toOption().filter(We).fold(function(){(function(e,r){r.link.bind(un).each(function(o){e.execCommand("unlink")})})(n,t)},function(e){var r=function(o,i){var u={};return u.href=o,i.title.toOption().filter(We).each(function(c){u.title=c}),i.target.toOption().filter(We).each(function(c){u.target=c}),u}(e,t);t.link.bind(un).fold(function(){var o=t.text.toOption().filter(We).getOr(e);n.insertContent(n.dom.createHTML("a",r,n.dom.encode(o)))},function(o){var i=Fp(o,e,t);Ic(o,r),i.each(function(u){(function(c,a){c.dom().textContent=a})(o,u)})})})},query:xs},oh=Ot(),ih=function(n,t){(oh.os.isAndroid()?Rp:xu)(t,n)},Te=function(n,t){return{key:n,value:{config:{},me:function(e,r){var o=tn(r);return En({fields:[O("enabled")],name:e,active:{events:m(o)}})}(n,t),configAsRaw:m({}),initialConfig:{},state:Un}}},uh=Object.freeze({__proto__:null,getCurrent:function(n,t,e){return t.find(n)}}),ch=[O("find")],Xn=En({fields:ch,name:"composing",apis:uh}),qn=Ge({name:"Container",factory:function(n){var t=n.dom,e=t.attributes,r=yu(t,["attributes"]);return{uid:n.uid,dom:D({tag:"div",attributes:D({role:"presentation"},e)},r),components:n.components,behaviours:Vm(n.containerBehaviours),events:n.events,domModification:n.domModification,eventOrder:n.eventOrder}},configFields:[w("components",[]),at("containerBehaviours",[]),w("events",{}),w("domModification",{}),w("eventOrder",{})]}),ah=Ge({name:"DataField",factory:function(n){return{uid:n.uid,dom:n.dom,behaviours:Br(n.dataBehaviours,[q.config({store:{mode:"memory",initialValue:n.getInitialValue()}}),Xn.config({find:g.some})]),events:tn([Bt(function(t,e){q.setValue(t,n.getInitialValue())})])}},configFields:[O("uid"),O("dom"),O("getInitialValue"),Rr("dataBehaviours",[q,Xn])]}),fh=m([$("data"),w("inputAttributes",{}),w("inputStyles",{}),w("tag","input"),w("inputClasses",[]),dn("onSetValue"),w("styles",{}),w("eventOrder",{}),at("inputBehaviours",[q,vn]),w("selectOnFocus",!0)]),sh=Ge({name:"Input",configFields:fh(),factory:function(n,t){return{uid:n.uid,dom:function(e){return{tag:e.tag,attributes:D({type:"text"},e.inputAttributes),styles:e.inputStyles,classes:e.inputClasses}}(n),components:[],behaviours:Bp(n),eventOrder:n.eventOrder}}}),lh=Object.freeze({__proto__:null,exhibit:function(n,t){return Zn({attributes:Gn([{key:t.tabAttr,value:"true"}])})}}),dh=[w("tabAttr","data-alloy-tabstop")],mh=En({fields:dh,name:"tabstopping",active:lh}),gh=tinymce.util.Tools.resolve("tinymce.util.I18n"),ph=["input","button","textarea","select"],Ji=function(n,t,e){t.disableClass.each(function(r){pn(n.element(),r)}),(zi(n,t)?Vp:jp)(n),t.onDisabled(n)},hh=Object.freeze({__proto__:null,enable:us,disable:Ji,isDisabled:cs,onLoad:is,set:function(n,t,e,r){(r?Ji:us)(n,t,e)}}),vh=Object.freeze({__proto__:null,exhibit:function(n,t){return Zn({classes:t.disabled?t.disableClass.map(ku).getOr([]):[]})},events:function(n,t){return tn([_c(lr(),function(e,r){return cs(e,n)}),Jo(n,t,is)])}}),yh=[w("disabled",!1),w("useNative",!0),$("disableClass"),dn("onDisabled"),dn("onEnabled")],bh=En({fields:yh,name:"disabling",active:vh,apis:hh}),xh=[at("formBehaviours",[q])],wh=function(n,t){return{uid:n.uid,dom:n.dom,components:t,behaviours:vt(n.formBehaviours,[q.config({store:{mode:"manual",getValue:function(e){var r=function(o,i){var u=o.getSystem();return gn(i.partUids,function(c,a){return m(u.getByUid(c))})}(e,n);return gn(r,function(o,i){return o().bind(function(u){return function(c,a){return c.fold(function(){return en.error(a)},en.value)}(Xn.getCurrent(u),new Error("Cannot find a current component to extract the value from for form part '"+i+"': "+pt(u.element())))}).map(q.getValue)})},setValue:function(e,r){Tn(r,function(o,i){Wn(e,n,i).each(function(u){Xn.getCurrent(u).each(function(c){q.setValue(c,o)})})})}}})]),apis:{getField:function(e,r){return Wn(e,n,r).bind(Xn.getCurrent)}}}},Sh=(wi(function(n,t,e){return n.getField(t,e)}),function(n){var t,e=(t=[],{field:function(u,c){return t.push(u),function(a,f,s){return{uiType:ff(),owner:a,name:f,config:s,validated:{}}}("form",as(u),c)},record:function(){return t}}),r=n(e),o=e.record(),i=P(o,function(u){return Lr({name:u,pname:as(u)})});return Ga("form",xh,i,wh,r)}),Th=function(n){return{xValue:n,points:[]}},Oh=function(n,t){if(t===n.xValue)return n;var e=0<t-n.xValue?1:-1,r={direction:e,xValue:t};return{xValue:t,points:(n.points.length===0?[]:n.points[n.points.length-1].direction===e?n.points.slice(0,n.points.length-1):n.points).concat([r])}},kh=function(n){if(n.points.length===0)return 0;var t=n.points[0].direction,e=n.points[n.points.length-1].direction;return t===-1&&e===-1?-1:t===1&&e===1?1:0},Eh=Et(function(n,t){return[{label:"the link group",items:[Pp({fields:[co("url","Type or paste URL"),co("text","Link text"),co("title","Link title"),co("target","Link target"),function(e){return{name:e,spec:ah.sketch({dom:{tag:"span",styles:{display:"none"}},getInitialValue:function(){return g.none()}})}}("link")],maxFieldIndex:["url","text","title","target"].length-1,getInitialValue:function(){return g.some(Ki.getInfo(t))},onExecute:function(e){var r=q.getValue(e);Ki.applyInfo(t,r),n.restoreToolbar(),t.focus()}})]}]}),Ch=[{title:"Headings",items:[{title:"Heading 1",format:"h1"},{title:"Heading 2",format:"h2"},{title:"Heading 3",format:"h3"},{title:"Heading 4",format:"h4"},{title:"Heading 5",format:"h5"},{title:"Heading 6",format:"h6"}]},{title:"Inline",items:[{title:"Bold",icon:"bold",format:"bold"},{title:"Italic",icon:"italic",format:"italic"},{title:"Underline",icon:"underline",format:"underline"},{title:"Strikethrough",icon:"strikethrough",format:"strikethrough"},{title:"Superscript",icon:"superscript",format:"superscript"},{title:"Subscript",icon:"subscript",format:"subscript"},{title:"Code",icon:"code",format:"code"}]},{title:"Blocks",items:[{title:"Paragraph",format:"p"},{title:"Blockquote",format:"blockquote"},{title:"Div",format:"div"},{title:"Pre",format:"pre"}]},{title:"Alignment",items:[{title:"Left",icon:"alignleft",format:"alignleft"},{title:"Center",icon:"aligncenter",format:"aligncenter"},{title:"Right",icon:"alignright",format:"alignright"},{title:"Justify",icon:"alignjustify",format:"alignjustify"}]}],Dh=tn([(ys=_t(),bs=function(n,t){var e=t.event().originator(),r=t.event().target();return!function(o,i,u){return on(i,o.element())&&!on(i,u)}(n,e,r)||(M.console.warn(_t()+` did not get interpreted by the desired target. 
Originator: `+pt(e)+`
Target: `+pt(r)+`
Check the `+_t()+" event handlers"),!1)},{key:ys,value:ae({can:bs})})]),_h=Object.freeze({__proto__:null,events:Dh}),Mh=un,Ih=ao(),Ah=function(n,t){return function(e,r){return{cHandler:e,purpose:m(r)}}(Hn.apply(void 0,[n.handler].concat(t)),n.purpose())},Fh=function(n,t){var e=Fo(n,function(r,o){return(r.length===1?en.value(r[0].handler()):$p(r,t,o)).map(function(i){var u=Up(i),c=1<r.length?yn(t[o],function(a){return ko(r,function(f){return f.name()===a})}).join(" > "):r[0].name();return On(o,function(a,f){return{handler:a,purpose:m(f)}}(u,c))})});return Od(e,{})},Rh=function(n){var t=fn("external.component",Mn([O("element"),$("uid")]),n),e=j(ao());t.uid.each(function(o){Ei(t.element,o)});var r={getSystem:e.get,config:g.none,hasConfigured:m(!1),connect:function(o){e.set(o)},disconnect:function(){e.set(ao(function(){return r}))},getApis:function(){return{}},element:m(t.element),spec:m(n),readState:m("No state"),syncComponents:A,components:m([]),events:m({})};return za(r)},Bh=Ar,et=function(n){return function(t){return N(t,df)}(n).fold(function(){var t=n.hasOwnProperty("uid")?n:D({uid:Bh("")},n);return Qp(t).getOrDie()},function(t){return t})},Xe=za,ws="alloy.item-hover",Ss="alloy.item-focus",Ts=m(ws),Vh=m(Ss),Nh=[O("data"),O("components"),O("dom"),w("hasSubmenu",!1),$("toggling"),Rr("itemBehaviours",[G,vn,nn,q]),w("ignoreFocus",!1),w("domModification",{}),K("builder",function(n){return{dom:n.dom,domModification:D(D({},n.domModification),{attributes:D(D(D({role:n.toggling.isSome()?"menuitemcheckbox":"menuitem"},n.domModification.attributes),{"aria-haspopup":n.hasSubmenu}),n.hasSubmenu?{"aria-expanded":!1}:{})}),behaviours:Br(n.itemBehaviours,[n.toggling.fold(G.revoke,function(t){return G.config(D({aria:{mode:"checked"}},t))}),vn.config({ignore:n.ignoreFocus,stopMousedown:n.ignoreFocus,onFocus:function(t){ms(t)}}),nn.config({mode:"execution"}),q.config({store:{mode:"memory",initialValue:n.data}}),Te("item-type-events",function(){for(var e=0,r=0,o=arguments.length;r<o;r++)e+=arguments[r].length;var i=Array(e),u=0;for(r=0;r<o;r++)for(var c=arguments[r],a=0,f=c.length;a<f;a++,u++)i[u]=c[a];return i}(Qc(),[z(cc(),ds),z(_e(),vn.focus)]))]),components:n.components,eventOrder:n.eventOrder}}),w("eventOrder",{})],jh=[O("dom"),O("components"),K("builder",function(n){return{dom:n.dom,components:n.components,events:tn([function(t){return z(t,function(e,r){r.stop()})}(_e())])}})],Os=m([Lr({name:"widget",overrides:function(n){return{behaviours:W([q.config({store:{mode:"manual",getValue:function(t){return n.data},setValue:function(){}}})])}}})]),Hh=[O("uid"),O("data"),O("components"),O("dom"),w("autofocus",!1),w("ignoreFocus",!1),Rr("widgetBehaviours",[q,vn,nn]),w("domModification",{}),Pa(Os()),K("builder",function(n){function t(i){return Wn(i,n,"widget").map(function(u){return nn.focusIn(u),u})}function e(i,u){return ye(u.event().target())||n.autofocus&&u.setSource(i.element()),g.none()}var r=Na(0,n,Os()),o=ja("item-widget",n,r.internals());return{dom:n.dom,components:o,domModification:n.domModification,events:tn([Ve(function(i,u){t(i).each(function(c){u.stop()})}),z(cc(),ds),z(_e(),function(i,u){n.autofocus?t(i):vn.focus(i)})]),behaviours:Br(n.widgetBehaviours,[q.config({store:{mode:"memory",initialValue:n.data}}),vn.config({ignore:n.ignoreFocus,onFocus:function(i){ms(i)}}),nn.config({mode:"special",focusIn:n.autofocus?function(i){t(i)}:Kd(),onLeft:e,onRight:e,onEscape:function(i,u){return vn.isFocused(i)||n.autofocus?(n.autofocus&&u.setSource(i.element()),g.none()):(vn.focus(i),g.some(!0))}})])}})],Ph=It("type",{widget:Hh,item:Nh,separator:jh}),zh=m([sf({factory:{sketch:function(n){var t=fn("menu.spec item",Ph,n);return t.builder(t)}},name:"items",unit:"item",defaults:function(n,t){return t.hasOwnProperty("uid")?t:D(D({},t),{uid:Ar("item")})},overrides:function(n,t){return{type:t.type,ignoreFocus:n.fakeFocus,domModification:{classes:[n.markers.item]}}}})]),Lh=m([O("value"),O("items"),O("dom"),O("components"),w("eventOrder",{}),at("menuBehaviours",[rn,q,Xn,nn]),Re("movement",{mode:"menu",moveOnTab:!0},It("mode",{grid:[ea(),K("config",function(n,t){return{mode:"flatgrid",selector:"."+n.markers.item,initSize:{numColumns:t.initSize.numColumns,numRows:t.initSize.numRows},focusManager:n.focusManager}})],matrix:[K("config",function(n,t){return{mode:"matrix",selectors:{row:t.rowSelector,cell:"."+n.markers.item},focusManager:n.focusManager}}),O("rowSelector")],menu:[w("moveOnTab",!0),K("config",function(n,t){return{mode:"menu",selector:"."+n.markers.item,moveOnTab:t.moveOnTab,focusManager:n.focusManager}})]})),ce("markers",sm()),w("fakeFocus",!1),w("focusManager",di()),dn("onHighlight")]),ks=m("alloy.menu-focus"),Es=Gr({name:"Menu",configFields:Lh(),partFields:zh(),factory:function(n,t,e,r){return{uid:n.uid,dom:n.dom,markers:n.markers,behaviours:vt(n.menuBehaviours,[rn.config({highlightClass:n.markers.selectedItem,itemClass:n.markers.item,onHighlight:n.onHighlight}),q.config({store:{mode:"memory",initialValue:n.value}}),Xn.config({find:g.some}),nn.config(n.movement.config(n,n.movement))]),events:tn([z(Vh(),function(o,i){var u=i.event();o.getSystem().getByDom(u.target()).each(function(c){rn.highlight(o,c),i.stop(),it(o,ks(),{menu:o,item:c})})}),z(Ts(),function(o,i){var u=i.event().item();rn.highlight(o,u)})]),components:t,eventOrder:n.eventOrder,domModification:{attributes:{role:"menu"}}}}}),lo=function(n,t){return n.components()},mn=En({fields:[],name:"replacing",apis:Object.freeze({__proto__:null,append:function(n,t,e,r){$i(n,0,_n,r)},prepend:function(n,t,e,r){$i(n,0,Jl,r)},remove:gs,replaceAt:ps,replaceBy:function(n,t,e,r,o){var i=lo(n);return ee(i,r).bind(function(u){return ps(n,0,0,u,o)})},set:function(n,t,e,r){Zp(function(){var o=P(r,n.getSystem().build);Ql(n,o)},n.element())},contents:lo})}),Cs=function(n,t,e,r){return N(e,r).bind(function(o){return N(n,o).bind(function(i){var u=Cs(n,t,e,i);return g.some([i].concat(u))})}).getOr([])},Ds=function(n){return n.type==="prepared"?g.some(n.menu):g.none()},_s={init:function(){function n(f){return function(s,l){for(var d=bn(s),v=0,p=d.length;v<p;v++){var y=d[v],h=s[y];if(l(h,y,s))return g.some(h)}return g.none()}(t.get(),function(s,l){return s===f})}var t=j({}),e=j({}),r=j({}),o=j(g.none()),i=j({}),u=function(f){return c(f).bind(Ds)},c=function(f){return N(e.get(),f)},a=function(f){return N(t.get(),f)};return{setMenuBuilt:function(f,s){var l;e.set(D(D({},e.get()),((l={})[f]={type:"prepared",menu:s},l)))},setContents:function(f,s,l,d){o.set(g.some(f)),t.set(l),e.set(s),i.set(d);var v=nh(d,l);r.set(v)},expand:function(f){return N(t.get(),f).map(function(s){var l=N(r.get(),f).getOr([]);return[s].concat(l)})},refresh:function(f){return N(r.get(),f)},collapse:function(f){return N(r.get(),f).bind(function(s){return 1<s.length?g.some(s.slice(1)):g.none()})},lookupMenu:c,lookupItem:a,otherMenus:function(f){var s=i.get();return Ou(bn(s),f)},getPrimary:function(){return o.get().bind(u)},getMenus:function(){return e.get()},clear:function(){t.set({}),e.set({}),r.set({}),o.set(g.none())},isClear:function(){return o.get().isNone()},getTriggeringPath:function(f,s){var l=yn(a(f).toArray(),function(d){return u(d).isSome()});return N(r.get(),f).bind(function(d){var v=De(l.concat(d));return function(p){for(var y=[],h=0;h<p.length;h++){var x=p[h];if(!x.isSome())return g.none();y.push(x.getOrDie())}return g.some(y)}(Pn(v,function(p,y){return function(h,x,b){return u(h).bind(function(k){return n(h).bind(function(S){return x(S).map(function(T){return{triggeredMenu:k,triggeringItem:T,triggeringPath:b}})})})}(p,s,v.slice(0,y+1)).fold(function(){return o.get().is(p)?[]:[g.none()]},function(h){return[g.some(h)]})}))})}}},extractPreparedMenu:Ds},Gh=m("collapse-item"),Qi=Ge({name:"TieredMenu",configFields:[Uc("onExecute"),Uc("onEscape"),ii("onOpenMenu"),ii("onOpenSubmenu"),dn("onRepositionMenu"),dn("onCollapseMenu"),w("highlightImmediately",!0),mt("data",[O("primary"),O("menus"),O("expansions")]),w("fakeFocus",!1),dn("onHighlight"),dn("onHover"),mt("markers",[O("backgroundMenu")].concat(ta()).concat(ai())),O("dom"),w("navigateOnHover",!0),w("stayInDom",!1),at("tmenuBehaviours",[nn,rn,Xn,mn]),w("eventOrder",{})],apis:{collapseMenu:function(n,t){n.collapseMenu(t)},highlightPrimary:function(n,t){n.highlightPrimary(t)},repositionMenus:function(n,t){n.repositionMenus(t)}},factory:function(n,t){function e(S,T,C){return gn(C,function(I,V){function L(){return Es.sketch(D(D({dom:I.dom},I),{value:V,items:I.items,markers:n.markers,fakeFocus:n.fakeFocus,onHighlight:n.onHighlight,focusManager:n.fakeFocus?function(){function Q(Z){return rn.getHighlighted(Z).map(function(jn){return jn.element()})}return{get:Q,set:function(Z,jn){var Qt=Q(Z);Z.getSystem().getByDom(jn).fold(A,function(Ee){rn.highlight(Z,Ee)});var Tt=Q(Z);da(Z,Qt,Tt)}}}():di()}))}return V===T?{type:"prepared",menu:S.getSystem().build(L())}:{type:"notbuilt",nbMenu:L}})}function r(S){return q.getValue(S).value}function o(S,T){rn.highlight(S,T),rn.getHighlighted(T).orThunk(function(){return rn.getFirst(T)}).each(function(C){Do(S,C.element(),_e())})}function i(S,T){return li(P(T,function(C){return S.lookupMenu(C).bind(function(I){return I.type==="prepared"?g.some(I.menu):g.none()})}))}function u(S,T,C){var I=i(T,T.otherMenus(C));B(I,function(V){Ui(V.element(),[n.markers.backgroundMenu]),n.stayInDom||mn.remove(S,V)})}function c(S,T){var C=function(I){return l.get().getOrThunk(function(){var V={},L=wn(I.element(),"."+n.markers.item),Q=yn(L,function(Z){return X(Z,"aria-haspopup")==="true"});return B(Q,function(Z){I.getSystem().getByDom(Z).each(function(jn){var Qt=r(jn);V[Qt]=jn})}),l.set(g.some(V)),V})}(S);Tn(C,function(I,V){var L=hn(T,V);H(I.element(),"aria-expanded",L)})}function a(S,T,C){return g.from(C[0]).bind(function(I){return T.lookupMenu(I).bind(function(V){if(V.type==="notbuilt")return g.none();var L=V.menu,Q=i(T,C.slice(1));return B(Q,function(Z){pn(Z.element(),n.markers.backgroundMenu)}),Ct(L.element())||mn.append(S,Xe(L)),Ui(L.element(),[n.markers.backgroundMenu]),o(S,L),u(S,T,C),g.some(L)})})}var f,s,l=j(g.none()),d=_s.init(),v=function(S){return gn(n.data.menus,function(T,C){return Pn(T.items,function(I){return I.type==="separator"?[]:[I.data.value]})})};(s=f=f||{})[s.HighlightSubmenu=0]="HighlightSubmenu",s[s.HighlightParent=1]="HighlightParent";function p(S,T,C){C===void 0&&(C=f.HighlightSubmenu);var I=r(T);return d.expand(I).bind(function(V){return c(S,V),g.from(V[0]).bind(function(L){return d.lookupMenu(L).bind(function(Q){var Z=function(jn,Qt,Tt){if(Tt.type!=="notbuilt")return Tt.menu;var Ee=jn.getSystem().build(Tt.nbMenu());return d.setMenuBuilt(Qt,Ee),Ee}(S,L,Q);return Ct(Z.element())||mn.append(S,Xe(Z)),n.onOpenSubmenu(S,T,Z,De(V)),C===f.HighlightSubmenu?(rn.highlightFirst(Z),a(S,d,V)):(rn.dehighlightAll(Z),g.some(T))})})})}function y(S,T){var C=r(T);return d.collapse(C).bind(function(I){return c(S,I),a(S,d,I).map(function(V){return n.onCollapseMenu(S,T,V),V})})}function h(S){return function(T,C){return ct(C.getSource(),"."+n.markers.item).bind(function(I){return T.getSystem().getByDom(I).toOption().bind(function(V){return S(T,V).map(function(){return!0})})})}}function x(S){return rn.getHighlighted(S).bind(rn.getHighlighted)}var b=tn([z(ks(),function(S,T){var C=T.event().item();d.lookupItem(r(C)).each(function(){var I=T.event().menu();rn.highlight(S,I);var V=r(T.event().item());d.refresh(V).each(function(L){return u(S,d,L)})})}),Ve(function(S,T){var C=T.event().target();S.getSystem().getByDom(C).each(function(I){r(I).indexOf("collapse-item")===0&&y(S,I),p(S,I,f.HighlightSubmenu).fold(function(){n.onExecute(S,I)},function(){})})}),Bt(function(S,T){(function(C){var I=e(C,n.data.primary,n.data.menus),V=v();return d.setContents(n.data.primary,I,n.data.expansions,V),d.getPrimary()})(S).each(function(C){mn.append(S,Xe(C)),n.onOpenMenu(S,C),n.highlightImmediately&&o(S,C)})})].concat(n.navigateOnHover?[z(Ts(),function(S,T){var C=T.event().item();(function(I,V){var L=r(V);d.refresh(L).bind(function(Q){return c(I,Q),a(I,d,Q)})})(S,C),p(S,C,f.HighlightParent),n.onHover(S,C)})]:[])),k={collapseMenu:function(S){x(S).each(function(T){y(S,T)})},highlightPrimary:function(S){d.getPrimary().each(function(T){o(S,T)})},repositionMenus:function(S){d.getPrimary().bind(function(T){return x(S).bind(function(C){var I=r(C),V=function(Q){return Fo(Q,function(Z){return Z})}(d.getMenus()),L=li(P(V,_s.extractPreparedMenu));return d.getTriggeringPath(I,function(Q){return function(Z,jn,Qt){return Co(jn,function(Tt){if(!Tt.getSystem().isConnected())return g.none();var Ee=rn.getCandidates(Tt);return Rn(Ee,function(yy){return r(yy)===Qt})})}(0,L,Q)})}).map(function(C){return{primary:T,triggeringPath:C}})}).fold(function(){(function(T){return g.from(T.components()[0]).filter(function(C){return X(C.element(),"role")==="menu"})})(S).each(function(T){n.onRepositionMenu(S,T,[])})},function(T){var C=T.primary,I=T.triggeringPath;n.onRepositionMenu(S,C,I)})}};return{uid:n.uid,dom:n.dom,markers:n.markers,behaviours:vt(n.tmenuBehaviours,[nn.config({mode:"special",onRight:h(function(S,T){return ye(T.element())?g.none():p(S,T,f.HighlightSubmenu)}),onLeft:h(function(S,T){return ye(T.element())?g.none():y(S,T)}),onEscape:h(function(S,T){return y(S,T).orThunk(function(){return n.onEscape(S,T).map(function(){return S})})}),focusIn:function(S,T){d.getPrimary().each(function(C){Do(S,C.element(),_e())})}}),rn.config({highlightClass:n.markers.selectedMenu,itemClass:n.markers.menu}),Xn.config({find:function(S){return rn.getHighlighted(S)}}),mn.config({})]),eventOrder:n.eventOrder,apis:k,events:b}},extraApis:{tieredData:function(n,t,e){return{primary:n,menus:t,expansions:e}},singleData:function(n,t){return{primary:n,menus:On(n,t),expansions:{}}},collapseItem:function(n){return{value:Lt(Gh()),meta:{text:n}}}}}),Ms=function(n,t,e,r){return Wi(0,t,0,r).bind(function(o){return o.transition.map(function(i){return{transition:i,route:o}})})},Zi=function(n,t,e){var r=n.element();return se(r,t.destinationAttr)?g.some({start:X(n.element(),t.stateAttr),destination:X(n.element(),t.destinationAttr)}):g.none()},Uh=Object.freeze({__proto__:null,findRoute:Wi,disableTransition:Xi,getCurrentRoute:Zi,jumpTo:fo,progressTo:function(n,t,e,r){(function(i,u){se(i.element(),u.destinationAttr)&&(H(i.element(),u.stateAttr,X(i.element(),u.destinationAttr)),xn(i.element(),u.destinationAttr))})(n,t);var o=function(i,u,c,a){return{start:X(i.element(),u.stateAttr),destination:a}}(n,t,0,r);Ms(n,t,e,o).fold(function(){fo(n,t,e,r)},function(i){Xi(n,t,e);var u=i.transition;pn(n.element(),u.transitionClass),H(n.element(),t.destinationAttr,r)})},getState:function(n,t,e){var r=n.element();return se(r,t.stateAttr)?g.some(X(r,t.stateAttr)):g.none()}}),$h=Object.freeze({__proto__:null,events:function(n,t){return tn([z(Ho(),function(e,r){var o=r.event().raw();Zi(e,n).each(function(i){Wi(0,n,0,i).each(function(u){u.transition.each(function(c){o.propertyName===c.property&&(fo(e,n,t,i.destination),n.onTransition(e,i))})})})}),Bt(function(e,r){fo(e,n,t,n.initialState)})])}}),Wh=[w("destinationAttr","data-transitioning-destination"),w("stateAttr","data-transitioning-state"),O("initialState"),dn("onTransition"),dn("onFinish"),ce("routes",Uo(en.value,Uo(en.value,Mn([Cc("transition",[O("property"),O("transitionClass")])]))))],wt=En({fields:Wh,name:"transitioning",active:$h,apis:Uh,extra:{createRoutes:function(n){var t={};return Tn(n,function(e,r){var o=r.split("<->");t[o[0]]=On(o[1],e),t[o[1]]=On(o[0],e)}),t},createBistate:function(n,t,e){return Gn([{key:n,value:On(t,e)},{key:t,value:On(n,e)}])},createTristate:function(n,t,e,r){return Gn([{key:n,value:Gn([{key:t,value:r},{key:e,value:r}])},{key:t,value:Gn([{key:n,value:r},{key:e,value:r}])},{key:e,value:Gn([{key:n,value:r},{key:t,value:r}])}])}}}),nu=E.resolve("scrollable"),Kt={register:function(n){pn(n,nu)},deregister:function(n){sn(n,nu)},scrollable:m(nu)},Is=function(n,t,e,r,o){return{data:{value:n,text:t},type:"item",dom:{tag:"div",classes:o?[E.resolve("styles-item-is-menu")]:[]},toggling:{toggleOnExecute:!1,toggleClass:E.resolve("format-matches"),selected:e},itemBehaviours:W(o?[]:[oa(n,function(i,u){(u?G.on:G.off)(i)})]),components:[{dom:{tag:"div",attributes:{style:r},innerHtml:t}}]}},As=function(n,t,e,r){return{value:n,dom:{tag:"div"},components:[Yt.sketch({dom:{tag:"div",classes:[E.resolve("styles-collapser")]},components:r?[{dom:{tag:"span",classes:[E.resolve("styles-collapse-icon")]}},ls(n)]:[ls(n)],action:function(o){if(r){var i=e().get(o);Qi.collapseMenu(i)}}}),{dom:{tag:"div",classes:[E.resolve("styles-menu-items-container")]},components:[Es.parts().items({})],behaviours:W([Te("adhoc-scrollable-menu",[Bt(function(o,i){U(o.element(),"overflow-y","auto"),U(o.element(),"-webkit-overflow-scrolling","touch"),Kt.register(o.element())}),jc(function(o){Pt(o.element(),"overflow-y"),Pt(o.element(),"-webkit-overflow-scrolling"),Kt.deregister(o.element())})])])}],items:t,menuBehaviours:W([wt.config({initialState:"after",routes:wt.createTristate("before","current","after",{transition:{property:"transform",transitionClass:"transitioning"}})})])}},Xh=function(n){var t=function(r,o){var i=As("Styles",[].concat(P(r.items,function(a){return Is(so(a),a.title,a.isSelected(),a.getPreview(),cn(r.expansions,so(a)))})),o,!1),u=gn(r.menus,function(a,f){var s=P(a,function(l){return Is(so(l),l.title,l.isSelected!==void 0&&l.isSelected(),l.getPreview!==void 0?l.getPreview():"",cn(r.expansions,so(l)))});return As(f,s,o,!0)}),c=an(u,On("styles",i));return{tmenu:Qi.tieredData("styles",c,r.expansions)}}(n.formats,function(){return e}),e=qt(Qi.sketch({dom:{tag:"div",classes:[E.resolve("styles-menu")]},components:[],fakeFocus:!0,stayInDom:!0,onExecute:function(r,o){var i=q.getValue(o);return n.handle(o,i.value),g.none()},onEscape:function(){return g.none()},onOpenMenu:function(r,o){var i=xe(r.element());wf(o.element(),i),wt.jumpTo(o,"current")},onOpenSubmenu:function(r,o,i){var u=xe(r.element()),c=si(o.element(),'[role="menu"]').getOrDie("hacky"),a=r.getSystem().getByDom(c).getOrDie();wf(i.element(),u),wt.progressTo(a,"before"),wt.jumpTo(i,"after"),wt.progressTo(i,"current")},onCollapseMenu:function(r,o,i){var u=si(o.element(),'[role="menu"]').getOrDie("hacky"),c=r.getSystem().getByDom(u).getOrDie();wt.progressTo(c,"after"),wt.progressTo(i,"current")},navigateOnHover:!1,highlightImmediately:!0,data:t.tmenu,markers:{backgroundMenu:E.resolve("styles-background-menu"),menu:E.resolve("styles-menu"),selectedMenu:E.resolve("styles-selected-menu"),item:E.resolve("styles-item"),selectedItem:E.resolve("styles-selected-item")}}));return e.asSpec()},Fs=function(n){return er(n,function(t,e){var r=th(e);return{menus:an(t.menus,r.menus),items:[r.item].concat(t.items),expansions:an(t.expansions,r.expansions)}},{menus:{},expansions:{},items:[]})},qh={expand:Fs},Yh=function(n,t){function e(u){return function(){return n.formatter.match(u)}}function r(u){return function(){return n.formatter.getCssText(u)}}var o=N(t,"style_formats").getOr(Ch),i=function(u){return P(u,function(c){if(cn(c,"items")){var a=i(c.items);return an(function(f){return an(f,{isSelected:m(!1),getPreview:m("")})}(c),{items:a})}return cn(c,"format")?function(f){return an(f,{isSelected:e(f.format),getPreview:r(f.format)})}(c):function(f){var s=Lt(f.title),l=an(f,{format:s,isSelected:e(s),getPreview:r(s)});return n.formatter.register(s,l),l}(c)})};return i(o)},Kh=function(n,t,e){var r=function(o,i){var u=function(a){return Pn(a,function(f){return f.items===void 0?!cn(f,"format")||o.formatter.canApply(f.format)?[f]:[]:0<u(f.items).length?[f]:[]})},c=u(i);return qh.expand(c)}(n,t);return Xh({formats:r,handle:function(o,i){n.undoManager.transact(function(){G.isOn(o)?n.formatter.remove(i):n.formatter.apply(i)}),e()}})},Jh=["undo","bold","italic","link","image","bullist","styleselect"],Rs=function(n){return Pn(n,function(t){return re(t)?Rs(t):hs(t)})},Qh=function(n,t){function e(x){return function(){return st.forToolbarCommand(t,x)}}function r(x){return function(){return st.forToolbarStateCommand(t,x)}}function o(x,b,k){return function(){return st.forToolbarStateAction(t,x,b,k)}}function i(){return Kh(t,h,function(){t.fire("scrollIntoView")})}function u(x,b){return{isSupported:function(){var k=t.ui.registry.getAll().buttons;return x.forall(function(S){return cn(k,S)})},sketch:b}}var c=e("undo"),a=e("redo"),f=r("bold"),s=r("italic"),l=r("underline"),d=e("removeformat"),v=o("unlink","link",function(){t.execCommand("unlink",null,!1)}),p=o("unordered-list","ul",function(){t.execCommand("InsertUnorderedList",null,!1)}),y=o("ordered-list","ol",function(){t.execCommand("InsertOrderedList",null,!1)}),h=Yh(t,t.settings);return{undo:u(g.none(),c),redo:u(g.none(),a),bold:u(g.none(),f),italic:u(g.none(),s),underline:u(g.none(),l),removeformat:u(g.none(),d),link:u(g.none(),function(){return function(x,b){return st.forToolbarStateAction(b,"link","link",function(){var k=Eh(x,b);x.setContextToolbar(k),ih(b,function(){x.focusToolbar()}),Ki.query(b).each(function(S){b.selection.select(S.dom())})})}(n,t)}),unlink:u(g.none(),v),image:u(g.none(),function(){return Ap(t)}),bullist:u(g.some("bullist"),p),numlist:u(g.some("numlist"),y),fontsizeselect:u(g.none(),function(){return function(x,b){var k={onChange:function(S){ji.apply(b,S)},getInitialValue:function(){return ji.get(b)}};return Wf(x,"font-size",function(){return jg(k)},b)}(n,t)}),forecolor:u(g.none(),function(){return Op(n,t)}),styleselect:u(g.none(),function(){return st.forToolbar("style-formats",function(x){t.fire("toReading"),n.dropup().appear(i,G.on,x)},W([G.config({toggleClass:E.resolve("toolbar-button-selected"),toggleOnExecute:!1,aria:{mode:"pressed"}}),Or.config({channels:Gn([ia(jt.orientationChanged(),G.off),ia(jt.dropupDismissed(),G.off)])})]),t)})}},Zh=function(n,t){var e=eh(n),r={};return Pn(e,function(o){var i=!cn(r,o)&&cn(t,o)&&t[o].isSupported()?[t[o].sketch()]:[];return r[o]=!0,i})},nv=function(n,t,e,r){n.dom().removeEventListener(t,e,r)},Bs=m(!0),Yn=tinymce.util.Tools.resolve("tinymce.util.Delay"),tv=Yi,Vs=function(n,t){var e=_.fromDom(n),r=null,o=Y(e,"orientationchange",function(){Yn.clearInterval(r);var u=Yi(n);t.onChange(u),i(function(){t.onReady(u)})}),i=function(u){Yn.clearInterval(r);var c=n.innerHeight,a=0;r=Yn.setInterval(function(){c!==n.innerHeight?(Yn.clearInterval(r),u(g.some(n.innerHeight))):20<a&&(Yn.clearInterval(r),u(g.none())),a++},50)};return{onAdjustment:i,destroy:function(){o.unbind()}}},ev=function(n){var t=Ot().os.isiOS(),e=Yi(n).isPortrait();return t&&!e?n.screen.height:n.screen.width};function Ns(n){var t=n.raw();return t.touches===void 0||t.touches.length!==1?g.none():g.some(t.touches[0])}function js(n){var t=j(g.none()),e=j(!1),r=function(u,c){var a=null;return{cancel:function(){a!==null&&(M.clearTimeout(a),a=null)},schedule:function(){for(var f=[],s=0;s<arguments.length;s++)f[s]=arguments[s];a=M.setTimeout(function(){u.apply(null,f),a=null},c)}}}(function(i){n.triggerEvent(gd(),i),e.set(!0)},400),o=Gn([{key:Dt(),value:function(i){return Ns(i).each(function(u){r.cancel();var c={x:m(u.clientX),y:m(u.clientY),target:i.target};r.schedule(i),e.set(!1),t.set(g.some(c))}),g.none()}},{key:fr(),value:function(i){return r.cancel(),Ns(i).each(function(u){t.get().each(function(c){!function(a,f){var s=Math.abs(a.clientX-f.x()),l=Math.abs(a.clientY-f.y());return 5<s||5<l}(u,c)||t.set(g.none())})}),g.none()}},{key:sr(),value:function(i){return r.cancel(),t.get().filter(function(u){return on(u.target(),i.target())}).map(function(u){return e.get()?(i.prevent(),!1):n.triggerEvent(lc(),i)})}}]);return{fireIfReady:function(i,u){return N(o,u).bind(function(c){return c(i)})}}}var Hs=function(n){var t=js({triggerEvent:function(e,r){n.onTapContent(r)}});return{fireTouchstart:function(e){t.fireIfReady(e,"touchstart")},onTouchend:function(){return Y(n.body(),"touchend",function(e){t.fireIfReady(e,"touchend")})},onTouchmove:function(){return Y(n.body(),"touchmove",function(e){t.fireIfReady(e,"touchmove")})}}},rv=6<=Ot().os.version.major,ov=function(n,t,e){function r(a){return!on(a.start(),a.finish())||a.soffset()!==a.foffset()}function o(){var a=n.doc().dom().hasFocus()&&n.getSelection().exists(r);e.getByDom(t).each((a||Nt(u).filter(function(f){return Dn(f)==="input"}).exists(function(f){return f.dom().selectionStart!==f.dom().selectionEnd}))===!0?G.on:G.off)}var i=Hs(n),u=zn(t),c=[Y(n.body(),"touchstart",function(a){n.onTouchContent(),i.fireTouchstart(a)}),i.onTouchmove(),i.onTouchend(),Y(t,"touchstart",function(a){n.onTouchToolstrip()}),n.onToReading(function(){gt(n.body())}),n.onToEditing(A),n.onScrollToCursor(function(a){a.preventDefault(),n.getCursorBox().each(function(f){var s=n.win(),l=f.top()>s.innerHeight||f.bottom()>s.innerHeight?f.bottom()-s.innerHeight+50:0;l!=0&&s.scrollTo(s.pageXOffset,s.pageYOffset+l)})})].concat(rv==!0?[]:[Y(_.fromDom(n.win()),"blur",function(){e.getByDom(t).each(G.off)}),Y(u,"select",o),Y(n.doc(),"selectionchange",o)]);return{destroy:function(){B(c,function(a){a.unbind()})}}},mo=function(n,t){var e=parseInt(X(n,t),10);return isNaN(e)?0:e};function iv(n){return Dn(n)==="img"?1:function(t){return hv.getOption(t)}(n).fold(function(){return ut(n).length},function(t){return t.length})}function Ps(n,t,e){var r=n.document.createRange();return function(o,i){i.fold(function(u){o.setStartBefore(u.dom())},function(u,c){o.setStart(u.dom(),c)},function(u){o.setStartAfter(u.dom())})}(r,t),function(o,i){i.fold(function(u){o.setEndBefore(u.dom())},function(u,c){o.setEnd(u.dom(),c)},function(u){o.setEndAfter(u.dom())})}(r,e),r}function tu(n,t,e,r,o){var i=n.document.createRange();return i.setStart(t.dom(),e),i.setEnd(r.dom(),o),i}function uv(n){return{left:m(n.left),top:m(n.top),right:m(n.right),bottom:m(n.bottom),width:m(n.width),height:m(n.height)}}function zs(n,t,e){return t(_.fromDom(e.startContainer),e.startOffset,_.fromDom(e.endContainer),e.endOffset)}function Ls(n,t){return function(e,r){var o=r.ltr();return o.collapsed?r.rtl().filter(function(i){return i.collapsed===!1}).map(function(i){return Ye.rtl(_.fromDom(i.endContainer),i.endOffset,_.fromDom(i.startContainer),i.startOffset)}).getOrThunk(function(){return zs(0,Ye.ltr,o)}):zs(0,Ye.ltr,o)}(0,function(e,r){return r.match({domRange:function(o){return{ltr:m(o),rtl:g.none}},relative:function(o,i){return{ltr:Et(function(){return Ps(e,o,i)}),rtl:Et(function(){return g.some(Ps(e,i,o))})}},exact:function(o,i,u,c){return{ltr:Et(function(){return tu(e,o,i,u,c)}),rtl:Et(function(){return g.some(tu(e,u,c,o,i))})}}})}(n,t))}function Gs(n,t){var e=Dn(n);return e==="input"?qe.after(n):hn(["br","img"],e)?t===0?qe.before(n):qe.after(n):qe.on(n,t)}function cv(n,t,e,r){var o=function(u,c,a,f){var s=zn(u).dom().createRange();return s.setStart(u.dom(),c),s.setEnd(a.dom(),f),s}(n,t,e,r),i=on(n,e)&&t===r;return o.collapsed&&!i}function eu(n,t,e,r,o){(function(i,u){g.from(i.getSelection()).each(function(c){c.removeAllRanges(),c.addRange(u)})})(n,tu(n,t,e,r,o))}function av(n,t,e,r,o){(function(i,u){Ls(i,u).match({ltr:function(c,a,f,s){eu(i,c,a,f,s)},rtl:function(c,a,f,s){var l=i.getSelection();if(l.setBaseAndExtent)l.setBaseAndExtent(c.dom(),a,f.dom(),s);else if(l.extend)try{(function(d,v,p,y,h,x){v.collapse(p.dom(),y),v.extend(h.dom(),x)})(0,l,c,a,f,s)}catch(d){eu(i,f,s,c,a)}else eu(i,f,s,c,a)}})})(n,function(i,u,c,a){var f=Gs(i,u),s=Gs(c,a);return au.relative(f,s)}(t,e,r,o))}function fv(n){var t=_.fromDom(n.anchorNode),e=_.fromDom(n.focusNode);return cv(t,n.anchorOffset,e,n.focusOffset)?g.some(uu.create(t,n.anchorOffset,e,n.focusOffset)):function(r){if(0<r.rangeCount){var o=r.getRangeAt(0),i=r.getRangeAt(r.rangeCount-1);return g.some(uu.create(_.fromDom(o.startContainer),o.startOffset,_.fromDom(i.endContainer),i.endOffset))}return g.none()}(n)}function ru(n){return g.from(n.getSelection()).filter(function(t){return 0<t.rangeCount}).bind(fv)}function Us(n,t){return function(e){var r=e.getClientRects(),o=0<r.length?r[0]:e.getBoundingClientRect();return 0<o.width||0<o.height?g.some(o).map(uv):g.none()}(function(e,r){return Ls(e,r).match({ltr:function(o,i,u,c){var a=e.document.createRange();return a.setStart(o.dom(),i),a.setEnd(u.dom(),c),a},rtl:function(o,i,u,c){var a=e.document.createRange();return a.setStart(u.dom(),c),a.setEnd(o.dom(),i),a}})}(n,t))}function sv(n){return{left:n.left,top:n.top,right:n.right,bottom:n.bottom,width:m(2),height:n.height}}function lv(n){return{left:m(n.left),top:m(n.top),right:m(n.right),bottom:m(n.bottom),width:m(n.width),height:m(n.height)}}function $s(n,t){H(n,Qs,t)}function dv(n){return{top:m(n.top()),bottom:m(n.top()+n.height())}}function mv(n,t){var e=function(o){return mo(o,Qs)}(t),r=n.innerHeight;return r<e?g.some(e-r):g.none()}function Ws(n){return g.some(_.fromDom(n.dom().contentWindow.document.body))}function Xs(n){return g.some(_.fromDom(n.dom().contentWindow.document))}function ou(n){return g.from(n.dom().contentWindow)}function qs(n){return ou(n).bind(ru)}function iu(n){return n.getFrame()}function go(n,t){return function(e){return e[n].getOrThunk(function(){var r=iu(e);return function(){return t(r)}})()}}function Ys(n,t,e,r){return n[e].getOrThunk(function(){return function(o){return Y(t,r,o)}})}function gv(n){return{left:m(n.left),top:m(n.top),right:m(n.right),bottom:m(n.bottom),width:m(n.width),height:m(n.height)}}function Ks(n,t){var e=null;return{cancel:function(){e!==null&&(M.clearTimeout(e),e=null)},throttle:function(){for(var r=[],o=0;o<arguments.length;o++)r[o]=arguments[o];e!==null&&M.clearTimeout(e),e=M.setTimeout(function(){n.apply(null,r),e=null},t)}}}function pv(n){return X(n,cl)==="true"?function(t){return 0<t.dom().scrollLeft||function(e){e.dom().scrollLeft=1;var r=e.dom().scrollLeft!==0;return e.dom().scrollLeft=0,r}(t)}(n):function(t){return 0<t.dom().scrollTop||function(e){e.dom().scrollTop=1;var r=e.dom().scrollTop!==0;return e.dom().scrollTop=0,r}(t)}(n)}var Js,hv=function(t,e){var r=function(o){return t(o)?g.from(o.dom().nodeValue):g.none()};return{get:function(o){if(!t(o))throw new Error("Can only get "+e+" value of a "+e+" node");return r(o).getOr("")},getOption:r,set:function(o,i){if(!t(o))throw new Error("Can only set raw "+e+" value of a "+e+" node");o.dom().nodeValue=i}}}(dr,"text"),uu={create:_o("start","soffset","finish","foffset")},cu=Qn([{before:["element"]},{on:["element","offset"]},{after:["element"]}]),qe={before:cu.before,on:cu.on,after:cu.after,cata:function(n,t,e,r){return n.fold(t,e,r)},getStart:function(n){return n.fold(un,un,un)}},po=Qn([{domRange:["rng"]},{relative:["startSitu","finishSitu"]},{exact:["start","soffset","finish","foffset"]}]),au={domRange:po.domRange,relative:po.relative,exact:po.exact,exactFromRange:function(n){return po.exact(n.start(),n.soffset(),n.finish(),n.foffset())},getWin:function(n){return function(t){return _.fromDom(t.dom().ownerDocument.defaultView)}(function(t){return t.match({domRange:function(e){return _.fromDom(e.startContainer)},relative:function(e,r){return qe.getStart(e)},exact:function(e,r,o,i){return e}})}(n))},range:uu.create},Ye=Qn([{ltr:["start","soffset","finish","foffset"]},{rtl:["start","soffset","finish","foffset"]}]),fu=(Ye.ltr,Ye.rtl,function(n){var t=n.getSelection();return t!==void 0&&0<t.rangeCount?function(e){if(e.collapsed){var r=_.fromDom(e.startContainer);return dt(r).bind(function(o){var i=au.exact(r,e.startOffset,o,iv(o));return Us(e.startContainer.ownerDocument.defaultView,i).map(sv).map(ku)}).getOr([])}return P(e.getClientRects(),lv)}(t.getRangeAt(0)):[]}),vv=function(n){n.focus();var t=_.fromDom(n.document.body);(Nt().exists(function(e){return hn(["input","textarea"],Dn(e))})?function(e){Yn.setTimeout(function(){e()},0)}:xu)(function(){Nt().each(gt),Vt(t)})},Qs="data-"+E.resolve("last-outer-height"),yv=function(n,t){var e=_.fromDom(t.document.body),r=Y(_.fromDom(n),"resize",function(){mv(n,e).each(function(o){(function(i){var u=fu(i);return 0<u.length?g.some(u[0]).map(dv):g.none()})(t).each(function(i){var u=function(c,a,f){return a.top()>c.innerHeight||a.bottom()>c.innerHeight?Math.min(f,a.bottom()-c.innerHeight+50):0}(t,i,o);u!==0&&t.scrollTo(t.pageXOffset,t.pageYOffset+u)})}),$s(e,n.innerHeight)});return $s(e,n.innerHeight),{toEditing:function(){vv(t)},destroy:function(){r.unbind()}}},ho={getBody:go("getBody",Ws),getDoc:go("getDoc",Xs),getWin:go("getWin",ou),getSelection:go("getSelection",qs),getFrame:iu,getActiveApi:function(n){var t=iu(n);return Ws(t).bind(function(e){return Xs(t).bind(function(r){return ou(t).map(function(o){var i=_.fromDom(r.dom().documentElement),u=n.getCursorBox.getOrThunk(function(){return function(){return function(f){return ru(f).map(function(s){return au.exact(s.start(),s.soffset(),s.finish(),s.foffset())})}(o).bind(function(f){return Us(o,f).orThunk(function(){return function(s){return ru(s).filter(function(l){return on(l.start(),l.finish())&&l.soffset()===l.foffset()}).bind(function(l){var d=l.start().dom().getBoundingClientRect();return 0<d.width||0<d.height?g.some(d).map(gv):g.none()})}(o)})})}}),c=n.setSelection.getOrThunk(function(){return function(f,s,l,d){av(o,f,s,l,d)}}),a=n.clearSelection.getOrThunk(function(){return function(){(function(f){f.getSelection().removeAllRanges()})(o)}});return{body:m(e),doc:m(r),win:m(o),html:m(i),getSelection:Hn(qs,t),setSelection:c,clearSelection:a,frame:m(t),onKeyup:Ys(n,r,"onKeyup","keyup"),onNodeChanged:Ys(n,r,"onNodeChanged","SelectionChange"),onDomChanged:n.onDomChanged,onScrollToCursor:n.onScrollToCursor,onScrollToElement:n.onScrollToElement,onToReading:n.onToReading,onToEditing:n.onToEditing,onToolbarScrollStart:n.onToolbarScrollStart,onTouchContent:n.onTouchContent,onTapContent:n.onTapContent,onTouchToolstrip:n.onTouchToolstrip,getCursorBox:u}})})})}},vo="data-ephox-mobile-fullscreen-style",Zs="position:absolute!important;",nl="top:0!important;left:0!important;margin:0!important;padding:0!important;width:100%!important;height:100%!important;overflow:visible!important;",bv=Ot().os.isAndroid(),tl=function(n,t){function e(u){return function(c){var a=X(c,"style"),f=a===void 0?"no-styles":a.trim();f!==u&&(H(c,vo,f),H(c,"style",u))}}var r=function(u,c,a){return bm(u,function(f){return ir(f,c)},a)}(n,"*"),o=Pn(r,function(u){return function(c,a){return xm(c,function(f){return ir(f,a)})}(u,"*")}),i=function(u){var c=Ne(u,"background-color");return c!==void 0&&c!==""?"background-color:"+c+"!important":"background-color:rgb(255,255,255)!important;"}(t);B(o,e("display:none!important;")),B(r,e(Zs+nl+i)),e((bv===!0?"":Zs)+nl+i)(n)},el=function(){var n=function(t){return Au(t)}("["+vo+"]");B(n,function(t){var e=X(t,vo);e!=="no-styles"?H(t,"style",e):xn(t,"style"),xn(t,vo)})},rl=function(){var n=fa("head").getOrDie(),t=fa('meta[name="viewport"]').getOrThunk(function(){var r=_.fromTag("meta");return H(r,"name","viewport"),_n(n,r),r}),e=X(t,"content");return{maximize:function(){H(t,"content","width=device-width, initial-scale=1.0, user-scalable=no, maximum-scale=1.0")},restore:function(){e!=null&&0<e.length?H(t,"content",e):H(t,"content","user-scalable=yes")}}},xv=function(n,t){var e=rl(),r=Se(),o=Se();return{enter:function(){t.hide(),pn(n.container,E.resolve("fullscreen-maximized")),pn(n.container,E.resolve("android-maximized")),e.maximize(),pn(n.body,E.resolve("android-scroll-reload")),r.set(yv(n.win,ho.getWin(n.editor).getOrDie("no"))),ho.getActiveApi(n.editor).each(function(i){tl(n.container,i.body()),o.set(ov(i,n.toolstrip,n.alloy))})},exit:function(){e.restore(),t.show(),sn(n.container,E.resolve("fullscreen-maximized")),sn(n.container,E.resolve("android-maximized")),el(),sn(n.body,E.resolve("android-scroll-reload")),o.clear(),r.clear()}}},ol=function(n,t){var e=qt(qn.sketch({dom:J('<div aria-hidden="true" class="${prefix}-mask-tap-icon"></div>'),containerBehaviours:W([G.config({toggleClass:E.resolve("mask-tap-icon-selected"),toggleOnExecute:!1})])})),r=function(o,i){var u=null;return{cancel:function(){u!==null&&(M.clearTimeout(u),u=null)},throttle:function(){for(var c=[],a=0;a<arguments.length;a++)c[a]=arguments[a];u===null&&(u=M.setTimeout(function(){o.apply(null,c),u=null},i))}}}(n,200);return qn.sketch({dom:J('<div class="${prefix}-disabled-mask"></div>'),components:[qn.sketch({dom:J('<div class="${prefix}-content-container"></div>'),components:[Yt.sketch({dom:J('<div class="${prefix}-content-tap-section"></div>'),components:[e.asSpec()],action:function(o){r.throttle()},buttonBehaviours:W([G.config({toggleClass:E.resolve("mask-tap-icon-selected")})])})]})]})},il=ln([mt("editor",[O("getFrame"),$("getBody"),$("getDoc"),$("getWin"),$("getSelection"),$("setSelection"),$("clearSelection"),$("cursorSaver"),$("onKeyup"),$("onNodeChanged"),$("getCursorBox"),O("onDomChanged"),w("onTouchContent",A),w("onTapContent",A),w("onTouchToolstrip",A),w("onScrollToCursor",m({unbind:A})),w("onScrollToElement",m({unbind:A})),w("onToEditing",m({unbind:A})),w("onToReading",m({unbind:A})),w("onToolbarScrollStart",un)]),O("socket"),O("toolstrip"),O("dropup"),O("toolbar"),O("container"),O("alloy"),kn("win",function(n){return zn(n.socket).dom().defaultView}),kn("body",function(n){return _.fromDom(n.socket.dom().ownerDocument.body)}),w("translate",un),w("setReadOnly",A),w("readOnlyOnInit",m(!0))]),wv=function(n){var t=fn("Getting AndroidWebapp schema",il,n);U(t.toolstrip,"width","100%");var e=et(ol(function(){t.setReadOnly(t.readOnlyOnInit()),o.enter()},t.translate));t.alloy.add(e);var r={show:function(){t.alloy.add(e)},hide:function(){t.alloy.remove(e)}};_n(t.container,e.element());var o=xv(t,r);return{setReadOnly:t.setReadOnly,refreshStructure:A,enter:o.enter,exit:o.exit,destroy:A}},Sv=m([O("dom"),w("shell",!0),at("toolbarBehaviours",[mn])]),Tv=m([ki({name:"groups",overrides:function(){return{behaviours:W([mn.config({})])}}})]),yo=Gr({name:"Toolbar",configFields:Sv(),partFields:Tv(),factory:function(n,t,e,r){var o=function(u){return n.shell?g.some(u):Wn(u,n,"groups")},i=n.shell?{behaviours:[mn.config({})],components:[]}:{behaviours:[],components:t};return{uid:n.uid,dom:n.dom,components:i.components,behaviours:vt(n.toolbarBehaviours,i.behaviours),apis:{setGroups:function(u,c){o(u).fold(function(){throw M.console.error("Toolbar was defined to not be a shell, but no groups container was specified in components"),new Error("Toolbar was defined to not be a shell, but no groups container was specified in components")},function(a){mn.set(a,c)})}},domModification:{attributes:{role:"group"}}}},apis:{setGroups:function(n,t,e){n.setGroups(t,e)}}}),Ov=m([O("items"),(Js=["itemSelector"],mt("markers",P(Js,O))),at("tgroupBehaviours",[nn])]),kv=m([sf({name:"items",unit:"item"})]),ul=Gr({name:"ToolbarGroup",configFields:Ov(),partFields:kv(),factory:function(n,t,e,r){return{uid:n.uid,dom:n.dom,components:t,behaviours:vt(n.tgroupBehaviours,[nn.config({mode:"flow",selector:n.markers.itemSelector})]),domModification:{attributes:{role:"toolbar"}}}}}),cl="data-"+E.resolve("horizontal-scroll"),al={exclusive:function(n,t){return Y(n,"touchmove",function(e){ct(e.target(),t).filter(pv).fold(function(){e.raw().preventDefault()},A)})},markAsHorizontal:function(n){H(n,cl,"true")}};function fl(){function n(i){var u=i.scrollable===!0?"${prefix}-toolbar-scrollable-group":"";return{dom:J('<div aria-label="'+i.label+'" class="${prefix}-toolbar-group '+u+'"></div>'),tgroupBehaviours:W([Te("adhoc-scrollable-toolbar",i.scrollable===!0?[Hc(function(c,a){U(c.element(),"overflow-x","auto"),al.markAsHorizontal(c.element()),Kt.register(c.element())})]:[])]),components:[qn.sketch({components:[ul.parts().items({})]})],markers:{itemSelector:"."+E.resolve("toolbar-group-item")},items:i.items}}function t(){yo.setGroups(e,o.get()),G.off(e)}var e=et(yo.sketch({dom:J('<div class="${prefix}-toolbar"></div>'),components:[yo.parts().groups({})],toolbarBehaviours:W([G.config({toggleClass:E.resolve("context-toolbar"),toggleOnExecute:!1,aria:{mode:"none"}}),nn.config({mode:"cyclic"})]),shell:!0})),r=et(qn.sketch({dom:{classes:[E.resolve("toolstrip")]},components:[Xe(e)],containerBehaviours:W([G.config({toggleClass:E.resolve("android-selection-context-toolbar"),toggleOnExecute:!1})])})),o=j([]);return{wrapper:m(r),toolbar:m(e),createGroups:function(i){return P(i,wo(ul.sketch,n))},setGroups:function(i){o.set(i),t()},setContextToolbar:function(i){G.on(e),yo.setGroups(e,i)},restoreToolbar:function(){G.isOn(e)&&t()},refresh:function(){},focus:function(){nn.focusIn(e)}}}function Ev(n,t){mn.append(n,Xe(t))}function Cv(n,t){mn.remove(n,t)}function Ke(n,t){return t.getAnimationRoot.fold(function(){return n.element()},function(e){return e(n)})}function St(n){return n.dimension.property}function Oe(n,t){return n.dimension.getDimension(t)}function su(n,t){var e=Ke(n,t);Ui(e,[t.shrinkingClass,t.growingClass])}function lu(n,t){sn(n.element(),t.openClass),pn(n.element(),t.closedClass),U(n.element(),St(t),"0px"),Tr(n.element())}function sl(n,t){sn(n.element(),t.closedClass),pn(n.element(),t.openClass),Pt(n.element(),St(t))}function ll(n,t,e,r){e.setCollapsed(),U(n.element(),St(t),Oe(t,n.element())),Tr(n.element()),su(n,t),lu(n,t),t.onStartShrink(n),t.onShrunk(n)}function Dv(n,t,e,r){var o=r.getOrThunk(function(){return Oe(t,n.element())});e.setCollapsed(),U(n.element(),St(t),o),Tr(n.element());var i=Ke(n,t);sn(i,t.growingClass),pn(i,t.shrinkingClass),lu(n,t),t.onStartShrink(n)}function dl(n,t,e){var r=Oe(t,n.element());(r==="0px"?ll:Dv)(n,t,e,g.some(r))}function ml(n,t,e){var r=Ke(n,t),o=At(r,t.shrinkingClass),i=Oe(t,n.element());sl(n,t);var u=Oe(t,n.element());(o?function(){U(n.element(),St(t),i),Tr(n.element())}:function(){lu(n,t)})(),sn(r,t.shrinkingClass),pn(r,t.growingClass),sl(n,t),U(n.element(),St(t),u),e.setExpanded(),t.onStartGrow(n)}function gl(n,t,e){var r=Ke(n,t);return At(r,t.growingClass)===!0}function pl(n,t,e){var r=Ke(n,t);return At(r,t.shrinkingClass)===!0}function hl(n,t){var e=et(qn.sketch({dom:{tag:"div",classes:[E.resolve("dropup")]},components:[],containerBehaviours:W([mn.config({}),Je.config({closedClass:E.resolve("dropup-closed"),openClass:E.resolve("dropup-open"),shrinkingClass:E.resolve("dropup-shrinking"),growingClass:E.resolve("dropup-growing"),dimension:{property:"height"},onShrunk:function(o){n(),t(),mn.set(o,[])},onGrown:function(o){n(),t()}}),kr(function(o,i){r(A)})])})),r=function(o){M.window.requestAnimationFrame(function(){o(),Je.shrink(e)})};return{appear:function(o,i,u){Je.hasShrunk(e)===!0&&Je.isTransitioning(e)===!1&&M.window.requestAnimationFrame(function(){i(u),mn.set(e,[o()]),Je.grow(e)})},disappear:r,component:m(e),element:e.element}}function _v(n){return n.raw().which===8&&!hn(["input","textarea"],Dn(n.target()))&&!function(t,e,r){return ct(t,e,r).isSome()}(n.target(),'[contenteditable="true"]')}function Mv(n,t){var e=fn("Getting GUI events settings",Bv,t),r=js(e),o=P(["touchstart","touchmove","touchend","touchcancel","gesturestart","mousedown","mouseup","mouseover","mousemove","mouseout","click"].concat(["selectstart","input","contextmenu","change","transitionend","drag","dragstart","dragend","dragenter","dragleave","dragover","drop","keyup"]),function(l){return Y(n,l,function(d){r.fireIfReady(d,l).each(function(v){v&&d.kill()}),e.triggerEvent(l,d)&&d.kill()})}),i=j(g.none()),u=Y(n,"paste",function(l){r.fireIfReady(l,"paste").each(function(d){d&&l.kill()}),e.triggerEvent("paste",l)&&l.kill(),i.set(g.some(M.setTimeout(function(){e.triggerEvent(md(),l)},0)))}),c=Y(n,"keydown",function(l){e.triggerEvent("keydown",l)?l.kill():e.stopBackspace===!0&&_v(l)&&l.prevent()}),a=function(l,d){return Tl?qi(l,"focus",d):Y(l,"focusin",d)}(n,function(l){e.triggerEvent("focusin",l)&&l.kill()}),f=j(g.none()),s=function(l,d){return Tl?qi(l,"blur",d):Y(l,"focusout",d)}(n,function(l){e.triggerEvent("focusout",l)&&l.kill(),f.set(g.some(M.setTimeout(function(){e.triggerEvent(dd(),l)},0)))});return{unbind:function(){B(o,function(l){l.unbind()}),c.unbind(),a.unbind(),s.unbind(),u.unbind(),i.get().each(M.clearTimeout),f.get().each(M.clearTimeout)}}}function vl(n,t){var e=N(n,"target").map(function(r){return r()}).getOr(t);return j(e)}function yl(n,t,e,r,o,i){var u=n(t,r),c=function(a,f){var s=j(!1),l=j(!1);return{stop:function(){s.set(!0)},cut:function(){l.set(!0)},isStopped:s.get,isCut:l.get,event:m(a),setSource:f.set,getSource:f.get}}(e,o);return u.fold(function(){return i.logEventNoHandlers(t,r),Qe.complete()},function(a){var f=a.descHandler();return Gi(f)(c),c.isStopped()?(i.logEventStopped(t,a.element(),f.purpose()),Qe.stopped()):c.isCut()?(i.logEventCut(t,a.element(),f.purpose()),Qe.complete()):dt(a.element()).fold(function(){return i.logNoParent(t,a.element(),f.purpose()),Qe.complete()},function(s){return i.logEventResponse(t,a.element(),f.purpose()),Qe.resume(s)})})}function Iv(n,t,e){var r=function(o){var i=j(!1);return{stop:function(){i.set(!0)},cut:A,isStopped:i.get,isCut:m(!1),event:m(o),setSource:So("Cannot set source of a broadcasted event"),getSource:So("Cannot get source of a broadcasted event")}}(t);return B(n,function(o){var i=o.descHandler();Gi(i)(r)}),r.isStopped()}var bl,xl=function(n){return et(Yt.sketch({dom:J('<div class="${prefix}-mask-edit-icon ${prefix}-icon"></div>'),action:function(){n.run(function(t){t.setReadOnly(!1)})}}))},wl=function(){return et(qn.sketch({dom:J('<div class="${prefix}-editor-socket"></div>'),components:[],containerBehaviours:W([mn.config({})])}))},Sl=function(n,t,e,r){(e===!0?br.toAlpha:br.toOmega)(r),(e?Ev:Cv)(n,t)},Av=Object.freeze({__proto__:null,refresh:function(n,t,e){if(e.isExpanded()){Pt(n.element(),St(t));var r=Oe(t,n.element());U(n.element(),St(t),r)}},grow:function(n,t,e){e.isExpanded()||ml(n,t,e)},shrink:function(n,t,e){e.isExpanded()&&dl(n,t,e)},immediateShrink:function(n,t,e){e.isExpanded()&&ll(n,t,e,g.none())},hasGrown:function(n,t,e){return e.isExpanded()},hasShrunk:function(n,t,e){return e.isCollapsed()},isGrowing:gl,isShrinking:pl,isTransitioning:function(n,t,e){return gl(n,t)===!0||pl(n,t)===!0},toggleGrow:function(n,t,e){(e.isExpanded()?dl:ml)(n,t,e)},disableTransitions:su}),Fv=Object.freeze({__proto__:null,exhibit:function(n,t){var e=t.expanded;return Zn(e?{classes:[t.openClass],styles:{}}:{classes:[t.closedClass],styles:On(t.dimension.property,"0px")})},events:function(n,t){return tn([function(e,r){return hr(e)(r)}(Ho(),function(e,r){r.event().raw().propertyName===n.dimension.property&&(su(e,n),t.isExpanded()&&Pt(e.element(),n.dimension.property),(t.isExpanded()?n.onGrown:n.onShrunk)(e))})])}}),Rv=[O("closedClass"),O("openClass"),O("shrinkingClass"),O("growingClass"),$("getAnimationRoot"),dn("onShrunk"),dn("onStartShrink"),dn("onGrown"),dn("onStartGrow"),w("expanded",!1),ce("dimension",It("property",{width:[K("property","width"),K("getDimension",function(n){return xe(n)+"px"})],height:[K("property","height"),K("getDimension",function(n){return Fn(n)+"px"})]}))],Je=En({fields:Rv,name:"sliding",active:Fv,apis:Av,state:Object.freeze({__proto__:null,init:function(n){var t=j(n.expanded);return de({isExpanded:function(){return t.get()===!0},isCollapsed:function(){return t.get()===!1},setCollapsed:Hn(t.set,!1),setExpanded:Hn(t.set,!0),readState:function(){return"expanded: "+t.get()}})}})}),Tl=Ot().browser.isFirefox(),Bv=Mn([(bl="triggerEvent",ce(bl,Wd)),w("stopBackspace",!0)]),Qe=Qn([{stopped:[]},{resume:["element"]},{complete:[]}]),Ol=function(n,t,e,r,o,i){return yl(n,t,e,r,o,i).fold(function(){return!0},function(u){return Ol(n,t,e,u,o,i)},function(){return!1})},kl=function(n,t,e,r,o){var i=vl(e,r);return Ol(n,t,e,r,i,o)},Vv=_o("element","descHandler"),Nv=function(n,t){return{id:m(n),descHandler:m(t)}};function jv(){var n={};return{registerId:function(t,e,r){Tn(r,function(o,i){var u=n[i]!==void 0?n[i]:{};u[e]=Ah(o,t),n[i]=u})},unregisterId:function(t){Tn(n,function(e,r){e.hasOwnProperty(t)&&delete e[t]})},filterByType:function(t){return N(n,t).map(function(e){return Fo(e,function(r,o){return Nv(o,r)})}).getOr([])},find:function(t,e,r){var o=N(n,e);return Xd(r,function(i){return function(u,c){return Le(c).fold(function(){return g.none()},function(a){return u.bind(function(f){return N(f,a)}).map(function(f){return Vv(c,f)})})}(o,i)},t)}}}function Hv(){function n(o){var i=o.element();return Le(i).fold(function(){return function(u,c){var a=Lt(Rg+u);return Ei(c,a),a}("uid-",o.element())},function(u){return u})}var t=jv(),e={},r=function(o){Le(o.element()).each(function(i){delete e[i],t.unregisterId(i)})};return{find:function(o,i,u){return t.find(o,i,u)},filter:function(o){return t.filterByType(o)},register:function(o){var i=n(o);cn(e,i)&&function(c,a){var f=e[a];if(f!==c)throw new Error('The tagId "'+a+'" is already used by: '+pt(f.element())+`
Cannot use it for: `+pt(c.element())+`
The conflicting element is`+(Ct(f.element())?" ":" not ")+"already in the DOM");r(c)}(o,i);var u=[o];t.registerId(u,i,o.events()),e[i]=o},unregister:r,getById:function(o){return N(e,o)}}}var Pv=function(n){function t(h){return dt(n.element()).fold(function(){return!0},function(x){return on(h,x)})}function e(h,x){return o.find(t,h,x)}function r(h){var x=o.filter(sc());B(x,function(b){var k=b.descHandler();Gi(k)(h)})}var o=Hv(),i=Mv(n.element(),{triggerEvent:function(h,x){return oi(h,x.target(),function(b){return function(k,S,T,C){var I=T.target();return kl(k,S,T,I,C)}(e,h,x,b)})}}),u={debugInfo:m("real"),triggerEvent:function(h,x,b){oi(h,x,function(k){return kl(e,h,b,x,k)})},triggerFocus:function(h,x){Le(h).fold(function(){Vt(h)},function(b){oi(_t(),h,function(k){return function(S,T,C,I,V){var L=vl(C,I);yl(S,T,C,I,L,V)}(e,_t(),{originator:m(x),kill:A,prevent:A,target:m(h)},h,k),!1})})},triggerEscape:function(h,x){u.triggerEvent("keydown",h.element(),x.event())},getByUid:function(h){return p(h)},getByDom:function(h){return y(h)},build:et,addToGui:function(h){f(h)},removeFromGui:function(h){s(h)},addToWorld:function(h){c(h)},removeFromWorld:function(h){a(h)},broadcast:function(h){l(h)},broadcastOn:function(h,x){d(h,x)},broadcastEvent:function(h,x){v(h,x)},isConnected:m(!0)},c=function(h){h.connect(u),dr(h.element())||(o.register(h),B(h.components(),c),u.triggerEvent(Po(),h.element(),{target:m(h.element())}))},a=function(h){dr(h.element())||(B(h.components(),a),o.unregister(h)),h.disconnect()},f=function(h){(function(x,b){yc(x,b,_n)})(n,h)},s=function(h){Nu(h)},l=function(h){r({universal:m(!0),data:m(h)})},d=function(h,x){r({universal:m(!1),channels:m(h),data:m(x)})},v=function(h,x){var b=o.filter(h);return Iv(b,x)},p=function(h){return o.getById(h).fold(function(){return en.error(new Error('Could not find component with uid: "'+h+'" in system.'))},en.value)},y=function(h){var x=Le(h).getOr("not found");return p(x)};return c(n),{root:m(n),element:n.element,destroy:function(){i.unbind(),Mt(n.element())},add:f,remove:s,getByUid:p,getByDom:y,addToWorld:c,removeFromWorld:a,broadcast:l,broadcastOn:d,broadcastEvent:v}},zv=m(E.resolve("readonly-mode")),Lv=m(E.resolve("edit-mode"));function El(n){var t=et(qn.sketch({dom:{classes:[E.resolve("outer-container")].concat(n.classes)},containerBehaviours:W([br.config({alpha:zv(),omega:Lv()})])}));return Pv(t)}var Cl=function(n,t){var e=_.fromTag("input");pe(e,{opacity:"0",position:"absolute",top:"-1000px",left:"-1000px"}),_n(n,e),Vt(e),t(e),Mt(e)},Dl=function(n){var t=n.getSelection();if(0<t.rangeCount){var e=t.getRangeAt(0),r=n.document.createRange();r.setStart(e.startContainer,e.startOffset),r.setEnd(e.endContainer,e.endOffset),t.removeAllRanges(),t.addRange(r)}},du=function(n,t){Nt().each(function(e){on(e,t)||gt(e)}),n.focus(),Vt(_.fromDom(n.document.body)),Dl(n)},Gv={stubborn:function(n,t,e,r){function o(){du(t,r)}var i=Y(e,"keydown",function(u){hn(["input","textarea"],Dn(u.target()))||o()});return{toReading:function(){Cl(n,gt)},toEditing:o,onToolbarTouch:function(){},destroy:function(){i.unbind()}}},timid:function(n,t,e,r){function o(){gt(r)}return{toReading:function(){o()},toEditing:function(){du(t,r)},onToolbarTouch:function(){o()},destroy:A}}},Uv=function(n,t,e,r,o){function i(){t.run(function(d){d.refreshSelection()})}function u(d,v){var p=d-r.dom().scrollTop;t.run(function(y){y.scrollIntoView(p,p+v)})}function c(){t.run(function(d){d.clearSelection()})}function a(){n.getCursorBox().each(function(d){u(d.top(),d.height())}),t.run(function(d){d.syncHeight()})}var f=Hs(n),s=Ks(a,300),l=[n.onKeyup(function(){c(),s.throttle()}),n.onNodeChanged(i),n.onDomChanged(s.throttle),n.onDomChanged(i),n.onScrollToCursor(function(d){d.preventDefault(),s.throttle()}),n.onScrollToElement(function(d){d.element(),u(t,r)}),n.onToEditing(function(){t.run(function(d){d.toEditing()})}),n.onToReading(function(){t.run(function(d){d.toReading()})}),Y(n.doc(),"touchend",function(d){on(n.html(),d.target())||on(n.body(),d.target())}),Y(e,"transitionend",function(d){d.raw().propertyName==="height"&&function(){var v=Fn(e);t.run(function(p){p.setViewportOffset(v)}),i(),a()}()}),qi(e,"touchstart",function(d){t.run(function(v){v.highlightSelection()}),function(v){t.run(function(p){p.onToolbarTouch(v)})}(d),n.onTouchToolstrip()}),Y(n.body(),"touchstart",function(d){c(),n.onTouchContent(),f.fireTouchstart(d)}),f.onTouchmove(),f.onTouchend(),Y(n.body(),"click",function(d){d.kill()}),Y(e,"touchmove",function(){n.onToolbarScrollStart()})];return{destroy:function(){B(l,function(d){d.unbind()})}}},bo,_l,mu,Ze,Ml={},Il={exports:Ml};bo=void 0,_l=Ml,mu=Il,Ze=void 0,function(n){typeof _l=="object"&&mu!==void 0?mu.exports=n():typeof bo=="function"&&bo.amd?bo([],n):(typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:this).EphoxContactWrapper=n()}(function(){return function n(t,e,r){function o(c,a){if(!e[c]){if(!t[c]){var f=typeof Ze=="function"&&Ze;if(!a&&f)return f(c,!0);if(i)return i(c,!0);var s=new Error("Cannot find module '"+c+"'");throw s.code="MODULE_NOT_FOUND",s}var l=e[c]={exports:{}};t[c][0].call(l.exports,function(d){return o(t[c][1][d]||d)},l,l.exports,n,t,e,r)}return e[c].exports}for(var i=typeof Ze=="function"&&Ze,u=0;u<r.length;u++)o(r[u]);return o}({1:[function(n,t,e){var r,o,i=t.exports={};function u(){throw new Error("setTimeout has not been defined")}function c(){throw new Error("clearTimeout has not been defined")}function a(x){if(r===setTimeout)return setTimeout(x,0);if((r===u||!r)&&setTimeout)return r=setTimeout,setTimeout(x,0);try{return r(x,0)}catch(b){try{return r.call(null,x,0)}catch(k){return r.call(this,x,0)}}}(function(){try{r=typeof setTimeout=="function"?setTimeout:u}catch(x){r=u}try{o=typeof clearTimeout=="function"?clearTimeout:c}catch(x){o=c}})();var f,s=[],l=!1,d=-1;function v(){l&&f&&(l=!1,f.length?s=f.concat(s):d=-1,s.length&&p())}function p(){if(!l){var x=a(v);l=!0;for(var b=s.length;b;){for(f=s,s=[];++d<b;)f&&f[d].run();d=-1,b=s.length}f=null,l=!1,function(S){if(o===clearTimeout)return clearTimeout(S);if((o===c||!o)&&clearTimeout)return o=clearTimeout,clearTimeout(S);try{return o(S)}catch(T){try{return o.call(null,S)}catch(C){return o.call(this,S)}}}(x)}}function y(x,b){this.fun=x,this.array=b}function h(){}i.nextTick=function(x){var b=new Array(arguments.length-1);if(1<arguments.length)for(var k=1;k<arguments.length;k++)b[k-1]=arguments[k];s.push(new y(x,b)),s.length!==1||l||a(p)},y.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=h,i.addListener=h,i.once=h,i.off=h,i.removeListener=h,i.removeAllListeners=h,i.emit=h,i.prependListener=h,i.prependOnceListener=h,i.listeners=function(x){return[]},i.binding=function(x){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(x){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},{}],2:[function(n,t,e){(function(r){function o(){}function i(p){if(typeof this!="object")throw new TypeError("Promises must be constructed via new");if(typeof p!="function")throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],l(p,this)}function u(p,y){for(;p._state===3;)p=p._value;p._state!==0?(p._handled=!0,i._immediateFn(function(){var h=p._state===1?y.onFulfilled:y.onRejected;if(h!==null){var x;try{x=h(p._value)}catch(b){return void a(y.promise,b)}c(y.promise,x)}else(p._state===1?c:a)(y.promise,p._value)})):p._deferreds.push(y)}function c(p,y){try{if(y===p)throw new TypeError("A promise cannot be resolved with itself.");if(y&&(typeof y=="object"||typeof y=="function")){var h=y.then;if(y instanceof i)return p._state=3,p._value=y,void f(p);if(typeof h=="function")return void l(function(b,k){return function(){b.apply(k,arguments)}}(h,y),p)}p._state=1,p._value=y,f(p)}catch(x){a(p,x)}}function a(p,y){p._state=2,p._value=y,f(p)}function f(p){p._state===2&&p._deferreds.length===0&&i._immediateFn(function(){p._handled||i._unhandledRejectionFn(p._value)});for(var y=0,h=p._deferreds.length;y<h;y++)u(p,p._deferreds[y]);p._deferreds=null}function s(p,y,h){this.onFulfilled=typeof p=="function"?p:null,this.onRejected=typeof y=="function"?y:null,this.promise=h}function l(p,y){var h=!1;try{p(function(x){h||(h=!0,c(y,x))},function(x){h||(h=!0,a(y,x))})}catch(x){if(h)return;h=!0,a(y,x)}}var d,v;d=this,v=setTimeout,i.prototype.catch=function(p){return this.then(null,p)},i.prototype.then=function(p,y){var h=new this.constructor(o);return u(this,new s(p,y,h)),h},i.all=function(p){var y=Array.prototype.slice.call(p);return new i(function(h,x){if(y.length===0)return h([]);var b=y.length;function k(T,C){try{if(C&&(typeof C=="object"||typeof C=="function")){var I=C.then;if(typeof I=="function")return void I.call(C,function(V){k(T,V)},x)}y[T]=C,--b==0&&h(y)}catch(V){x(V)}}for(var S=0;S<y.length;S++)k(S,y[S])})},i.resolve=function(p){return p&&typeof p=="object"&&p.constructor===i?p:new i(function(y){y(p)})},i.reject=function(p){return new i(function(y,h){h(p)})},i.race=function(p){return new i(function(y,h){for(var x=0,b=p.length;x<b;x++)p[x].then(y,h)})},i._immediateFn=typeof r=="function"?function(p){r(p)}:function(p){v(p,0)},i._unhandledRejectionFn=function(p){typeof console!="undefined"&&console&&console.warn("Possible Unhandled Promise Rejection:",p)},i._setImmediateFn=function(p){i._immediateFn=p},i._setUnhandledRejectionFn=function(p){i._unhandledRejectionFn=p},t!==void 0&&t.exports?t.exports=i:d.Promise||(d.Promise=i)}).call(this,n("timers").setImmediate)},{timers:3}],3:[function(n,t,e){(function(r,o){var i=n("process/browser.js").nextTick,u=Function.prototype.apply,c=Array.prototype.slice,a={},f=0;function s(l,d){this._id=l,this._clearFn=d}e.setTimeout=function(){return new s(u.call(setTimeout,window,arguments),clearTimeout)},e.setInterval=function(){return new s(u.call(setInterval,window,arguments),clearInterval)},e.clearTimeout=e.clearInterval=function(l){l.close()},s.prototype.unref=s.prototype.ref=function(){},s.prototype.close=function(){this._clearFn.call(window,this._id)},e.enroll=function(l,d){clearTimeout(l._idleTimeoutId),l._idleTimeout=d},e.unenroll=function(l){clearTimeout(l._idleTimeoutId),l._idleTimeout=-1},e._unrefActive=e.active=function(l){clearTimeout(l._idleTimeoutId);var d=l._idleTimeout;0<=d&&(l._idleTimeoutId=setTimeout(function(){l._onTimeout&&l._onTimeout()},d))},e.setImmediate=typeof r=="function"?r:function(l){var d=f++,v=!(arguments.length<2)&&c.call(arguments,1);return a[d]=!0,i(function(){a[d]&&(v?l.apply(null,v):l.call(null),e.clearImmediate(d))}),d},e.clearImmediate=typeof o=="function"?o:function(l){delete a[l]}}).call(this,n("timers").setImmediate,n("timers").clearImmediate)},{"process/browser.js":1,timers:3}],4:[function(n,t,e){var r=n("promise-polyfill"),o=typeof window!="undefined"?window:Function("return this;")();t.exports={boltExport:o.Promise||r}},{"promise-polyfill":2}]},{},[4])(4)});function $v(n){M.setTimeout(function(){throw n},0)}function Wv(n,t,e){return Math.abs(n-t)<=e?g.none():n<t?g.some(n+e):g.some(n-e)}function Xv(n,t){return Co([{width:320,height:480,keyboard:{portrait:300,landscape:240}},{width:320,height:568,keyboard:{portrait:300,landscape:240}},{width:375,height:667,keyboard:{portrait:305,landscape:240}},{width:414,height:736,keyboard:{portrait:320,landscape:240}},{width:768,height:1024,keyboard:{portrait:320,landscape:400}},{width:1024,height:1366,keyboard:{portrait:380,landscape:460}}],function(e){return function(r,o){return r?g.some(o):g.none()}(n<=e.width&&t<=e.height,e.keyboard)}).getOr({portrait:t/5,landscape:n/4})}function qv(n){var t=tv(n).isPortrait(),e=function(o){return Xv(o.screen.width,o.screen.height)}(n),r=t?e.portrait:e.landscape;return(t?n.screen.height:n.screen.width)-n.innerHeight>r?0:r}function Al(n,t){var e=zn(n).dom().defaultView;return Fn(n)+Fn(t)-qv(e)}function Fl(n){return mo(n,rt)}function Yv(n,t){var e=function(r){return X(r,Jt)}(n);return Pl.fixed(n,e,t)}function Kv(n,t){return Pl.scroller(n,t)}function Jv(n){var t=Fl(n);return(X(n,hu)==="true"?Kv:Yv)(n,t)}function Rl(n,t,e){var r=zn(n).dom().defaultView.innerHeight;return H(n,zl,r+"px"),r-t-e}function Bl(n){var t=Ht(n,"top").getOr("0");return parseInt(t,10)}function Vl(n){return parseInt(n.dom().scrollTop,10)}function Nl(n,t){var e=t+ry(n)+"px";U(n,"top",e)}var jl=Il.exports.boltExport,gu=function(n){var t=g.none(),e=[],r=function(c){o()?u(c):e.push(c)},o=function(){return t.isSome()},i=function(c){B(c,u)},u=function(c){t.each(function(a){M.setTimeout(function(){c(a)},0)})};return n(function(c){t=g.some(c),i(e),e=[]}),{get:r,map:function(c){return gu(function(a){r(function(f){a(c(f))})})},isReady:o}},pu={nu:gu,pure:function(n){return gu(function(t){t(n)})}},ke=function(n){function t(e){n().then(e,$v)}return{map:function(e){return ke(function(){return n().then(e)})},bind:function(e){return ke(function(){return n().then(function(r){return e(r).toPromise()})})},anonBind:function(e){return ke(function(){return n().then(function(){return e.toPromise()})})},toLazy:function(){return pu.nu(t)},toCached:function(){var e=null;return ke(function(){return e===null&&(e=n()),e})},toPromise:n,get:t}},nr=function(n){return ke(function(){return new jl(n)})},Qv=function(n){return ke(function(){return jl.resolve(n)})},Zv=function(){var n=null;return{animate:function(t,e,r,o,i,u){function c(s){a=!0,i(s)}var a=!1;Yn.clearInterval(n);function f(s){Yn.clearInterval(n),c(s)}n=Yn.setInterval(function(){var s=t();Wv(s,e,r).fold(function(){Yn.clearInterval(n),c(e)},function(l){if(o(l,f),!a){var d=t();(d!==l||Math.abs(d-e)>Math.abs(s-e))&&(Yn.clearInterval(n),c(e))}})},u)}}},ny=Al,Hl=function(n,t,e){var r=Al(t,e),o=Fn(t)+Fn(e)-r;U(n,"padding-bottom",o+"px")},Pl=Qn([{fixed:["element","property","offsetY"]},{scroller:["element","offsetY"]}]),rt="data-"+E.resolve("position-y-fixed"),Jt="data-"+E.resolve("y-property"),hu="data-"+E.resolve("scrolling"),zl="data-"+E.resolve("last-window-height"),ty=function(n){var t=wn(n,"["+rt+"]");return P(t,Jv)},ey=function(n,t,e,r){function o(){var v=u.innerHeight;return function(p){return mo(p,zl)}(n)<v}function i(){if(d){var v=Fn(e),p=Fn(r),y=Rl(n,v,p);H(n,rt,v+"px"),U(n,"height",y+"px"),Hl(t,n,r)}}var u=zn(n).dom().defaultView,c=function(v){var p=X(v,"style");return pe(v,{position:"absolute",top:"0px"}),H(v,rt,"0px"),H(v,Jt,"top"),{restore:function(){H(v,"style",p||""),xn(v,rt),xn(v,Jt)}}}(e),a=Fn(e),f=Fn(r),s=function(v,p,y){var h=X(y,"style");return Kt.register(y),pe(y,{position:"absolute",height:p+"px",width:"100%",top:v+"px"}),H(y,rt,v+"px"),H(y,hu,"true"),H(y,Jt,"top"),{restore:function(){Kt.deregister(y),H(y,"style",h||""),xn(y,rt),xn(y,hu),xn(y,Jt)}}}(a,Rl(n,a,f),n),l=function(v){var p=X(v,"style");return pe(v,{position:"absolute",bottom:"0px"}),H(v,rt,"0px"),H(v,Jt,"bottom"),{restore:function(){H(v,"style",p||""),xn(v,rt),xn(v,Jt)}}}(r),d=!0;return Hl(t,n,r),{setViewportOffset:function(v){H(n,rt,v+"px"),i()},isExpanding:o,isShrinking:bu(o),refresh:i,restore:function(){d=!1,c.restore(),s.restore(),l.restore()}}},ry=Fl,vu=Zv(),xo="data-"+E.resolve("last-scroll-top"),oy=function(n,t,e){return nr(function(r){var o=Hn(Vl,n);vu.animate(o,t,15,function(i){n.dom().scrollTop=i,U(n,"top",Bl(n)+15+"px")},function(){n.dom().scrollTop=t,U(n,"top",e+"px"),r(t)},10)})},Ll=function(n,t){return nr(function(e){var r=Hn(Vl,n);H(n,xo,r());var o=Math.abs(t-r()),i=Math.ceil(o/10);vu.animate(r,t,i,function(u,c){mo(n,xo)!==n.dom().scrollTop?c(n.dom().scrollTop):(n.dom().scrollTop=u,H(n,xo,u))},function(){n.dom().scrollTop=t,H(n,xo,t),e(t)},10)})},iy=function(n,t){return nr(function(e){function r(c){U(n,"top",c+"px")}var o=Hn(Bl,n),i=Math.abs(t-o()),u=Math.ceil(i/10);vu.animate(o,t,u,r,function(){r(t),e(t)},10)})},uy=function(n,t,e){var r=zn(n).dom().defaultView;return nr(function(o){Nl(n,e),Nl(t,e),r.scrollTo(0,e),o(e)})};function cy(n,t){return t(function(e){var r=[],o=0;n.length===0?e([]):B(n,function(i,u){i.get(function(c){return function(a){r[c]=a,++o>=n.length&&e(r)}}(u))})})}function ay(n,t){return n.fold(function(e,r,o){return function(i,u,c,a){return U(i,u,c+a+"px"),Qv(a)}(e,r,t,o)},function(e,r){return function(o,i,u){var c=i+u,a=Ht(o,"top").getOr(u),f=c-parseInt(a,10),s=o.dom().scrollTop+f;return oy(o,s,c)}(e,t,r)})}function fy(n,t,e,r,o,i){var u=function(s){var l=j(pu.pure({}));return{start:function(d){var v=pu.nu(function(p){return s(d).get(p)});l.set(v)},idle:function(d){l.get().get(function(){d()})}}}(function(f){return uy(n,t,f)}),c=Ks(function(){u.idle(function(){Gl(e,r.pageYOffset).get(function(){(function(){var f=fu(i);return g.from(f[0]).bind(function(s){var l=s.top()-t.dom().scrollTop;return l>r.innerHeight+5||l<-5?g.some({top:m(l),bottom:m(l+s.height())}):g.none()})})().each(function(f){t.dom().scrollTop=t.dom().scrollTop+f.top()}),u.start(0),o.refresh()})})},1e3),a=Y(_.fromDom(r),"scroll",function(){r.pageYOffset<0||c.throttle()});return Gl(e,r.pageYOffset).get(un),{unbind:a.unbind}}var sy=function(n,t,e,r,o){var i=ny(t,e),u=Hn(Dl,n);i<r||i<o?Ll(t,t.dom().scrollTop-i+o).get(u):r<0&&Ll(t,t.dom().scrollTop+r).get(u)},Gl=function(n,t){var e=ty(n);return function(r){return cy(r,nr)}(P(e,function(r){return ay(r,t)}))},ly=function(n){var t=n.cWin(),e=n.ceBody(),r=n.socket(),o=n.toolstrip(),i=n.toolbar(),u=n.contentElement(),c=n.keyboardType(),a=n.outerWindow(),f=n.dropup(),s=ey(r,e,o,f),l=c(n.outerBody(),t,hc(),u,o,i),d=Vs(a,{onChange:A,onReady:s.refresh});d.onAdjustment(function(){s.refresh()});var v=Y(_.fromDom(a),"resize",function(){s.isExpanding()&&s.refresh()}),p=fy(o,r,n.outerBody(),a,s,t),y=function(b,k){var S=b.document,T=_.fromTag("div");function C(L){var Q=_.fromTag("span");return ss(Q,[E.resolve("layer-editor"),E.resolve("unfocused-selection")]),pe(Q,{left:L.left()+"px",top:L.top()+"px",width:L.width()+"px",height:L.height()+"px"}),Q}pn(T,E.resolve("unfocused-selections")),_n(_.fromDom(S.documentElement),T);var I=Y(T,"touchstart",function(L){L.prevent(),du(b,k),V()}),V=function(){Io(T)};return{update:function(){V();var L=fu(b),Q=P(L,C);Mo(T,Q)},isActive:function(){return 0<ut(T).length},destroy:function(){I.unbind(),Mt(T)},clear:V}}(t,u),h=function(){y.clear()};return{toEditing:function(){l.toEditing(),h()},toReading:function(){l.toReading()},onToolbarTouch:function(x){l.onToolbarTouch(x)},refreshSelection:function(){y.isActive()&&y.update()},clearSelection:h,highlightSelection:function(){y.update()},scrollIntoView:function(x,b){sy(t,r,f,x,b)},updateToolbarPadding:A,setViewportOffset:function(x){s.setViewportOffset(x),iy(r,x).get(un)},syncHeight:function(){U(u,"height",u.dom().contentWindow.document.body.scrollHeight+"px")},refreshStructure:s.refresh,destroy:function(){s.restore(),d.destroy(),p.unbind(),v.unbind(),l.destroy(),y.destroy(),Cl(hc(),gt)}}},dy=function(n,t){var e=rl(),r=Li(),o=Li(),i=Se(),u=Se();return{enter:function(){t.hide();var c=_.fromDom(M.document);ho.getActiveApi(n.editor).each(function(a){r.set({socketHeight:Ht(n.socket,"height"),iframeHeight:Ht(a.frame(),"height"),outerScroll:M.document.body.scrollTop}),o.set({exclusives:al.exclusive(c,"."+Kt.scrollable())}),pn(n.container,E.resolve("fullscreen-maximized")),tl(n.container,a.body()),e.maximize(),U(n.socket,"overflow","scroll"),U(n.socket,"-webkit-overflow-scrolling","touch"),Vt(a.body());var f=Mu(["cWin","ceBody","socket","toolstrip","toolbar","dropup","contentElement","cursor","keyboardType","isScrolling","outerWindow","outerBody"],[]);i.set(ly(f({cWin:a.win(),ceBody:a.body(),socket:n.socket,toolstrip:n.toolstrip,toolbar:n.toolbar,dropup:n.dropup.element(),contentElement:a.frame(),cursor:A,outerBody:n.body,outerWindow:n.win,keyboardType:Gv.stubborn,isScrolling:function(){return o.get().exists(function(s){return s.socket.isScrolling()})}}))),i.run(function(s){s.syncHeight()}),u.set(Uv(a,i,n.toolstrip,n.socket,n.dropup))})},refreshStructure:function(){i.run(function(c){c.refreshStructure()})},exit:function(){e.restore(),u.clear(),i.clear(),t.show(),r.on(function(c){c.socketHeight.each(function(a){U(n.socket,"height",a)}),c.iframeHeight.each(function(a){U(n.editor.getFrame(),"height",a)}),M.document.body.scrollTop=c.scrollTop}),r.clear(),o.on(function(c){c.exclusives.unbind()}),o.clear(),sn(n.container,E.resolve("fullscreen-maximized")),el(),Kt.deregister(n.toolbar),Pt(n.socket,"overflow"),Pt(n.socket,"-webkit-overflow-scrolling"),gt(n.editor.getFrame()),ho.getActiveApi(n.editor).each(function(c){c.clearSelection()})}}},my=function(n){var t=fn("Getting IosWebapp schema",il,n);U(t.toolstrip,"width","100%"),U(t.container,"position","relative");var e=et(ol(function(){t.setReadOnly(t.readOnlyOnInit()),o.enter()},t.translate));t.alloy.add(e);var r={show:function(){t.alloy.add(e)},hide:function(){t.alloy.remove(e)}},o=dy(t,r);return{setReadOnly:t.setReadOnly,refreshStructure:o.refreshStructure,enter:o.enter,exit:o.exit,destroy:A}};function Ul(n,t,e){n.system().broadcastOn([jt.formatChanged()],{command:t,state:e})}function gy(n){return{getNotificationManagerImpl:function(){return{open:m({progressBar:{value:A},close:A,text:A,getEl:m(null),moveTo:A,moveRel:A,settings:{}}),close:A,reposition:A,getArgs:m({})}},renderUI:function(){var t=n.getElement(),e=hy(n);(function(s){return s.settings.skin===!1})(n)===!1?(n.contentCSS.push(e.content),em.DOM.styleSheetLoader.load(e.ui,$l(n))):$l(n)();function r(){n.fire("ScrollIntoView")}var o=Ot().os.isAndroid()?function(l){var d=El({classes:[E.resolve("android-container")]}),v=fl(),p=Se(),y=xl(p),h=wl(),x=hl(A,l);return d.add(v.wrapper()),d.add(h),d.add(x.component()),{system:m(d),element:d.element,init:function(b){p.set(wv(b))},exit:function(){p.run(function(b){b.exit(),mn.remove(h,y)})},setToolbarGroups:function(b){var k=v.createGroups(b);v.setGroups(k)},setContextToolbar:function(b){var k=v.createGroups(b);v.setContextToolbar(k)},focusToolbar:function(){v.focus()},restoreToolbar:function(){v.restoreToolbar()},updateMode:function(b){Sl(h,y,b,d.root())},socket:m(h),dropup:m(x)}}(r):function(l){var d=El({classes:[E.resolve("ios-container")]}),v=fl(),p=Se(),y=xl(p),h=wl(),x=hl(function(){p.run(function(b){b.refreshStructure()})},l);return d.add(v.wrapper()),d.add(h),d.add(x.component()),{system:m(d),element:d.element,init:function(b){p.set(my(b))},exit:function(){p.run(function(b){mn.remove(h,y),b.exit()})},setToolbarGroups:function(b){var k=v.createGroups(b);v.setGroups(k)},setContextToolbar:function(b){var k=v.createGroups(b);v.setContextToolbar(k)},focusToolbar:function(){v.focus()},restoreToolbar:function(){v.restoreToolbar()},updateMode:function(b){Sl(h,y,b,d.root())},socket:m(h),dropup:m(x)}}(r);(function(s,l){wd(s,l,Kl)})(_.fromDom(t),o.system());function i(s,l,d,v){v===!1&&n.selection.collapse();var p=f(s,l,d);o.setToolbarGroups(v===!0?p.readOnly:p.main),n.setMode(v===!0?"readonly":"design"),n.fire(v===!0?Wl():Xl()),o.updateMode(v)}function u(s,l){return n.on(s,l),{unbind:function(){n.off(s)}}}var c=t.ownerDocument.defaultView,a=Vs(c,{onChange:function(){o.system().broadcastOn([jt.orientationChanged()],{width:ev(c)})},onReady:A}),f=function(s,l,d){var v=s.get();return{readOnly:v.backToMask.concat(l.get()),main:v.backToMask.concat(d.get())}};return n.on("init",function(){o.init({editor:{getFrame:function(){return _.fromDom(n.contentAreaContainer.querySelector("iframe"))},onDomChanged:function(){return{unbind:A}},onToReading:function(k){return u(Wl(),k)},onToEditing:function(k){return u(Xl(),k)},onScrollToCursor:function(k){return n.on("ScrollIntoView",function(S){k(S)}),{unbind:function(){n.off("ScrollIntoView"),a.destroy()}}},onTouchToolstrip:function(){s()},onTouchContent:function(){(function(k){return xr(k).bind(function(S){return o.system().getByDom(S).toOption()})})(_.fromDom(n.editorContainer.querySelector("."+E.resolve("toolbar")))).each(Cu),o.restoreToolbar(),s()},onTapContent:function(k){var S=k.target();Dn(S)==="img"?(n.selection.select(S.dom()),k.kill()):Dn(S)==="a"&&o.system().getByDom(_.fromDom(n.editorContainer)).each(function(T){br.isAlpha(T)&&om(S.dom())})}},container:_.fromDom(n.editorContainer),socket:_.fromDom(n.contentAreaContainer),toolstrip:_.fromDom(n.editorContainer.querySelector("."+E.resolve("toolstrip"))),toolbar:_.fromDom(n.editorContainer.querySelector("."+E.resolve("toolbar"))),dropup:o.dropup(),alloy:o.system(),translate:A,setReadOnly:function(k){i(b,x,h,k)},readOnlyOnInit:function(){return!1}});var s=function(){o.dropup().disappear(function(){o.system().broadcastOn([jt.dropupDismissed()],{})})},l={label:"The first group",scrollable:!1,items:[st.forToolbar("back",function(){n.selection.collapse(),o.exit()},{},n)]},d={label:"Back to read only",scrollable:!1,items:[st.forToolbar("readonly-back",function(){i(b,x,h,!0)},{},n)]},v=Qh(o,n),p=Zh(n.settings,v),y={label:"The extra group",scrollable:!1,items:[]},h=j([{label:"the action group",scrollable:!0,items:p},y]),x=j([{label:"The read only mode group",scrollable:!0,items:[]},y]),b=j({backToMask:[l],backToReadOnly:[d]});vy(o,n)}),n.on("remove",function(){o.exit()}),n.on("detach",function(){(function(s){var l=ut(s.element());B(l,function(d){s.getByDom(d).each(mr)}),Mt(s.element())})(o.system()),o.system().destroy()}),{iframeContainer:o.socket().element().dom(),editorContainer:o.element().dom()}}}}var py=tinymce.util.Tools.resolve("tinymce.EditorManager"),hy=function(n){var t=N(n.settings,"skin_url").fold(function(){return py.baseURL+"/skins/ui/oxide"},function(e){return e});return{content:t+"/content.mobile.min.css",ui:t+"/skin.mobile.min.css"}},vy=function(n,t){var e=bn(t.formatter.get());B(e,function(r){t.formatter.formatChanged(r,function(o){Ul(n,r,o)})}),B(["ul","ol"],function(r){t.selection.selectorChanged(r,function(o,i){Ul(n,r,o)})})},$l=(m(["x-small","small","medium","large","x-large"]),function(n){function t(){n._skinLoaded=!0,n.fire("SkinLoaded")}return function(){n.initialized?t():n.on("init",t)}}),Wl=m("toReading"),Xl=m("toEditing");(function(){rm.add("mobile",gy)})()})(window);
