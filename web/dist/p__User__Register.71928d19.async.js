(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[12769],{40427:function(U){U.exports={toLoginBtn:"toLoginBtn___3o108"}},73430:function(U){U.exports={container:"container___2mKrh",loginForm:"loginForm___3ypRW",qrLoginBtn:"qrLoginBtn___3g74p",copyRight:"copyRight___XB4m_",qrcodeBox:"qrcodeBox___5t3G7",qrMask:"qrMask___17eyU",languageSelect:"languageSelect___3ubhc"}},87528:function(U,j,e){"use strict";e.r(j);var _=e(34792),D=e(48086),M=e(39428),T=e(11849),n=e(3182),E=e(2824),N=e(67294),o=e(30672),L=e(37406),i=e(89366),d=e(2603),u=e(5966),ne=e(85304),ie=e(32601),me=e(40427),re=e.n(me),c=e(85893),oe=()=>{var p=(0,o.YB)(),Y=(0,o.tT)("@@initialState"),W=Y.initialState,q=Y.setInitialState,ve=(0,N.useState)({}),ee=(0,E.Z)(ve,2),r=ee[0],s=ee[1],m=function(){var B=(0,n.Z)((0,M.Z)().mark(function O(){var S,x,t;return(0,M.Z)().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return g.next=2,W==null||(S=W.fetchUserInfo)===null||S===void 0?void 0:S.call(W);case 2:if(t=g.sent,window.ignoreFileSize=(t==null||(x=t.user)===null||x===void 0?void 0:x.ignoreFileSize)||0,!t){g.next=7;break}return g.next=7,q(f=>(0,T.Z)((0,T.Z)({},f),{},{currentUser:t,adminauth:(0,L.Dh)(t),systemInfo:r}));case 7:case"end":return g.stop()}},O)}));return function(){return B.apply(this,arguments)}}(),le=function(){var B=(0,n.Z)((0,M.Z)().mark(function O(S){var x,t,Z,g,f,P,a,R;return(0,M.Z)().wrap(function(h){for(;;)switch(h.prev=h.next){case 0:if(x=S.password,t=S.passwordTwo,t===x){h.next=4;break}return D.ZP.warning(p.formatMessage({id:"user.rootPwdEqual"})),h.abrupt("return");case 4:if((r==null?void 0:r.needCheckCode)!="1"){h.next=11;break}if(Z=(0,o.Kd)(),g=$("#drag").text(),f=Z==="en-US"?"Successful verification":"\u9A8C\u8BC1\u901A\u8FC7",g===f){h.next=11;break}return D.ZP.warning(p.formatMessage({id:"pages.login.sliderVerify"})),h.abrupt("return");case 11:return h.next=13,(0,ne.sT)((0,T.Z)((0,T.Z)({},S),{},{password:(0,L.HI)(x),passwordTwo:(0,L.HI)(t),isGraphicCode:0}));case 13:P=h.sent,a=P.data,R=a===void 0?{}:a,R.token?(D.ZP.success(p.formatMessage({id:"admin.login.registSuccess1",defaultMessage:"\u6CE8\u518C\u6210\u529F\uFF013\u79D2\u540E\u8DF3\u8F6C\u81F3\u6587\u4EF6\u7BA1\u7406\uFF01"})),(0,L.d8)("token",R.token),setTimeout((0,n.Z)((0,M.Z)().mark(function K(){return(0,M.Z)().wrap(function(b){for(;;)switch(b.prev=b.next){case 0:return b.next=2,m();case 2:o.m8.push("/");case 3:case"end":return b.stop()}},K)})),3e3)):(D.ZP.success(p.formatMessage({id:"admin.login.registSuccess2",defaultMessage:"\u6CE8\u518C\u6210\u529F\uFF01\u8BF7\u5F85\u7BA1\u7406\u5458\u5BA1\u6838\uFF01 3\u79D2\u540E\u8DF3\u8F6C\u81F3\u767B\u5F55\u9875\uFF01"})),setTimeout(()=>{o.m8.push("/login")},3e3));case 17:case"end":return h.stop()}},O)}));return function(S){return B.apply(this,arguments)}}(),de=function(){var B=(0,n.Z)((0,M.Z)().mark(function O(){var S,x,t,Z;return(0,M.Z)().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return f.next=2,(0,ne.So)({});case 2:S=f.sent,x=S.data,t=x===void 0?{}:x,Z=t.pluginList||[],window.isyz=Z.findIndex(P=>P.type=="yzow"&&P.status==1)>-1,s((0,T.Z)((0,T.Z)({},t),{},{registerConfig:JSON.parse(t.registerConfig||"{}"),thirdLoginConfig:JSON.parse(t.thirdLoginConfig||"[]")}));case 8:case"end":return f.stop()}},O)}));return function(){return B.apply(this,arguments)}}();return(0,N.useLayoutEffect)(()=>{de()},[]),(0,c.jsx)(ie.Z,{isLogin:!1,submitText:p.formatMessage({id:"common.regist"}),initialValues:{},actions:(0,c.jsx)("a",{className:re().toLoginBtn,onClick:()=>o.m8.push("/login"),children:(0,c.jsx)(o._H,{id:"user.directLogin",defaultMessage:"\u5DF2\u6709\u8D26\u53F7\u767B\u5F55"})}),systemInfo:r,onFinish:le,children:(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(u.Z,{name:"name",fieldProps:{size:"large",prefix:(0,c.jsx)(i.Z,{})},placeholder:p.formatMessage({id:"pages.login.username.placeholder",defaultMessage:"\u8F93\u5165\u7528\u6237\u540D"}),rules:[{required:!0,whitespace:!0,message:(0,c.jsx)(o._H,{id:"pages.login.username.required",defaultMessage:"\u7528\u6237\u540D\u662F\u5FC5\u586B\u9879"})}]}),(0,c.jsx)(u.Z.Password,{name:"password",fieldProps:{size:"large",prefix:(0,c.jsx)(d.Z,{})},placeholder:p.formatMessage({id:"pages.login.password.placeholder",defaultMessage:"\u8F93\u5165\u5BC6\u7801"}),rules:[{required:!0,message:(0,c.jsx)(o._H,{id:"pages.login.password.required",defaultMessage:"\u5BC6\u7801\u662F\u5FC5\u586B\u9879"})},(r==null?void 0:r.passwordRule)==="none"?{min:6,message:p.formatMessage({id:"admin.setting.passwordRuleNoneWarring"})}:(r==null?void 0:r.passwordRule)==="strong"?{pattern:/^(?=.*[a-zA-Z])(?=.*\d)[^]{6,30}$/,message:p.formatMessage({id:"admin.setting.passwordRuleStrongDesc"})}:(r==null?void 0:r.passwordRule)==="strongMore"?{pattern:/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)[^]{6,30}$/,message:p.formatMessage({id:"admin.setting.passwordRuleStrongMoreDesc"})}:{}]}),(0,c.jsx)(u.Z.Password,{name:"passwordTwo",fieldProps:{size:"large",prefix:(0,c.jsx)(d.Z,{})},placeholder:p.formatMessage({id:"user.inputPwdAgain",defaultMessage:"\u8BF7\u518D\u6B21\u8F93\u5165\u5BC6\u7801"}),rules:[{required:!0,message:(0,c.jsx)(o._H,{id:"pages.login.password.required",defaultMessage:"\u5BC6\u7801\u662F\u5FC5\u586B\u9879"})}]}),(r==null?void 0:r.needCheckCode)=="1"&&(0,c.jsx)("div",{id:"drag"})]})})};j.default=oe},6417:function(){$.fn.drag=function(U){var j,e=this,_=!1,D={},U=$.extend(D,U),M=localStorage.getItem("umi_locale")==="en-US"?"Drag the slider to the far right":"\u8BF7\u6309\u4F4F\u6ED1\u5757\uFF0C\u62D6\u52A8\u5230\u6700\u53F3\u8FB9",T='<div class="drag_bg"></div><div class="drag_text" onselectstart="return false;" unselectable="on">'+M+'</div><div class="handler handler_bg"></div>';this.append(T);var n=e.find(".handler"),E=e.find(".drag_bg"),N=e.find(".drag_text"),o=e.width()-n.width();n.mousedown(function(i){_=!0,j=i.pageX-parseInt(n.css("left"),10)}),$(document).mousemove(function(i){var d=i.pageX-j;_&&(d>0&&d<=o?(n.css({left:d}),E.css({width:d})):d>o&&(n.css({left:o}),E.css({width:o}),L()))}).mouseup(function(i){_=!1;var d=i.pageX-j;d<o&&(n.css({left:0}),E.css({width:0}))}),n.on("touchstart",function(i){i.preventDefault();var d=i.originalEvent.targetTouches[0];_=!0,j=d.pageX-parseInt(n.css("left"),10)}),$(document).on("touchmove",function(i){i.preventDefault();var d=i.originalEvent.targetTouches[0],u=d.pageX-j;_&&(u>0&&u<=o?(n.css({left:u}),E.css({width:u})):u>o&&(n.css({left:o}),E.css({width:o}),L()))}),$(document).on("touchend",function(i){var d=i.originalEvent.changedTouches[0];_=!1;var u=d.pageX-j;u<o&&(n.css({left:0}),E.css({width:0}))}),$(document).on("touchcancel",function(i){n.css({left:0}),E.css({width:0})});function L(){n.removeClass("handler_bg").addClass("handler_ok_bg"),N.text(localStorage.getItem("umi_locale")==="en-US"?"Successful verification":"\u9A8C\u8BC1\u901A\u8FC7"),e.css({color:"#fff"}),n.unbind("mousedown"),n.unbind("touchstart"),$(document).unbind("mousemove"),$(document).unbind("touchmove"),$(document).unbind("mouseup"),$(document).unbind("touchend"),$(document).unbind("touchcancel")}}},32601:function(U,j,e){"use strict";e.d(j,{Z:function(){return x}});var _=e(39428),D=e(3182),M=e(43358),T=e(34041),n=e(2824),E=e(81316),N=e.n(E),o=e(91152),L=e.n(o),i=e(67294),d=e(43504),u=e(30672),ne=e(57663),ie=e(71577),me=e(34792),re=e(48086),c=e(37476),oe=e(81473),p=e(59879),Y=e(84059),W=e(22003),q=e(37406),ve=e(6417),ee=e(73430),r=e.n(ee),s=e(85893),m=null,le=()=>{var t=(0,u.YB)(),Z=(0,i.useState)(!1),g=(0,n.Z)(Z,2),f=g[0],P=g[1],a=(0,i.useState)(""),R=(0,n.Z)(a,2),z=R[0],h=R[1],K=(0,i.useState)(""),k=(0,n.Z)(K,2),b=k[0],J=k[1],ue=(0,i.useState)(!1),V=(0,n.Z)(ue,2),ce=V[0],G=V[1],ge=(0,i.useState)(!1),se=(0,n.Z)(ge,2),X=se[0],A=se[1],H=(v,l)=>{$.ajax({type:"get",url:"/api/disk/getSystemTime",contentType:"application/json;charset=utf-8",dataType:"text",success:function(y){v&&v(y)},error:function(y){l&&l(y)}})},I=function(){var v=(0,D.Z)((0,_.Z)().mark(function l(){return(0,_.Z)().wrap(function(y){for(;;)switch(y.prev=y.next){case 0:H(function(ae,Q){$.ajax({type:"post",url:"/api/disk/findLoginAuthUrl",contentType:"application/json;charset=utf-8",dataType:"json",data:JSON.stringify({clientType:"webScanLogin",signature:(0,q.x4)(JSON.stringify({nonceStr:Date.now(),timestamp:ae})),timestamp:ae}),success:function(C){var te=C!=null?C:{},Ee=te.success,Ce=te.code,Te=te.message,he=te.data,pe=he===void 0?{}:he;Ee?(J(""),G(!1),A(!1),h(pe.qrUrl),Se(pe.qrUrl.split("key=")[1])):re.ZP.error(t.formatMessage({id:Ce,defaultMessage:Te}))},error:function(C){Q&&Q(C)}})});case 1:case"end":return y.stop()}},l)}));return function(){return v.apply(this,arguments)}}(),F=(v,l)=>{$.ajax({type:"post",url:"/api/disk/scanLogin",contentType:"application/json;charset=utf-8",dataType:"json",data:JSON.stringify(v),success:function(y){l&&l(y)},error:function(y){console.log("scanLogin",y)}})},Se=v=>{m&&m.close();var l="wss://".concat(window.location.host,"/websocket/webchat/scanLogin/").concat(v);m=new W.Z(l),m.onopen=xe,m.onmessage=ye,m.onerror=_e,m.onclose=je},xe=()=>{m.send(JSON.stringify({action:"confirm",msgType:"webScanLogin"}))},ye=v=>{var l=Me(v.data)?JSON.parse(v.data):{type:v.data};switch(l.action){case"scan":A(!0);break;case"auth":F({tempAuth:l.tempAuth,sourceDomain:l.schoolDomain},function(w){var y=w.code,ae=w.success,Q=w.data,fe=Q===void 0?{}:Q;if(ae)(0,q.d8)("token",fe.token),m.send(JSON.stringify({action:"feedBack",actionVal:"success",msgType:"webScanLogin",tempAuth:l.tempAuth})),m.close(),location.href="/";else{var C=w.message;switch(parseInt(y)){case 701:C="\u4E34\u65F6\u6388\u6743\u7801\u65E0\u6548";break;case 601:C="\u4E8C\u7EF4\u7801\u5DF2\u5931\u6548";break;case 609:C="\u60A8\u672A\u6CE8\u518C\uFF0C\u8BF7\u5148\u6CE8\u518C";break;case 610:C="\u8D26\u53F7\u5DF2\u9501\u5B9A\uFF0C\u8BF7\u8054\u7CFB\u7BA1\u7406\u5458";break}G(!0),J(C),m.send(JSON.stringify({action:"feedBack",actionVal:"fail",msgType:"webScanLogin",tempAuth:l.tempAuth}))}});break;case"feedBack":break;default:l.code=="601"&&(G(!0),J("\u4E8C\u7EF4\u7801\u5DF2\u5931\u6548"))}},_e=()=>{},je=()=>{},Me=v=>{if(typeof v=="string")try{var l=JSON.parse(v);return!!(typeof l=="object"&&l)}catch(w){return!1}};return(0,i.useEffect)(()=>{f?I():m&&m.close()},[f]),(0,s.jsxs)(c.Y,{width:300,visible:f,onVisibleChange:P,title:(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(oe.Z,{style:{marginRight:8}}),t.formatMessage({id:"common.login"})]}),trigger:(0,s.jsx)("div",{className:r().qrLoginBtn}),submitter:!1,modalProps:{bodyStyle:{textAlign:"center"},maskClosable:!1},children:[(0,s.jsxs)("div",{className:r().qrcodeBox,children:[ce?(0,s.jsxs)("div",{className:r().qrMask,children:[(0,s.jsx)("p",{children:b}),(0,s.jsx)(ie.Z,{type:"link",size:"small",icon:(0,s.jsx)(p.Z,{}),onClick:I,children:t.formatMessage({id:"user.codeRefresh",defaultMessage:"\u70B9\u51FB\u5237\u65B0"})})]}):null,X?(0,s.jsx)("div",{className:r().qrMask,children:(0,s.jsx)("p",{children:"\u626B\u7801\u6210\u529F"})}):null,z?(0,s.jsx)(Y.ZP,{size:200,value:z}):(0,s.jsx)(s.Fragment,{})]}),t.formatMessage({id:"pages.login.scanLogin"})]})},de=le,B={"en-US":"US English","ja-JP":"JP \u65E5\u672C\u8A9E","fr-FR":"FR Fran\xE7ais","es-ES":"ES Espa\xF1ol","ru-RU":"RU Ruso","zh-CN":"CN \u7B80\u4F53\u4E2D\u6587","zh-TW":"HK \u7E41\u9AD4\u4E2D\u6587","it-IT":"IT Italia"},O={"en-US":"en-US","zh-TW":"zh-TW","zh-CN":"zh-CN","ru-RU":"ru-RU","ja-JP":"ja-JP","it-IT":"it-IT"},S=t=>{var Z=t.isLogin,g=t.submitText,f=t.initialValues,P=t.actions,a=t.systemInfo,R=t.onFinish,z=t.children,h=(0,i.useState)(window.location.origin),K=(0,n.Z)(h,2),k=K[0],b=K[1],J=(0,u.Kd)(),ue=(0,i.useState)(J),V=(0,n.Z)(ue,2),ce=V[0],G=V[1],ge=(0,u.I0)();(0,i.useEffect)(()=>{(a==null?void 0:a.needCheckCode)=="1"&&$("#drag").drag()},[a==null?void 0:a.needCheckCode]);var se=()=>{var X=(0,u.XZ)(),A=X.map((I,F)=>({value:I,label:B[I]})),H=I=>{(0,u.i_)(I,!0),G(I),ge({type:"common/setState",payload:{showmodalList:[]}})};return(0,s.jsx)("div",{className:r().languageSelect,children:(0,s.jsx)(T.Z,{bordered:!1,value:ce,defaultValue:"en-US",style:{width:120},size:"small",onChange:H,options:A})})};return(0,s.jsxs)("div",{className:r().container,children:[Object.keys(a).length?(0,s.jsxs)(u.ql,{children:[(0,s.jsx)("title",{children:"".concat((a==null?void 0:a.systemName)||"\u89C6\u9891\u4E2D\u5FC3"," - ").concat((a==null?void 0:a.systemDesc)||"\u8D44\u6E90\u7BA1\u7406\u5668")}),(0,s.jsx)("link",{rel:"shortcut icon",href:(a==null?void 0:a.browserLogo)||L()})]}):(0,s.jsx)(s.Fragment,{}),(0,s.jsx)("div",{style:{flex:"1",padding:"60px 0 32px",opacity:Object.keys(a).length?1:0},children:(0,s.jsxs)("div",{className:r().loginForm,children:[Z?(0,s.jsx)(de,{}):(0,s.jsx)(s.Fragment,{}),(0,s.jsx)(d.U,{contentStyle:{minWidth:280,maxWidth:"75vw"},logo:(0,s.jsx)("img",{alt:"logo",src:(a==null?void 0:a.systemLogo)||N()}),title:(a==null?void 0:a.systemName)||"\u89C6\u9891\u4E2D\u5FC3",subTitle:(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{children:(a==null?void 0:a.systemDesc)||"\u8D44\u6E90\u7BA1\u7406\u5668"}),k.indexOf("demo.filesbox.cn")>-1?(0,s.jsx)("div",{style:{fontSize:13,color:"#722ed1"},className:"tyanuser",children:"\u4F53\u9A8C\u8D26\u53F7 Demo / Demo123"}):""]}),initialValues:f,actions:P,submitter:{searchConfig:{submitText:g}},onFinish:function(){var X=(0,D.Z)((0,_.Z)().mark(function A(H){return(0,_.Z)().wrap(function(F){for(;;)switch(F.prev=F.next){case 0:return F.next=2,R(H);case 2:case"end":return F.stop()}},A)}));return function(A){return X.apply(this,arguments)}}(),children:z}),se()]})}),a!=null&&a.globalIcp?(0,s.jsx)("span",{className:r().copyRight,children:a.globalIcp}):(0,s.jsx)(s.Fragment,{})]})},x=S}}]);
